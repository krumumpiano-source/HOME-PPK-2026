# ðŸ“‹ à¹à¸žà¸¥à¸™à¹à¸šà¸„à¹€à¸­à¹‡à¸™ (Backend Plan) â€” HOME PPK 2026

> **à¸§à¸±à¸™à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡:** 16 à¸à¸¸à¸¡à¸ à¸²à¸žà¸±à¸™à¸˜à¹Œ 2569  
> **à¹à¸žà¸¥à¸•à¸Ÿà¸­à¸£à¹Œà¸¡:** Google Apps Script (GAS) à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™  
> **à¸ˆà¸¸à¸”à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¸§à¸²à¸‡à¹à¸œà¸™à¹„à¸Ÿà¸¥à¹Œ .gs à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸ªà¸£à¹‰à¸²à¸‡ à¹€à¸žà¸·à¹ˆà¸­à¸£à¸­à¸‡à¸£à¸±à¸š HTML 22 à¸«à¸™à¹‰à¸²à¸‚à¸­à¸‡à¸£à¸°à¸šà¸š HOME PPK 2026  

---

## ðŸ“Œ à¸«à¸¥à¸±à¸à¸à¸²à¸£à¸­à¸­à¸à¹à¸šà¸š

1. **à¹à¸¢à¸à¹„à¸Ÿà¸¥à¹Œà¸•à¸²à¸¡à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ (Separation of Concerns)** â€” à¹à¸•à¹ˆà¸¥à¸°à¹„à¸Ÿà¸¥à¹Œà¸£à¸±à¸šà¸œà¸´à¸”à¸Šà¸­à¸šà¸‡à¸²à¸™à¹€à¸‰à¸žà¸²à¸°à¸—à¸²à¸‡
2. **à¸ˆà¸³à¸™à¸§à¸™à¹„à¸Ÿà¸¥à¹Œà¸ªà¸¡à¹€à¸«à¸•à¸¸à¸ªà¸¡à¸œà¸¥** â€” à¹„à¸¡à¹ˆà¸¡à¸²à¸à¹€à¸à¸´à¸™à¸ˆà¸™à¸ªà¸±à¸šà¸ªà¸™ à¹„à¸¡à¹ˆà¸™à¹‰à¸­à¸¢à¹€à¸à¸´à¸™à¸ˆà¸™à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸«à¸à¹ˆà¹€à¸—à¸­à¸°à¸—à¸°
3. **à¹à¸à¹‰à¹„à¸‚à¸‡à¹ˆà¸²à¸¢à¹„à¸¡à¹ˆà¸žà¸±à¸‡** â€” à¹„à¸Ÿà¸¥à¹Œà¸«à¸™à¸¶à¹ˆà¸‡à¹€à¸ªà¸µà¸¢à¹„à¸¡à¹ˆà¸à¸£à¸°à¸—à¸šà¹„à¸Ÿà¸¥à¹Œà¸­à¸·à¹ˆà¸™, à¹ƒà¸Šà¹‰ Config à¸à¸¥à¸²à¸‡
4. **à¸£à¸­à¸‡à¸£à¸±à¸šà¸à¸²à¸£à¸‚à¸¢à¸²à¸¢à¹ƒà¸™à¸­à¸™à¸²à¸„à¸•** â€” à¹€à¸žà¸´à¹ˆà¸¡à¸Ÿà¸µà¹€à¸ˆà¸­à¸£à¹Œà¹ƒà¸«à¸¡à¹ˆà¹„à¸”à¹‰à¹‚à¸”à¸¢à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹à¸à¹‰à¹„à¸Ÿà¸¥à¹Œà¹€à¸”à¸´à¸¡
5. **à¹ƒà¸Šà¹‰à¸à¸±à¸š GAS à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™** â€” à¹ƒà¸Šà¹‰ DriveApp, SpreadsheetApp, GmailApp, ContentService, PropertiesService

---

## ðŸ“ à¸£à¸²à¸¢à¸Šà¸·à¹ˆà¸­à¹„à¸Ÿà¸¥à¹Œ .gs à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” (10 à¹„à¸Ÿà¸¥à¹Œ)

| # | à¸Šà¸·à¹ˆà¸­à¹„à¸Ÿà¸¥à¹Œ | à¸›à¸£à¸°à¹€à¸ à¸— | à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸«à¸¥à¸±à¸ | à¸‚à¸™à¸²à¸”à¹‚à¸”à¸¢à¸›à¸£à¸°à¸¡à¸²à¸“ |
|---|----------|--------|------------|---------------|
| 1 | `Config.gs` | âš™ï¸ à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² | à¸„à¹ˆà¸²à¸„à¸‡à¸—à¸µà¹ˆ, ID à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”, à¸„à¹ˆà¸²à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ | à¹€à¸¥à¹‡à¸ (~100 à¸šà¸£à¸£à¸—à¸±à¸”) |
| 2 | `Database.gs` | ðŸ—„ï¸ à¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ | CRUD à¸à¸¥à¸²à¸‡, à¸­à¹ˆà¸²à¸™/à¹€à¸‚à¸µà¸¢à¸™ Sheet, à¸ªà¸£à¹‰à¸²à¸‡ ID | à¸à¸¥à¸²à¸‡ (~200 à¸šà¸£à¸£à¸—à¸±à¸”) |
| 3 | `Main.gs` | ðŸŒ à¹€à¸‚à¹‰à¸²-à¸­à¸­à¸ | doGet/doPost Router, à¸ˆà¸±à¸”à¸à¸²à¸£ request | à¸à¸¥à¸²à¸‡ (~200 à¸šà¸£à¸£à¸—à¸±à¸”) |
| 4 | `Auth.gs` | ðŸ” à¸¢à¸·à¸™à¸¢à¸±à¸™à¸•à¸±à¸§à¸•à¸™ | Login, Register, Reset password, Session | à¸à¸¥à¸²à¸‡ (~250 à¸šà¸£à¸£à¸—à¸±à¸”) |
| 5 | `Housing.gs` | ðŸ  à¸šà¹‰à¸²à¸™à¸žà¸±à¸ | à¸ˆà¸±à¸”à¸à¸²à¸£à¸šà¹‰à¸²à¸™à¸žà¸±à¸, à¸œà¸¹à¹‰à¸žà¸±à¸à¸­à¸²à¸¨à¸±à¸¢, à¸œà¸¹à¹‰à¸£à¹ˆà¸§à¸¡à¸žà¸±à¸, à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¹‚à¸›à¸£à¹„à¸Ÿà¸¥à¹Œ | à¸à¸¥à¸²à¸‡ (~300 à¸šà¸£à¸£à¸—à¸±à¸”) |
| 6 | `Billing.gs` | ðŸ’§âš¡ à¸šà¸´à¸¥ | à¸„à¹ˆà¸²à¸™à¹‰à¸³, à¸„à¹ˆà¸²à¹„à¸Ÿ, à¸„à¹ˆà¸²à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡, à¸ªà¸£à¸¸à¸›à¸¢à¸­à¸” | à¹ƒà¸«à¸à¹ˆ (~400 à¸šà¸£à¸£à¸—à¸±à¸”) |
| 7 | `Payment.gs` | ðŸ’³ à¸Šà¸³à¸£à¸°à¹€à¸‡à¸´à¸™ | à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¸ªà¸¥à¸´à¸›, à¸•à¸£à¸§à¸ˆà¸ªà¸¥à¸´à¸›, à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´, à¸šà¸±à¸™à¸—à¸¶à¸à¸¡à¸·à¸­ | à¹ƒà¸«à¸à¹ˆ (~350 à¸šà¸£à¸£à¸—à¸±à¸”) |
| 8 | `Request.gs` | ðŸ“‹ à¸„à¸³à¸£à¹‰à¸­à¸‡ | à¸„à¸³à¸£à¹‰à¸­à¸‡ 4 à¸›à¸£à¸°à¹€à¸ à¸—, à¸£à¸°à¸šà¸šà¸„à¸´à¸§, à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´/à¸›à¸à¸´à¹€à¸ªà¸˜ | à¹ƒà¸«à¸à¹ˆ (~400 à¸šà¸£à¸£à¸—à¸±à¸”) |
| 9 | `Finance.gs` | ðŸ“‘ à¸à¸²à¸£à¹€à¸‡à¸´à¸™ | à¹€à¸šà¸´à¸-à¸ˆà¹ˆà¸²à¸¢à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™, à¸šà¸±à¸à¸Šà¸µà¸£à¸²à¸¢à¸£à¸±à¸š-à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢, à¸¢à¸à¸¢à¸­à¸” | à¸à¸¥à¸²à¸‡ (~300 à¸šà¸£à¸£à¸—à¸±à¸”) |
| 10 | `Notification.gs` | ðŸ“§ à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™ | à¸ªà¹ˆà¸‡ Email, à¹à¸ˆà¹‰à¸‡à¸¢à¸­à¸”, à¹ƒà¸šà¹€à¸ªà¸£à¹‡à¸ˆ, à¹€à¸•à¸·à¸­à¸™à¸Šà¸³à¸£à¸° | à¸à¸¥à¸²à¸‡ (~200 à¸šà¸£à¸£à¸—à¸±à¸”) |

> **à¸£à¸§à¸¡ 10 à¹„à¸Ÿà¸¥à¹Œ** â€” à¸ªà¸¡à¸”à¸¸à¸¥à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸„à¸§à¸²à¸¡à¹€à¸£à¸µà¸¢à¸šà¸‡à¹ˆà¸²à¸¢à¹à¸¥à¸°à¸à¸²à¸£à¹à¸¢à¸à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸Šà¸±à¸”à¹€à¸ˆà¸™

---

## ðŸ“„ à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¹à¸•à¹ˆà¸¥à¸°à¹„à¸Ÿà¸¥à¹Œ

---

### 1. `Config.gs` â€” âš™ï¸ à¸¨à¸¹à¸™à¸¢à¹Œà¸à¸¥à¸²à¸‡à¸„à¹ˆà¸²à¸•à¸±à¹‰à¸‡

**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¹€à¸à¹‡à¸š ID, à¸„à¹ˆà¸²à¸„à¸‡à¸—à¸µà¹ˆ à¹à¸¥à¸°à¸„à¹ˆà¸²à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¹„à¸§à¹‰à¸—à¸µà¹ˆà¹€à¸”à¸µà¸¢à¸§ à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸«à¹‰à¹„à¸Ÿà¸¥à¹Œà¸­à¸·à¹ˆà¸™à¹€à¸£à¸µà¸¢à¸à¹ƒà¸Šà¹‰à¹„à¸”à¹‰à¸‡à¹ˆà¸²à¸¢ à¹€à¸§à¸¥à¸²à¸¢à¹‰à¸²à¸¢/à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™ Sheet/Folder à¹à¸à¹‰à¹à¸„à¹ˆà¹„à¸Ÿà¸¥à¹Œà¸™à¸µà¹‰

**à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹€à¸à¹‡à¸š:**
```
FOLDER_IDS = {
  ROOT, DATA, SLIPS, REQUEST_ATTACHMENTS, 
  RESIDENCE_REQ, TRANSFER_REQ, RETURN_REQ, REPAIR_REQ,
  ACCOUNTING_RECEIPTS, DOCUMENTS, BACKUPS
}

SPREADSHEET_IDS = {
  MAIN, WATER, ELECTRIC, PAYMENTS, REQUESTS, ACCOUNTING, WITHDRAW, NOTIFICATIONS
}

SHEET_NAMES = {
  // MAIN (10 à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™ + PendingReg_{à¸›à¸µ})
  Housing, Residents, Users, Permissions, Settings, Announcements, Logs,
  WaterRates, CommonFee, Exemptions,
  // PendingReg_{à¸›à¸µ} (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. à¹€à¸Šà¹ˆà¸™ 'PendingReg_2569'... à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)
  // WATER (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. à¹€à¸Šà¹ˆà¸™ '2569', '2570'... à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)
  // ELECTRIC (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. à¹€à¸Šà¹ˆà¸™ '2569', '2570'... à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)
  // PAYMENTS
  SlipSubmissions, PaymentHistory, Outstanding,
  // REQUESTS
  // Residence_{year} (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. à¹€à¸Šà¹ˆà¸™ 'Residence_2569'... à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)
  // Transfer_{year} (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. à¹€à¸Šà¹ˆà¸™ 'Transfer_2569'... à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)
  // Return_{year} (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. à¹€à¸Šà¹ˆà¸™ 'Return_2569'... à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)
  // Repair_{year} (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. à¹€à¸Šà¹ˆà¸™ 'Repair_2569'... à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)
  Queue,
  // ACCOUNTING (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. à¹€à¸Šà¹ˆà¸™ '2569', '2570'... à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)
  // WITHDRAW (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. à¹€à¸Šà¹ˆà¸™ '2569', '2570'... à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)
  // NOTIFICATIONS (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. à¹€à¸Šà¹ˆà¸™ '2569', '2570'... à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´)
}

DEFAULTS = {
  water_rate: 5,
  common_fee_house: 110,
  common_fee_flat: 110,
  due_date: 15,                    // à¸§à¸±à¸™à¸—à¸³à¸à¸²à¸£ (due_date_working_days)
  reminder_days: 5,                // à¸ˆà¸³à¸™à¸§à¸™à¸§à¸±à¸™à¸à¹ˆà¸­à¸™à¹€à¸•à¸·à¸­à¸™
  house_prefix: 'à¸šà¹‰à¸²à¸™',
  flat_prefix: 'à¹à¸Ÿà¸¥à¸•',
  garbage_fee: 310                 // à¸„à¹ˆà¸²à¸‚à¸¢à¸°à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ (monthly-withdraw)
}

ID_PREFIXES = {
  HOU, RES, USR, WTR, ELC, SLP, PAY, REQ, TRF, RTN, RPR, QUE, INC, EXP, WTD, ANN, LOG, RAT, CMF, EXM, OUT, ACT, NTF, REG
}
```

**HTML à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** à¸—à¸¸à¸à¹„à¸Ÿà¸¥à¹Œ (à¸œà¹ˆà¸²à¸™à¹„à¸Ÿà¸¥à¹Œà¸­à¸·à¹ˆà¸™à¸—à¸µà¹ˆà¹€à¸£à¸µà¸¢à¸ Config)

---

### 2. `Database.gs` â€” ðŸ—„ï¸ CRUD à¸à¸¥à¸²à¸‡

**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸à¸¥à¸²à¸‡à¸ªà¸³à¸«à¸£à¸±à¸šà¸­à¹ˆà¸²à¸™/à¹€à¸‚à¸µà¸¢à¸™ Google Sheets à¸—à¸¸à¸ sheet à¸œà¹ˆà¸²à¸™à¹„à¸Ÿà¸¥à¹Œà¸™à¸µà¹‰ à¹€à¸žà¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹€à¸‚à¸µà¸¢à¸™à¸‹à¹‰à¸³ â€” à¸•à¹‰à¸­à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸à¹ˆà¸­à¸™ Main.gs à¹à¸¥à¸° Auth.gs à¹€à¸žà¸£à¸²à¸°à¸—à¸±à¹‰à¸‡à¸ªà¸­à¸‡à¹„à¸Ÿà¸¥à¹Œà¹€à¸£à¸µà¸¢à¸à¹ƒà¸Šà¹‰ CRUD à¸ˆà¸²à¸à¸—à¸µà¹ˆà¸™à¸µà¹ˆ

**à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™:**
| à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ |
|----------|----------|
| `readSheetData(spreadsheetId, sheetName, startRow)` | à¸­à¹ˆà¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹‰à¸‡ sheet à¹€à¸›à¹‡à¸™ array of objects |
| `readSheetDataFiltered(spreadsheetId, sheetName, filterColumn, filterValue)` | à¸­à¹ˆà¸²à¸™à¹à¸šà¸šà¸à¸£à¸­à¸‡à¹€à¸‡à¸·à¹ˆà¸­à¸™à¹„à¸‚ |
| `appendRowToSheet(spreadsheetId, sheetName, data)` | à¹€à¸žà¸´à¹ˆà¸¡à¹à¸–à¸§à¹ƒà¸«à¸¡à¹ˆ |
| `updateRowInSheet(spreadsheetId, sheetName, idColumn, idValue, data)` | à¸­à¸±à¸›à¹€à¸”à¸•à¹à¸–à¸§à¸•à¸²à¸¡ ID |
| `deleteRowFromSheet(spreadsheetId, sheetName, idColumn, idValue)` | à¸¥à¸šà¹à¸–à¸§à¸•à¸²à¸¡ ID |
| `getNextId(prefix)` | à¸ªà¸£à¹‰à¸²à¸‡ ID à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ (prefix + timestamp + random) |
| `getSheetByName(spreadsheetId, sheetName)` | à¹€à¸›à¸´à¸” sheet à¸•à¸²à¸¡à¸Šà¸·à¹ˆà¸­ |
| `findRowByValue(spreadsheetId, sheetName, column, value)` | à¸„à¹‰à¸™à¸«à¸²à¹à¸–à¸§à¸•à¸²à¸¡à¸„à¹ˆà¸² |
| `batchAppendRows(spreadsheetId, sheetName, dataArray)` | à¹€à¸žà¸´à¹ˆà¸¡à¸«à¸¥à¸²à¸¢à¹à¸–à¸§à¸žà¸£à¹‰à¸­à¸¡à¸à¸±à¸™ |
| `batchUpdateRows(spreadsheetId, sheetName, idColumn, updates)` | à¸­à¸±à¸›à¹€à¸”à¸•à¸«à¸¥à¸²à¸¢à¹à¸–à¸§à¸žà¸£à¹‰à¸­à¸¡à¸à¸±à¸™ |
| `writeLog(action, userId, detail)` | à¸šà¸±à¸™à¸—à¸¶à¸ Log à¸¥à¸‡ Logs sheet |
| `createBackup(dataFolderId, backupFolderId)` | à¸ªà¸³à¹€à¸™à¸² Sheet à¹„à¸› Backups |

**HTML à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** à¹„à¸¡à¹ˆà¸¡à¸µ HTML à¹€à¸£à¸µà¸¢à¸à¸•à¸£à¸‡ (à¹„à¸Ÿà¸¥à¹Œà¸­à¸·à¹ˆà¸™à¹€à¸£à¸µà¸¢à¸à¹ƒà¸Šà¹‰)

#### ðŸ”’ LockService Pattern â€” à¸›à¹‰à¸­à¸‡à¸à¸±à¸™ Race Condition (S0-5)

> **à¸›à¸±à¸à¸«à¸²:** GAS à¹„à¸¡à¹ˆà¸¡à¸µ lock à¹ƒà¸™à¸•à¸±à¸§ â†’ 2 à¸„à¸™à¹€à¸‚à¸µà¸¢à¸™ Sheet à¸žà¸£à¹‰à¸­à¸¡à¸à¸±à¸™ â†’ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¸šà¸à¸±à¸™  
> **à¸§à¸´à¸˜à¸µà¹à¸à¹‰:** à¸—à¸¸à¸ write function à¸•à¹‰à¸­à¸‡ wrap à¸”à¹‰à¸§à¸¢ `LockService.getScriptLock()` â€” à¸£à¸­ lock à¸ªà¸¹à¸‡à¸ªà¸¸à¸” 30 à¸§à¸´à¸™à¸²à¸—à¸µ

**Pattern à¸¡à¸²à¸•à¸£à¸à¸²à¸™:**

```javascript
// ============ Write Lock Pattern ============
function withLock(callback) {
    const lock = LockService.getScriptLock();
    try {
        if (!lock.tryLock(30000)) { // à¸£à¸­ 30 à¸§à¸´à¸™à¸²à¸—à¸µ
            return { success: false, error: 'à¸£à¸°à¸šà¸šà¸à¸³à¸¥à¸±à¸‡à¸›à¸£à¸°à¸¡à¸§à¸¥à¸œà¸¥ à¸à¸£à¸¸à¸“à¸²à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ' };
        }
        return callback();
    } finally {
        lock.releaseLock();
    }
}
```

**à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡ wrap à¸”à¹‰à¸§à¸¢ `withLock()`:**

| à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¹€à¸«à¸•à¸¸à¸œà¸¥ |
|----------|--------|
| `appendRowToSheet(spreadsheetId, sheetName, data)` | à¹€à¸žà¸´à¹ˆà¸¡à¹à¸–à¸§ â€” à¸•à¹‰à¸­à¸‡ lock à¹€à¸žà¸·à¹ˆà¸­à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¹à¸–à¸§à¸‹à¹‰à¸³ |
| `updateRowInSheet(spreadsheetId, sheetName, idColumn, idValue, data)` | à¹à¸à¹‰à¹„à¸‚à¹à¸–à¸§ â€” à¸•à¹‰à¸­à¸‡ lock à¹€à¸žà¸·à¹ˆà¸­à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¹€à¸‚à¸µà¸¢à¸™à¸—à¸±à¸šà¸à¸±à¸™ |
| `deleteRowFromSheet(spreadsheetId, sheetName, idColumn, idValue)` | à¸¥à¸šà¹à¸–à¸§ â€” à¸•à¹‰à¸­à¸‡ lock à¹€à¸žà¸·à¹ˆà¸­à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸¥à¸šà¸œà¸´à¸”à¹à¸–à¸§ |
| `batchAppendRows(spreadsheetId, sheetName, dataArray)` | à¹€à¸žà¸´à¹ˆà¸¡à¸«à¸¥à¸²à¸¢à¹à¸–à¸§ â€” à¸•à¹‰à¸­à¸‡ lock à¸•à¸¥à¸­à¸”à¸—à¸±à¹‰à¸‡ batch |
| `batchUpdateRows(spreadsheetId, sheetName, idColumn, updates)` | à¹à¸à¹‰à¸«à¸¥à¸²à¸¢à¹à¸–à¸§ â€” à¸•à¹‰à¸­à¸‡ lock à¸•à¸¥à¸­à¸”à¸—à¸±à¹‰à¸‡ batch |

**à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™:**

```javascript
function appendRowToSheet(spreadsheetId, sheetName, data) {
    return withLock(() => {
        const sheet = getSheetByName(spreadsheetId, sheetName);
        const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
        const row = headers.map(h => data[h] || '');
        sheet.appendRow(row);
        return { success: true, message: 'à¹€à¸žà¸´à¹ˆà¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸³à¹€à¸£à¹‡à¸ˆ' };
    });
}

function updateRowInSheet(spreadsheetId, sheetName, idColumn, idValue, data) {
    return withLock(() => {
        const sheet = getSheetByName(spreadsheetId, sheetName);
        const dataRange = sheet.getDataRange().getValues();
        const headers = dataRange[0];
        const idColIndex = headers.indexOf(idColumn);
        
        for (let i = 1; i < dataRange.length; i++) {
            if (dataRange[i][idColIndex] === idValue) {
                headers.forEach((h, j) => {
                    if (data[h] !== undefined) {
                        sheet.getRange(i + 1, j + 1).setValue(data[h]);
                    }
                });
                return { success: true, message: 'à¸­à¸±à¸›à¹€à¸”à¸•à¸ªà¸³à¹€à¸£à¹‡à¸ˆ' };
            }
        }
        return { success: false, error: 'à¹„à¸¡à¹ˆà¸žà¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚' };
    });
}

function deleteRowFromSheet(spreadsheetId, sheetName, idColumn, idValue) {
    return withLock(() => {
        const sheet = getSheetByName(spreadsheetId, sheetName);
        const dataRange = sheet.getDataRange().getValues();
        const headers = dataRange[0];
        const idColIndex = headers.indexOf(idColumn);
        
        for (let i = dataRange.length - 1; i >= 1; i--) {
            if (dataRange[i][idColIndex] === idValue) {
                sheet.deleteRow(i + 1);
                return { success: true, message: 'à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸³à¹€à¸£à¹‡à¸ˆ' };
            }
        }
        return { success: false, error: 'à¹„à¸¡à¹ˆà¸žà¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸¥à¸š' };
    });
}

function batchAppendRows(spreadsheetId, sheetName, dataArray) {
    return withLock(() => {
        const sheet = getSheetByName(spreadsheetId, sheetName);
        const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
        const rows = dataArray.map(data => headers.map(h => data[h] || ''));
        const startRow = sheet.getLastRow() + 1;
        sheet.getRange(startRow, 1, rows.length, headers.length).setValues(rows);
        return { success: true, message: `à¹€à¸žà¸´à¹ˆà¸¡ ${rows.length} à¹à¸–à¸§à¸ªà¸³à¹€à¸£à¹‡à¸ˆ` };
    });
}

function batchUpdateRows(spreadsheetId, sheetName, idColumn, updates) {
    return withLock(() => {
        const sheet = getSheetByName(spreadsheetId, sheetName);
        const dataRange = sheet.getDataRange().getValues();
        const headers = dataRange[0];
        const idColIndex = headers.indexOf(idColumn);
        let updatedCount = 0;
        
        updates.forEach(({ id, data }) => {
            for (let i = 1; i < dataRange.length; i++) {
                if (dataRange[i][idColIndex] === id) {
                    headers.forEach((h, j) => {
                        if (data[h] !== undefined) {
                            sheet.getRange(i + 1, j + 1).setValue(data[h]);
                        }
                    });
                    updatedCount++;
                    break;
                }
            }
        });
        return { success: true, message: `à¸­à¸±à¸›à¹€à¸”à¸• ${updatedCount} à¹à¸–à¸§à¸ªà¸³à¹€à¸£à¹‡à¸ˆ` };
    });
}
```

---

### 3. `Main.gs` â€” ðŸŒ Router à¸«à¸¥à¸±à¸ (à¸ˆà¸¸à¸”à¹€à¸‚à¹‰à¸² Web App)

**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¹€à¸›à¹‡à¸™ Entry Point à¸‚à¸­à¸‡ Web App â€” à¸£à¸±à¸š request à¸ˆà¸²à¸ Frontend (à¸œà¹ˆà¸²à¸™ `fetch()`) à¹à¸¥à¹‰à¸§à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­à¹„à¸›à¸¢à¸±à¸‡à¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡ â€” à¸•à¹‰à¸­à¸‡à¸¡à¸µ Database.gs à¸žà¸£à¹‰à¸­à¸¡à¸à¹ˆà¸­à¸™ à¹€à¸žà¸£à¸²à¸° route à¹„à¸›à¹€à¸£à¸µà¸¢à¸ CRUD

> **âš ï¸ HTML Serving Method:** à¹ƒà¸Šà¹‰ `fetch()` à¹€à¸£à¸µà¸¢à¸ Web App URL (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ `google.script.run`)  
> HTML 22 à¹„à¸Ÿà¸¥à¹Œà¹€à¸›à¹‡à¸™ standalone â€” Frontend à¹€à¸£à¸µà¸¢à¸ Backend à¸œà¹ˆà¸²à¸™ `callBackend(action, data)` à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ `fetch(WEB_APP_URL, ...)` à¸—à¸¸à¸à¸„à¸£à¸±à¹‰à¸‡  
> à¸”à¸¹à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¹ƒà¸™ section "Frontend API Pattern" à¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡

**à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸«à¸¥à¸±à¸:**
| à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ |
|----------|----------|
| `doGet(e)` | à¸£à¸±à¸š GET request â†’ route à¸•à¸²à¸¡ `e.parameter.action` |
| `doPost(e)` | à¸£à¸±à¸š POST request â†’ parse JSON body â†’ route à¸•à¸²à¸¡ `action` â†’ return `ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JSON)` |
| `jsonResponse(data)` | à¸ªà¸£à¹‰à¸²à¸‡ JSON response à¸œà¹ˆà¸²à¸™ `ContentService.createTextOutput(JSON.stringify(data)).setMimeType(ContentService.MimeType.JSON)` |
| `errorResponse(code, message)` | à¸ªà¸£à¹‰à¸²à¸‡ error response à¸¡à¸²à¸•à¸£à¸à¸²à¸™ |
| `validateSession(token)` | à¹€à¸£à¸µà¸¢à¸ Auth.gs à¸•à¸£à¸§à¸ˆ session |

**GET Actions (17 routes):**
| Action | à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­à¹„à¸›à¸¢à¸±à¸‡ | à¹„à¸Ÿà¸¥à¹Œ .gs |
|--------|-----------|---------|
| `getSettings` | `getSettings()` | Housing.gs |
| `getHousing` | `getHousingList()` | Housing.gs |
| `getResidents` | `getResidentsList()` | Housing.gs |
| `getUserProfile` | `getUserProfile(userId)` | Housing.gs |
| `getCoresidents` | `getCoresidents(residentId)` | Housing.gs |
| `getWaterBills` | `getWaterBills(period)` | Billing.gs |
| `getElectricBills` | `getElectricBills(period)` | Billing.gs |
| `getSlipSubmissions` | `getSlipSubmissions(period)` | Payment.gs |
| `getPaymentHistory` | `getPaymentHistory(userId)` | Payment.gs |
| `getOutstanding` | `getOutstanding(period)` | Payment.gs |
| `getRequests` | `getRequests(type, year, filters)` | Request.gs |
| `getQueue` | `getQueue()` | Request.gs |
| `getIncome` | `getIncome(period)` | Finance.gs |
| `getExpense` | `getExpense(period)` | Finance.gs |
| `getAnnouncements` | `getAnnouncements()` | Housing.gs |
| `getPendingRegistrations` | `getPendingRegistrations()` | Auth.gs |
| `getNotificationHistory` | `getNotificationHistory(period)` | Billing.gs |

**POST Actions (18 routes):**
| Action | à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­à¹„à¸›à¸¢à¸±à¸‡ | à¹„à¸Ÿà¸¥à¹Œ .gs |
|--------|-----------|---------|
| `login` | `handleLogin(data)` | Auth.gs |
| `register` | `handleRegister(data)` | Auth.gs |
| `resetPassword` | `handleResetPassword(data)` | Auth.gs |
| `findEmail` | `handleFindEmail(data)` | Auth.gs |
| `updateProfile` | `handleUpdateProfile(data)` | Housing.gs |
| `changePassword` | `handleChangePassword(data)` | Auth.gs |
| `addCoresident` | `addCoresident(data)` | Housing.gs |
| `updateCoresident` | `updateCoresident(id, data)` | Housing.gs |
| `removeCoresident` | `removeCoresident(id)` | Housing.gs |
| `submitWaterBill` | `saveWaterBill(data)` | Billing.gs |
| `submitElectricBill` | `saveElectricBill(data)` | Billing.gs |
| `submitSlip` | `handleSubmitSlip(data)` | Payment.gs |
| `reviewSlip` | `handleReviewSlip(data)` | Payment.gs |
| `submitRequest` | `handleSubmitRequest(data)` | Request.gs |
| `reviewRequest` | `handleReviewRequest(data)` | Request.gs |
| `updateQueue` | `handleUpdateQueue(data)` | Request.gs |
| `saveWithdraw` | `handleSaveWithdraw(data)` | Finance.gs |
| `saveAccounting` | `handleSaveAccounting(data)` | Finance.gs |
| `updateSettings` | `handleUpdateSettings(data)` | Housing.gs |
| `addAnnouncement` | `handleAddAnnouncement(data)` | Housing.gs |
| `deleteAnnouncement` | `deleteAnnouncement(id)` | Housing.gs |
| `addResident` | `addResident(data)` | Housing.gs |
| `updateResident` | `updateResident(id, data)` | Housing.gs |
| `removeResident` | `removeResident(id)` | Housing.gs |
| `addHousing` | `addHousing(data)` | Housing.gs |
| `updateHousing` | `updateHousing(id, data)` | Housing.gs |
| `deleteHousing` | `deleteHousing(id)` | Housing.gs |
| `updatePermissions` | `updatePermissions(data)` | Housing.gs |
| `sendNotification` | `handleSendNotification(data)` | Notification.gs |
| `approveRegistration` | `approveRegistration(regId, data)` | Auth.gs |
| `rejectRegistration` | `rejectRegistration(regId, note)` | Auth.gs |
| `saveNotificationSnapshot` | `saveNotificationSnapshot(period, data)` | Billing.gs |

**HTML à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** à¸—à¸¸à¸à¹„à¸Ÿà¸¥à¹Œ (à¸—à¸¸à¸ request à¸œà¹ˆà¸²à¸™ Main.gs à¸”à¹‰à¸§à¸¢ `fetch()`)  

**doPost() Response Format:**
```javascript
function doPost(e) {
    try {
        const body = JSON.parse(e.postData.contents);
        const { action, token, ...data } = body;
        
        // ---- Public Actions (à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡ auth) ----
        const PUBLIC_ACTIONS = ['login', 'register', 'resetPassword', 'findEmail'];
        
        if (!PUBLIC_ACTIONS.includes(action)) {
            // ---- Protected Actions (à¸•à¹‰à¸­à¸‡ auth) ----
            const session = validateSession(token);
            if (!session) {
                return jsonResponse({ success: false, error: 'SESSION_EXPIRED' });
            }
            data._userId = session.userId; // à¹à¸™à¸š userId à¹ƒà¸«à¹‰ handler
        }
        
        // Route à¸•à¸²à¸¡ action ...
        const result = routeAction(action, data);
        return jsonResponse(result);
        
    } catch (err) {
        return errorResponse('INTERNAL_ERROR', err.message);
    }
}

function jsonResponse(data) {
    return ContentService
        .createTextOutput(JSON.stringify(data))
        .setMimeType(ContentService.MimeType.JSON);
}
```

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸ CORS:** GAS Web App deployed as "Anyone" à¸ˆà¸° redirect (302) à¸à¹ˆà¸­à¸™à¸•à¸­à¸š â€” Frontend à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰ `redirect: 'follow'` à¹ƒà¸™ fetch options  
> GAS à¹„à¸¡à¹ˆà¸£à¸­à¸‡à¸£à¸±à¸š custom CORS headers à¹‚à¸”à¸¢à¸•à¸£à¸‡ à¹à¸•à¹ˆ `Content-Type: text/plain` + `redirect: 'follow'` à¸—à¸³à¸‡à¸²à¸™à¸‚à¹‰à¸²à¸¡ origin à¹„à¸”à¹‰  
> Frontend à¹ƒà¸Šà¹‰ `headers: { 'Content-Type': 'text/plain' }` (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ `application/json`) à¹€à¸žà¸£à¸²à¸° GAS à¹„à¸¡à¹ˆà¸£à¸±à¸š preflight CORS request

**Public Actions (à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸•à¸£à¸§à¸ˆ session):**
| Action | à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¹€à¸«à¸•à¸¸à¸œà¸¥à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡ auth |
|--------|---------|---------------------|
| `login` | `handleLogin(data)` | à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µ token |
| `register` | `handleRegister(data)` | à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸šà¸±à¸à¸Šà¸µ |
| `resetPassword` | `handleResetPassword(data)` | à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸¥à¸·à¸¡à¸£à¸«à¸±à¸ª à¹€à¸‚à¹‰à¸²à¸£à¸°à¸šà¸šà¹„à¸¡à¹ˆà¹„à¸”à¹‰ |
| `findEmail` | `handleFindEmail(data)` | à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸¥à¸·à¸¡ email à¹€à¸‚à¹‰à¸²à¸£à¸°à¸šà¸šà¹„à¸¡à¹ˆà¹„à¸”à¹‰ |

---

### 3.1 Frontend API Pattern â€” à¸§à¸´à¸˜à¸µà¹€à¸£à¸µà¸¢à¸ Backend à¸ˆà¸²à¸ HTML

> **à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆ:** à¹ƒà¸Šà¹‰ `fetch()` à¹€à¸£à¸µà¸¢à¸ Web App URL (à¸§à¸´à¸˜à¸µ B) â€” **à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ** `google.script.run`  
> **à¹€à¸«à¸•à¸¸à¸œà¸¥:**  
> 1. HTML 22 à¹„à¸Ÿà¸¥à¹Œà¹€à¸›à¹‡à¸™ standalone à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§ â€” à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸¢à¹‰à¸²à¸¢à¹€à¸‚à¹‰à¸² GAS project  
> 2. `google.script.run` à¸¡à¸µ payload limit ~256KB â€” à¸ªà¸¥à¸´à¸› base64 à¹€à¸à¸´à¸™à¹„à¸”à¹‰  
> 3. `fetch()` à¸£à¸­à¸‡à¸£à¸±à¸š progress tracking, timeout, retry à¹„à¸”à¹‰à¸”à¸µà¸à¸§à¹ˆà¸²  
> 4. à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹à¸à¹‰ navigation (`href="dashboard.html"` à¹ƒà¸Šà¹‰à¹„à¸”à¹‰à¹€à¸¥à¸¢)

**Pattern à¸¡à¸²à¸•à¸£à¸à¸²à¸™à¸—à¸µà¹ˆà¸—à¸¸à¸ HTML à¸•à¹‰à¸­à¸‡à¹ƒà¸ªà¹ˆ:**

```javascript
// ============ API Configuration ============
const WEB_APP_URL = ''; // â† à¹ƒà¸ªà¹ˆ URL à¸«à¸¥à¸±à¸‡ Deploy (Step 18)
// à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸«à¸¥à¸±à¸‡ Deploy à¸„à¸£à¸±à¹‰à¸‡à¹à¸£à¸: à¹€à¸›à¸´à¸” GAS Editor â†’ Deploy â†’ New deployment â†’ Web app â†’ Copy URL

// ============ API Helper ============
async function callBackend(action, data = {}) {
    const token = sessionStorage.getItem('sessionToken');
    const payload = { action, token, ...data };
    
    try {
        const response = await fetch(WEB_APP_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'text/plain' }, // GAS à¹„à¸¡à¹ˆà¸£à¸±à¸š application/json à¸•à¸£à¸‡
            body: JSON.stringify(payload),
            redirect: 'follow' // GAS redirect à¸«à¸¥à¸±à¸‡ deploy
        });
        
        const text = await response.text();
        const result = JSON.parse(text);
        
        if (result.error === 'SESSION_EXPIRED') {
            sessionStorage.clear();
            window.location.href = 'login.html';
            return;
        }
        
        return result;
    } catch (err) {
        console.error('Backend error:', err);
        throw new Error('à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¸£à¸°à¸šà¸šà¹„à¸”à¹‰ â€” à¸à¸£à¸¸à¸“à¸²à¸¥à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ');
    }
}

// ============ Session Check (à¹ƒà¸ªà¹ˆà¸—à¸¸à¸à¸«à¸™à¹‰à¸²à¸¢à¸à¹€à¸§à¹‰à¸™ login/register/forgot) ============
async function checkSession() {
    const token = sessionStorage.getItem('sessionToken');
    if (!token) { window.location.href = 'login.html'; return false; }
    
    const result = await callBackend('getCurrentUser');
    if (!result || !result.success) { 
        sessionStorage.clear();
        window.location.href = 'login.html'; 
        return false; 
    }
    return result.user;
}
```

**à¸•à¸±à¸§à¸­à¸¢à¹ˆà¸²à¸‡à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹ƒà¸™ HTML:**
```javascript
// ===== login.html =====
async function handleLoginSubmit() {
    const result = await callBackend('login', { email, password });
    if (result.success) {
        sessionStorage.setItem('sessionToken', result.token);
        window.location.href = 'dashboard.html';
    }
}

// ===== dashboard.html =====
window.onload = async () => {
    const user = await checkSession();
    if (!user) return;
    // à¹‚à¸«à¸¥à¸”à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ dashboard...
    const announcements = await callBackend('getAnnouncements');
    const bills = await callBackend('getBillSummary', { houseId: user.houseId });
};

// ===== upload-slip.html =====
async function submitSlip(slipData) {
    const result = await callBackend('submitSlip', slipData);
    if (result.success) { showToast('à¸ªà¹ˆà¸‡à¸ªà¸¥à¸´à¸›à¸ªà¸³à¹€à¸£à¹‡à¸ˆ'); }
}
```

**à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡ `checkSession()`:** `login.html`, `register.html`, `forgot-password.html`, `forgot-email.html`  
**à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¹€à¸£à¸µà¸¢à¸ Backend à¹€à¸¥à¸¢:** `form.html` (à¹à¸ªà¸”à¸‡à¸œà¸¥à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸”à¸µà¸¢à¸§)

---

### 4. `Auth.gs` â€” ðŸ” à¸£à¸°à¸šà¸šà¸¢à¸·à¸™à¸¢à¸±à¸™à¸•à¸±à¸§à¸•à¸™

**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¸ˆà¸±à¸”à¸à¸²à¸£ Login/Register/Session/à¸£à¸µà¹€à¸‹à¹‡à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™ â€” à¸•à¹‰à¸­à¸‡à¸¡à¸µ Database.gs à¸žà¸£à¹‰à¸­à¸¡à¸à¹ˆà¸­à¸™ à¹€à¸žà¸£à¸²à¸°à¹€à¸£à¸µà¸¢à¸ CRUD à¸ªà¸³à¸«à¸£à¸±à¸šà¸­à¹ˆà¸²à¸™/à¹€à¸‚à¸µà¸¢à¸™ Users sheet

**à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™:**
| à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ | Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ |
|----------|----------|------------|
| `handleLogin(email, password)` | à¸•à¸£à¸§à¸ˆ email/password â†’ à¸ªà¸£à¹‰à¸²à¸‡ session token | Users |
| `handleRegister(userData)` | à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸¥à¸‡ PendingReg_{à¸›à¸µ} (à¸ªà¸–à¸²à¸™à¸° pending) à¸£à¸­à¹à¸­à¸”à¸¡à¸´à¸™à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ | PendingReg_{à¸›à¸µ} ([MAIN]) |
| `getPendingRegistrations()` | à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸ªà¸¡à¸±à¸„à¸£à¸—à¸µà¹ˆà¸£à¸­à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ (status=pending) | PendingReg_{à¸›à¸µ} ([MAIN]) |
| `approveRegistration(regId, data)` | à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ â†’ à¸ªà¸£à¹‰à¸²à¸‡ Users + Residents + à¸­à¸±à¸›à¹€à¸”à¸• PendingReg status | PendingReg_{à¸›à¸µ}, Users, Residents ([MAIN]) |
| `rejectRegistration(regId, note)` | à¸›à¸à¸´à¹€à¸ªà¸˜ â†’ à¸­à¸±à¸›à¹€à¸”à¸• PendingReg status + à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸ | PendingReg_{à¸›à¸µ} ([MAIN]) |
| `createPendingRegYearSheet(year)` | à¸ªà¸£à¹‰à¸²à¸‡à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™ PendingReg_{à¸›à¸µ} à¹ƒà¸«à¸¡à¹ˆà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ | [MAIN] |
| `handleResetPassword(email)` | à¸ªà¹ˆà¸‡ email à¸£à¸µà¹€à¸‹à¹‡à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™ | Users |
| `handleFindEmail(phone)` | à¸„à¹‰à¸™à¸«à¸² email à¸ˆà¸²à¸à¹€à¸šà¸­à¸£à¹Œà¹‚à¸—à¸£ | Users |
| `handleChangePassword(userId, oldPass, newPass)` | à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™ | Users |
| `createSession(userId)` | à¸ªà¸£à¹‰à¸²à¸‡ session token (UUID) à¹€à¸à¹‡à¸šà¹ƒà¸™ PropertiesService | - |
| `validateSession(token)` | à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š token + à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸ 24 à¸Šà¸¡. | - |
| `destroySession(token)` | à¸¥à¸š session (Logout) | - |
| `hashPassword(password)` | SHA-256 hash password | - |
| `checkPermission(userId, permType)` | à¸•à¸£à¸§à¸ˆà¸ªà¸´à¸—à¸˜à¸´à¹Œà¸ˆà¸²à¸ Permissions sheet | Permissions |
| `getCurrentUser(token)` | à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ user à¸ˆà¸²à¸ token | Users, Residents |

**HTML à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:**
- `login.html` â†’ `handleLogin` â€” âš ï¸ à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ validateForm() à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- `register.html` â†’ `handleRegister` â€” âš ï¸ à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ validate à¹à¸•à¹ˆà¹„à¸¡à¹ˆà¸šà¸±à¸™à¸—à¸¶à¸ â†’ à¸•à¹‰à¸­à¸‡à¹€à¸žà¸´à¹ˆà¸¡à¸à¸²à¸£à¹€à¸£à¸µà¸¢à¸ Backend + à¹à¸ªà¸”à¸‡ "à¸£à¸­à¹à¸­à¸”à¸¡à¸´à¸™à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´"
- `admin-settings.html` â†’ `getPendingRegistrations`, `approveRegistration`, `rejectRegistration` â€” âš ï¸ à¸•à¹‰à¸­à¸‡à¹€à¸žà¸´à¹ˆà¸¡à¹à¸—à¹‡à¸š "à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸à¸²à¸£à¸ªà¸¡à¸±à¸„à¸£"
- `forgot-password.html` â†’ `handleResetPassword` â€” âš ï¸ à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ validate à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- `forgot-email.html` â†’ `handleFindEmail` â€” âš ï¸ à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ validate à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- `settings.html` â†’ `handleChangePassword`
- à¸—à¸¸à¸à¸«à¸™à¹‰à¸² â†’ `validateSession`, `getCurrentUser`

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸ HTML:**
> - `register.html` à¸¡à¸µà¸Ÿà¸´à¸¥à¸”à¹Œ `pdpaConsent` â€” à¸•à¹‰à¸­à¸‡à¸šà¸±à¸™à¸—à¸¶à¸à¸¥à¸‡ PendingReg_{à¸›à¸µ} sheet (à¸¢à¹‰à¸²à¸¢à¹„à¸› Users à¹€à¸¡à¸·à¹ˆà¸­à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´)
> - `register.html` à¸¡à¸µà¸Ÿà¸´à¸¥à¸”à¹Œ `phone` â€” à¸•à¹‰à¸­à¸‡à¹€à¸à¹‡à¸šà¹ƒà¸™ PendingReg_{à¸›à¸µ} à¹à¸¥à¹‰à¸§à¸¢à¹‰à¸²à¸¢à¹„à¸› Users à¹€à¸¡à¸·à¹ˆà¸­à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ à¹€à¸žà¸·à¹ˆà¸­à¹ƒà¸«à¹‰ `forgot-email.html` à¸„à¹‰à¸™à¸«à¸²à¹„à¸”à¹‰
> - `register.html` à¹ƒà¸Šà¹‰ `position` (select) à¹€à¸à¹‡à¸šà¸„à¹ˆà¸²à¸à¸¥à¸¸à¹ˆà¸¡à¸ªà¸²à¸£à¸°: à¸ à¸²à¸©à¸²à¹„à¸—à¸¢, à¸„à¸“à¸´à¸•à¸¨à¸²à¸ªà¸•à¸£à¹Œ, à¸§à¸´à¸—à¸¢à¸²à¸¨à¸²à¸ªà¸•à¸£à¹Œà¸¯, etc.
> - `admin-settings.html` à¹€à¸à¹‡à¸š password (btoa base64) à¹„à¸§à¹‰à¹ƒà¸™ residentsData â€” Backend à¸•à¹‰à¸­à¸‡ hash à¹€à¸›à¹‡à¸™ SHA-256 à¹à¸¢à¸à¹€à¸à¹‡à¸šà¹ƒà¸™ Users sheet
> - à¸—à¸¸à¸ form (login/register/forgot) à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ `return false` à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¹€à¸£à¸µà¸¢à¸ Backend à¸ˆà¸£à¸´à¸‡

#### ðŸ§¹ Session Cleanup â€” à¸¥à¸š session à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ (S0-7)

> **à¸›à¸±à¸à¸«à¸²:** `PropertiesService` à¹„à¸¡à¹ˆà¸¡à¸µ TTL â†’ session token à¸ªà¸°à¸ªà¸¡à¹€à¸£à¸·à¹ˆà¸­à¸¢à¹† à¹„à¸¡à¹ˆà¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸ â†’ Properties à¸šà¸§à¸¡à¸ˆà¸™à¹€à¸•à¹‡à¸¡ quota  
> **à¸§à¸´à¸˜à¸µà¹à¸à¹‰:** à¹€à¸žà¸´à¹ˆà¸¡ `cleanupExpiredSessions()` + à¸•à¸±à¹‰à¸‡ Trigger à¸£à¸²à¸¢à¸§à¸±à¸™

**à¹€à¸žà¸´à¹ˆà¸¡à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹ƒà¸™ Auth.gs:**

```javascript
// ============ Session Cleanup ============

/**
 * à¸¥à¸š session token à¸—à¸µà¹ˆà¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸ (à¹€à¸à¸´à¸™ 24 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡) à¸ˆà¸²à¸ PropertiesService
 * à¸•à¸±à¹‰à¸‡à¹€à¸›à¹‡à¸™ Trigger à¸£à¸²à¸¢à¸§à¸±à¸™ â€” à¸£à¸±à¸™à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
 */
function cleanupExpiredSessions() {
    const props = PropertiesService.getScriptProperties();
    const allProps = props.getProperties();
    const now = Date.now();
    const MAX_AGE_MS = 24 * 60 * 60 * 1000; // 24 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡
    let deletedCount = 0;
    
    for (const key in allProps) {
        // session token à¹€à¸à¹‡à¸šà¹€à¸›à¹‡à¸™ key à¸‚à¸¶à¹‰à¸™à¸•à¹‰à¸™à¸”à¹‰à¸§à¸¢ 'session_'
        if (key.startsWith('session_')) {
            try {
                const sessionData = JSON.parse(allProps[key]);
                if (now - sessionData.createdAt > MAX_AGE_MS) {
                    props.deleteProperty(key);
                    deletedCount++;
                }
            } catch (e) {
                // JSON parse error â†’ session à¹€à¸ªà¸µà¸¢ â†’ à¸¥à¸šà¸—à¸´à¹‰à¸‡
                props.deleteProperty(key);
                deletedCount++;
            }
        }
    }
    
    Logger.log(`cleanupExpiredSessions: à¸¥à¸š ${deletedCount} session à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸`);
    return { success: true, deleted: deletedCount };
}

/**
 * à¸•à¸±à¹‰à¸‡ Trigger Cleanup à¸£à¸²à¸¢à¸§à¸±à¸™ â€” à¹€à¸£à¸µà¸¢à¸à¸„à¸£à¸±à¹‰à¸‡à¹€à¸”à¸µà¸¢à¸§à¸•à¸­à¸™ setup
 * à¸•à¸£à¸§à¸ˆà¸§à¹ˆà¸²à¸¡à¸µ Trigger à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸ªà¸£à¹‰à¸²à¸‡à¸‹à¹‰à¸³
 */
function setupSessionCleanupTrigger() {
    // à¸¥à¸š Trigger à¹€à¸à¹ˆà¸² (à¸–à¹‰à¸²à¸¡à¸µ) à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸‹à¹‰à¸³
    const triggers = ScriptApp.getProjectTriggers();
    triggers.forEach(trigger => {
        if (trigger.getHandlerFunction() === 'cleanupExpiredSessions') {
            ScriptApp.deleteTrigger(trigger);
        }
    });
    
    // à¸ªà¸£à¹‰à¸²à¸‡ Trigger à¹ƒà¸«à¸¡à¹ˆ â€” à¸£à¸±à¸™à¸—à¸¸à¸ 24 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡
    ScriptApp.newTrigger('cleanupExpiredSessions')
        .timeBased()
        .everyHours(24)
        .create();
    
    Logger.log('setupSessionCleanupTrigger: à¸•à¸±à¹‰à¸‡ Trigger Cleanup à¸£à¸²à¸¢à¸§à¸±à¸™à¸ªà¸³à¹€à¸£à¹‡à¸ˆ');
}
```

**Session Storage Format:**

```javascript
// à¸•à¸­à¸™à¸ªà¸£à¹‰à¸²à¸‡ session à¹ƒà¸™ createSession()
function createSession(userId) {
    const token = Utilities.getUuid();
    const sessionData = {
        userId: userId,
        createdAt: Date.now() // â† à¹ƒà¸Šà¹‰à¸•à¸£à¸§à¸ˆà¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸
    };
    PropertiesService.getScriptProperties().setProperty(
        'session_' + token, 
        JSON.stringify(sessionData)
    );
    return token;
}

// à¸•à¸­à¸™à¸•à¸£à¸§à¸ˆ session à¹ƒà¸™ validateSession()
function validateSession(token) {
    if (!token) return null;
    const props = PropertiesService.getScriptProperties();
    const raw = props.getProperty('session_' + token);
    if (!raw) return null;
    
    try {
        const sessionData = JSON.parse(raw);
        const MAX_AGE_MS = 24 * 60 * 60 * 1000;
        
        // à¸•à¸£à¸§à¸ˆà¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸ realtime
        if (Date.now() - sessionData.createdAt > MAX_AGE_MS) {
            props.deleteProperty('session_' + token);
            return null;
        }
        
        return sessionData; // { userId, createdAt }
    } catch (e) {
        props.deleteProperty('session_' + token);
        return null;
    }
}
```

**à¸à¸²à¸£à¸•à¸±à¹‰à¸‡ Trigger:**
- à¹€à¸£à¸µà¸¢à¸ `setupSessionCleanupTrigger()` à¸„à¸£à¸±à¹‰à¸‡à¹€à¸”à¸µà¸¢à¸§à¸«à¸¥à¸±à¸‡ deploy (à¸«à¸£à¸·à¸­à¹ƒà¸ªà¹ˆà¹ƒà¸™ `setupAll()` à¸‚à¸­à¸‡ setup.gs)
- Trigger à¸ˆà¸°à¸£à¸±à¸™à¸—à¸¸à¸ 24 à¸Šà¸¡. à¸¥à¸š session à¸—à¸µà¹ˆà¹€à¸à¸´à¸™ 24 à¸Šà¸¡. à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´
- Properties à¹„à¸¡à¹ˆà¸šà¸§à¸¡ â†’ à¸£à¸°à¸šà¸šà¸—à¸³à¸‡à¸²à¸™à¹„à¸”à¹‰à¸¢à¸²à¸§à¸™à¸²à¸™

---

### 5. `Housing.gs` â€” ðŸ  à¸šà¹‰à¸²à¸™à¸žà¸±à¸à¹à¸¥à¸°à¸œà¸¹à¹‰à¸žà¸±à¸à¸­à¸²à¸¨à¸±à¸¢

**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸šà¹‰à¸²à¸™à¸žà¸±à¸, à¸œà¸¹à¹‰à¸žà¸±à¸à¸­à¸²à¸¨à¸±à¸¢, à¸œà¸¹à¹‰à¸£à¹ˆà¸§à¸¡à¸žà¸±à¸, à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸£à¸°à¸šà¸š, à¸›à¸£à¸°à¸à¸²à¸¨

**à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™:**
| à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ | Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ |
|----------|----------|------------|
| `getHousingList()` | à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸šà¹‰à¸²à¸™à¸žà¸±à¸à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” | Housing |
| `addHousing(data)` | à¹€à¸žà¸´à¹ˆà¸¡à¸šà¹‰à¸²à¸™à¸žà¸±à¸à¹ƒà¸«à¸¡à¹ˆ | Housing |
| `updateHousing(id, data)` | à¹à¸à¹‰à¹„à¸‚à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸šà¹‰à¸²à¸™à¸žà¸±à¸ | Housing |
| `deleteHousing(id)` | à¸¥à¸šà¸šà¹‰à¸²à¸™à¸žà¸±à¸ | Housing |
| `getAvailableHousing()` | à¸”à¸¶à¸‡à¸šà¹‰à¸²à¸™à¸§à¹ˆà¸²à¸‡ (status=available) | Housing |
| `getResidentsList()` | à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸œà¸¹à¹‰à¸žà¸±à¸à¸­à¸²à¸¨à¸±à¸¢ | Residents |
| `addResident(data)` | à¹€à¸žà¸´à¹ˆà¸¡à¸œà¸¹à¹‰à¸žà¸±à¸à¸­à¸²à¸¨à¸±à¸¢ | Residents |
| `updateResident(id, data)` | à¹à¸à¹‰à¹„à¸‚à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¸žà¸±à¸à¸­à¸²à¸¨à¸±à¸¢ | Residents |
| `moveResident(id, newHouse)` | à¸¢à¹‰à¸²à¸¢à¸šà¹‰à¸²à¸™à¸œà¸¹à¹‰à¸žà¸±à¸à¸­à¸²à¸¨à¸±à¸¢ | Residents, Housing |
| `removeResident(id)` | à¸¥à¸šà¸œà¸¹à¹‰à¸žà¸±à¸à¸­à¸²à¸¨à¸±à¸¢ | Residents, Housing |
| `getUserProfile(userId)` | à¸”à¸¶à¸‡à¹‚à¸›à¸£à¹„à¸Ÿà¸¥à¹Œ user | Users, Residents |
| `handleUpdateProfile(data)` | à¸­à¸±à¸›à¹€à¸”à¸•à¹‚à¸›à¸£à¹„à¸Ÿà¸¥à¹Œ | Users, Residents |
| `getCoresidents(residentId)` | à¸”à¸¶à¸‡à¸œà¸¹à¹‰à¸£à¹ˆà¸§à¸¡à¸žà¸±à¸ | Residents |
| `addCoresident(data)` | à¹€à¸žà¸´à¹ˆà¸¡à¸œà¸¹à¹‰à¸£à¹ˆà¸§à¸¡à¸žà¸±à¸ | Residents |
| `updateCoresident(id, data)` | à¹à¸à¹‰à¹„à¸‚à¸œà¸¹à¹‰à¸£à¹ˆà¸§à¸¡à¸žà¸±à¸ | Residents |
| `removeCoresident(id)` | à¸¥à¸šà¸œà¸¹à¹‰à¸£à¹ˆà¸§à¸¡à¸žà¸±à¸ | Residents |
| `getSettings()` | à¸”à¸¶à¸‡à¸„à¹ˆà¸²à¸•à¸±à¹‰à¸‡à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸” | Settings |
| `handleUpdateSettings(data)` | à¸­à¸±à¸›à¹€à¸”à¸•à¸„à¹ˆà¸²à¸•à¸±à¹‰à¸‡ | Settings |
| `getAnnouncements()` | à¸”à¸¶à¸‡à¸›à¸£à¸°à¸à¸²à¸¨ | Announcements |
| `handleAddAnnouncement(data)` | à¹€à¸žà¸´à¹ˆà¸¡à¸›à¸£à¸°à¸à¸²à¸¨ | Announcements |
| `deleteAnnouncement(id)` | à¸¥à¸šà¸›à¸£à¸°à¸à¸²à¸¨ | Announcements |
| `getPermissions()` | à¸”à¸¶à¸‡ Permission matrix | Permissions |
| `updatePermissions(data)` | à¸­à¸±à¸›à¹€à¸”à¸•à¸ªà¸´à¸—à¸˜à¸´à¹Œà¸—à¸µà¸¡ | Permissions |
| `uploadRegulationsPdf(base64)` | à¸­à¸±à¸›à¹‚à¸«à¸¥à¸” PDF à¸£à¸°à¹€à¸šà¸µà¸¢à¸š (à¹à¸—à¸™à¹„à¸Ÿà¸¥à¹Œà¹€à¸”à¸´à¸¡) | Documents folder |
| `getRegulationsPdf()` | à¸”à¸¶à¸‡ URL à¸£à¸°à¹€à¸šà¸µà¸¢à¸š PDF à¸¥à¹ˆà¸²à¸ªà¸¸à¸”à¸ˆà¸²à¸à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ (à¹ƒà¸Šà¹‰à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸«à¸¡à¹ˆà¸ªà¸¸à¸”à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™) | Documents folder |

**HTML à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:**
- `admin-settings.html` â†’ CRUD Housing, Residents, Settings, Announcements, Permissions
- `dashboard.html` â†’ `getAnnouncements`, `getSettings`
- `settings.html` â†’ `getUserProfile`, `handleUpdateProfile`, Coresidents
- `register.html` â†’ `handleUpdateProfile` (à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸š settings â€” address, position, subject_group)
- `regulations.html` â†’ `getRegulationsPdf`
- `team-management.html` â†’ `getPermissions` (à¸•à¸£à¸§à¸ˆà¸ªà¸´à¸—à¸˜à¸´à¹Œ)
- `transfer-form.html` â†’ `getAvailableHousing`

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸ HTML:**
> - Housing status à¹ƒà¸Šà¹‰ `available`/`occupied`/`maintenance` (à¹„à¸¡à¹ˆà¸¡à¸µ `vacant`/`reserved`)
> - Residents à¹ƒà¸Šà¹‰ `residentType: 'staff'|'cohabitant'` (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ `main`/`co`)
> - Residents à¸¡à¸µà¸Ÿà¸´à¸¥à¸”à¹Œà¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ 7 à¸Šà¹ˆà¸­à¸‡: address_no, address_road, address_village, subdistrict, district, province, zipcode
> - settings.html à¸¡à¸µà¸—à¸±à¹‰à¸‡ `position` + `subject_group` à¹à¸¢à¸à¸à¸±à¸™
> - settings.html à¹€à¸à¹‡à¸š `profilePhoto` à¹€à¸›à¹‡à¸™ base64
> - admin-settings.html à¹€à¸à¹‡à¸š password (btoa) à¹ƒà¸™ resident object â€” Backend à¸•à¹‰à¸­à¸‡ normalize à¹„à¸› Users sheet

---

### 6. `Billing.gs` â€” ðŸ’§âš¡ à¸„à¹ˆà¸²à¸™à¹‰à¸³ à¸„à¹ˆà¸²à¹„à¸Ÿ à¸„à¹ˆà¸²à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡

**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¸„à¸³à¸™à¸§à¸“à¹à¸¥à¸°à¸šà¸±à¸™à¸—à¸¶à¸à¸„à¹ˆà¸²à¸™à¹‰à¸³, à¸„à¹ˆà¸²à¹„à¸Ÿ, à¸„à¹ˆà¸²à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡, à¸ªà¸£à¸¸à¸›à¸¢à¸­à¸”à¸£à¸²à¸¢à¸šà¹‰à¸²à¸™

**à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™:**
| à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ | Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ |
|----------|----------|------------|
| `getWaterBills(period)` | à¸”à¸¶à¸‡à¸šà¸´à¸¥à¸™à¹‰à¸³à¸•à¸²à¸¡à¹€à¸”à¸·à¸­à¸™ (à¸ˆà¸²à¸à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡) | {year} ([WATER]) |
| `saveWaterBill(period, records)` | à¸šà¸±à¸™à¸—à¸¶à¸à¹€à¸¥à¸‚à¸¡à¸´à¹€à¸•à¸­à¸£à¹Œ/à¸„à¸³à¸™à¸§à¸“à¸„à¹ˆà¸²à¸™à¹‰à¸³ | {year} ([WATER]) |
| `createWaterYearSheet(year)` | à¸ªà¸£à¹‰à¸²à¸‡à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¹ƒà¸«à¸¡à¹ˆà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸žà¸£à¹‰à¸­à¸¡ Header | [WATER] |
| `getPreviousWaterMeter(houseId, period)` | à¸”à¸¶à¸‡à¹€à¸¥à¸‚à¸¡à¸´à¹€à¸•à¸­à¸£à¹Œà¹€à¸”à¸·à¸­à¸™à¸à¹ˆà¸­à¸™ | {year} ([WATER]) |
| `calculateWaterAmount(prevMeter, currMeter, rate)` | à¸„à¸³à¸™à¸§à¸“à¸„à¹ˆà¸²à¸™à¹‰à¸³ | - |
| `getWaterRate()` | à¸”à¸¶à¸‡à¸­à¸±à¸•à¸£à¸²à¸„à¹ˆà¸²à¸™à¹‰à¸³ | WaterRates ([MAIN]) |
| `updateWaterRate(rate)` | à¹à¸à¹‰à¹„à¸‚à¸­à¸±à¸•à¸£à¸²à¸„à¹ˆà¸²à¸™à¹‰à¸³ | WaterRates ([MAIN]) |
| `getElectricBills(period)` | à¸”à¸¶à¸‡à¸šà¸´à¸¥à¹„à¸Ÿà¸•à¸²à¸¡à¹€à¸”à¸·à¸­à¸™ (à¸ˆà¸²à¸à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡) | {year} ([ELECTRIC]) |
| `saveElectricBill(period, peaTotal, lostHouse, lostFlat, records)` | à¸šà¸±à¸™à¸—à¸¶à¸à¸„à¹ˆà¸²à¹„à¸Ÿ | {year} ([ELECTRIC]) |
| `createElectricYearSheet(year)` | à¸ªà¸£à¹‰à¸²à¸‡à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¹ƒà¸«à¸¡à¹ˆà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸žà¸£à¹‰à¸­à¸¡ Header | [ELECTRIC] |
| `getCommonFee()` | à¸”à¸¶à¸‡à¸„à¹ˆà¸²à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡ | CommonFee ([MAIN]) |
| `updateCommonFee(houseRate, flatRate)` | à¹à¸à¹‰à¹„à¸‚à¸„à¹ˆà¸²à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡ | CommonFee ([MAIN]) |
| `getExemptions()` | à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸¢à¸à¹€à¸§à¹‰à¸™ | Exemptions ([MAIN]) |
| `updateExemptions(data)` | à¸­à¸±à¸›à¹€à¸”à¸•à¸à¸²à¸£à¸¢à¸à¹€à¸§à¹‰à¸™ | Exemptions ([MAIN]) |
| `getBillSummary(houseId, period)` | à¸ªà¸£à¸¸à¸›à¸¢à¸­à¸”à¸£à¸§à¸¡à¸£à¸²à¸¢à¸šà¹‰à¸²à¸™ (à¸™à¹‰à¸³+à¹„à¸Ÿ+à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡) | {year} ([WATER]), {year} ([ELECTRIC]), CommonFee ([MAIN]) |
| `getBillSummaryAll(period)` | à¸ªà¸£à¸¸à¸›à¸¢à¸­à¸”à¸£à¸§à¸¡à¸—à¸¸à¸à¸šà¹‰à¸²à¸™ | {year} ([WATER]), {year} ([ELECTRIC]), CommonFee ([MAIN]) |
| `getDueDate()` | à¸”à¸¶à¸‡à¸§à¸±à¸™à¸„à¸£à¸šà¸à¸³à¸«à¸™à¸”à¸Šà¸³à¸£à¸° | Settings |
| `saveNotificationSnapshot(period, data)` | à¸šà¸±à¸™à¸—à¸¶à¸ snapshot à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸ˆà¹‰à¸‡à¸¢à¸­à¸”à¸Šà¸³à¸£à¸°à¸—à¸¸à¸à¸šà¹‰à¸²à¸™ | {year} ([NOTIFICATIONS]) |
| `getNotificationHistory(period)` | à¸”à¸¶à¸‡ snapshot à¹à¸ˆà¹‰à¸‡à¸¢à¸­à¸”à¸¢à¹‰à¸­à¸™à¸«à¸¥à¸±à¸‡à¸•à¸²à¸¡à¹€à¸”à¸·à¸­à¸™ | {year} ([NOTIFICATIONS]) |
| `createNotificationYearSheet(year)` | à¸ªà¸£à¹‰à¸²à¸‡à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¹ƒà¸«à¸¡à¹ˆà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸žà¸£à¹‰à¸­à¸¡ Header | [NOTIFICATIONS] |

**HTML à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:**
- `record-water.html` â†’ `getWaterBills`, `saveWaterBill`, `getPreviousWaterMeter`, `getWaterRate`
- `record-electric.html` â†’ `getElectricBills`, `saveElectricBill`
- `upload-slip.html` â†’ `getBillSummary`
- `payment-notification.html` â†’ `getBillSummaryAll`, `getDueDate`, `getCommonFee`, `saveNotificationSnapshot`
- `dashboard.html` â†’ `getBillSummary`
- `admin-settings.html` â†’ `getWaterRate`, `updateWaterRate`, `getCommonFee`, `updateCommonFee`, `getExemptions`, `updateExemptions`
- `check-slip.html` â†’ `getBillSummaryAll`

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸ HTML:**
> - `record-water.html` à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸¹à¸›à¹à¸šà¸š `{ month, year, rate, records[], savedAt }` â€” à¸„à¹ˆà¸²à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ rate = 18 (HTML) à¹à¸•à¹ˆ Settings à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ = 5
> - `record-electric.html` à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸¹à¸›à¹à¸šà¸š `{ month, year, pea_total, lost_house, lost_flat, records[], savedAt }` â€” à¹ƒà¸Šà¹‰ Math.ceil() à¸›à¸±à¸”à¹€à¸¨à¸©
> - `payment-notification.html` à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™à¹ƒà¸Šà¹‰ `getSampleData()` (hardcoded) â€” Backend à¸•à¹‰à¸­à¸‡ replace à¸”à¹‰à¸§à¸¢à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¸ˆà¸²à¸ `getBillSummaryAll()` â€” à¹€à¸¡à¸·à¹ˆà¸­à¸à¸”à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸¹à¸› à¸•à¹‰à¸­à¸‡à¹€à¸£à¸µà¸¢à¸ `saveNotificationSnapshot()` à¸”à¹‰à¸§à¸¢
> - âš ï¸ `commonFee` vs `commonFeeRate` â€” admin-settings à¹€à¸‚à¸µà¸¢à¸™ `commonFee`, upload-slip/accounting à¸­à¹ˆà¸²à¸™ `commonFeeRate` â€” Backend à¸•à¹‰à¸­à¸‡à¸„à¸·à¸™à¸„à¹ˆà¸² common fee à¸œà¹ˆà¸²à¸™ API
> - âš ï¸ Billing.gs à¹ƒà¸Šà¹‰ 3 à¹„à¸Ÿà¸¥à¹Œ spreadsheet à¹à¸¢à¸: [WATER], [ELECTRIC], [NOTIFICATIONS] â€” à¹à¸•à¹ˆà¸¥à¸°à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸Šà¹‰à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ â€” à¸•à¹‰à¸­à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¹ƒà¸«à¸¡à¹ˆà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¸žà¸š

---

### 7. `Payment.gs` â€” ðŸ’³ à¸Šà¸³à¸£à¸°à¹€à¸‡à¸´à¸™à¹à¸¥à¸°à¸•à¸£à¸§à¸ˆà¸ªà¸¥à¸´à¸›

**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¸ˆà¸±à¸”à¸à¸²à¸£à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¸ªà¸¥à¸´à¸›, à¸•à¸£à¸§à¸ˆà¸ªà¸¥à¸´à¸›, à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´/à¸›à¸à¸´à¹€à¸ªà¸˜, à¸šà¸±à¸™à¸—à¸¶à¸à¸¡à¸·à¸­, à¸›à¸£à¸°à¸§à¸±à¸•à¸´

**à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™:**
| à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ | Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ |
|----------|----------|------------|
| `handleSubmitSlip(data)` | à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¸ªà¸¥à¸´à¸›à¹ƒà¸«à¸¡à¹ˆ + à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸¹à¸›à¹„à¸› Drive (à¹€à¸›à¸´à¸”à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´) | SlipSubmissions_{year}, Slips folder |
| `getSlipSubmissions(period)` | à¸”à¸¶à¸‡à¸ªà¸¥à¸´à¸›à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸•à¸²à¸¡à¹€à¸”à¸·à¸­à¸™ (à¸ˆà¸²à¸à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡) | SlipSubmissions_{year} |
| `getSlipDetail(slipId)` | à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸ªà¸¥à¸´à¸› + URL à¸£à¸¹à¸› | SlipSubmissions_{year} |
| `handleReviewSlip(slipId, status, note)` | à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´/à¸›à¸à¸´à¹€à¸ªà¸˜à¸ªà¸¥à¸´à¸› (à¸ªà¸£à¹‰à¸²à¸‡ PaymentHistory à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´) | SlipSubmissions_{year}, PaymentHistory_{year} |
| `recordManualPayment(houseId, period, amount, note)` | à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸±à¸šà¹€à¸‡à¸´à¸™à¸ªà¸”à¸¡à¸·à¸­ | PaymentHistory_{year} |
| `getPaymentHistory(userId, month, year)` | à¸”à¸¶à¸‡à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸Šà¸³à¸£à¸° (à¸ˆà¸²à¸à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡) | PaymentHistory_{year} |
| `getOutstanding(period)` | à¸”à¸¶à¸‡à¸¢à¸­à¸”à¸„à¹‰à¸²à¸‡à¸Šà¸³à¸£à¸° | Outstanding |
| `updateOutstanding(period)` | à¸­à¸±à¸›à¹€à¸”à¸•à¸ªà¸–à¸²à¸™à¸°à¸„à¹‰à¸²à¸‡à¸Šà¸³à¸£à¸° | Outstanding |
| `saveSlipImage(images, houseId, period)` | à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸¹à¸›à¸ªà¸¥à¸´à¸›à¸¥à¸‡ Drive folder | Slips folder |
| `getSlipImageUrl(slipId)` | à¸”à¸¶à¸‡ URL à¸£à¸¹à¸›à¸ªà¸¥à¸´à¸› | Slips folder |
| `createSlipYearSheet(year)` | à¸ªà¸£à¹‰à¸²à¸‡à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™ SlipSubmissions_{year} à¹ƒà¸«à¸¡à¹ˆà¸žà¸£à¹‰à¸­à¸¡ Header à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ | [PAYMENTS] |
| `createPaymentHistoryYearSheet(year)` | à¸ªà¸£à¹‰à¸²à¸‡à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™ PaymentHistory_{year} à¹ƒà¸«à¸¡à¹ˆà¸žà¸£à¹‰à¸­à¸¡ Header à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ | [PAYMENTS] |

**HTML à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:**
- `upload-slip.html` â†’ `handleSubmitSlip`, `getSlipSubmissions` (à¸•à¸£à¸§à¸ˆà¸§à¹ˆà¸²à¸ªà¹ˆà¸‡à¹à¸¥à¹‰à¸§)
- `check-slip.html` â†’ `getSlipSubmissions`, `handleReviewSlip`, `recordManualPayment`, `getSlipDetail`
- `payment-history.html` â†’ `getPaymentHistory`
- `dashboard.html` â†’ `getOutstanding`

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸ HTML:**
> - `upload-slip.html` à¹€à¸à¹‡à¸šà¸ªà¸¥à¸´à¸›à¹€à¸›à¹‡à¸™ base64 à¹ƒà¸™ localStorage â€” Backend à¸•à¹‰à¸­à¸‡à¹à¸›à¸¥à¸‡ base64 â†’ à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸™ Drive â†’ à¹€à¸à¹‡à¸š file ID
> - `check-slip.html` à¸¡à¸µà¸ªà¸–à¸²à¸™à¸°à¹€à¸žà¸´à¹ˆà¸¡: `match`, `mismatch`, `no-resident`, `unpaid` â€” à¸™à¸­à¸à¸ˆà¸²à¸ pending/approved/rejected
> - `check-slip.html` à¸¡à¸µ `paymentMethod` + `isManual` à¹ƒà¸™ approval object
> - `payment-history.html` à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™à¹à¸ªà¸”à¸‡ **à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ hardcoded** à¹ƒà¸™ HTML à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™ â€” à¹„à¸¡à¹ˆà¸­à¹ˆà¸²à¸™à¸ˆà¸²à¸ localStorage

---

### 8. `Request.gs` â€” ðŸ“‹ à¸„à¸³à¸£à¹‰à¸­à¸‡à¹à¸¥à¸°à¸£à¸°à¸šà¸šà¸„à¸´à¸§

**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¸ˆà¸±à¸”à¸à¸²à¸£à¸„à¸³à¸£à¹‰à¸­à¸‡ 4 à¸›à¸£à¸°à¹€à¸ à¸— (à¹€à¸‚à¹‰à¸²à¸žà¸±à¸/à¸¢à¹‰à¸²à¸¢/à¸„à¸·à¸™/à¸‹à¹ˆà¸­à¸¡) + à¸£à¸°à¸šà¸šà¸„à¸´à¸§à¸£à¸­à¹€à¸‚à¹‰à¸²à¸žà¸±à¸

**à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™:**
| à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ | Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ |
|----------|----------|------------|
| `handleSubmitRequest(type, data, attachments)` | à¸ªà¹ˆà¸‡à¸„à¸³à¸£à¹‰à¸­à¸‡à¹ƒà¸«à¸¡à¹ˆ + à¸šà¸±à¸™à¸—à¸¶à¸à¹„à¸Ÿà¸¥à¹Œà¹à¸™à¸š (à¸›à¸µà¸”à¸¶à¸‡à¸ˆà¸²à¸ submitted_at) | `{Type}_{year}` à¹ƒà¸™ [REQUESTS], Request folders |
| `getRequests(type, year, filters)` | à¸”à¸¶à¸‡à¸„à¸³à¸£à¹‰à¸­à¸‡à¸•à¸²à¸¡à¸›à¸£à¸°à¹€à¸ à¸—/à¸›à¸µ/à¸ªà¸–à¸²à¸™à¸° | `{Type}_{year}` à¹ƒà¸™ [REQUESTS] |
| `getRequestDetail(type, year, id)` | à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸„à¸³à¸£à¹‰à¸­à¸‡ + à¹„à¸Ÿà¸¥à¹Œà¹à¸™à¸š | `{Type}_{year}` à¹ƒà¸™ [REQUESTS] |
| `handleReviewRequest(type, year, id, status, note)` | à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´/à¸›à¸à¸´à¹€à¸ªà¸˜à¸„à¸³à¸£à¹‰à¸­à¸‡ | `{Type}_{year}` à¹ƒà¸™ [REQUESTS] |
| `createRequestYearSheet(type, year)` | à¸ªà¸£à¹‰à¸²à¸‡à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¹ƒà¸«à¸¡à¹ˆà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸žà¸£à¹‰à¸­à¸¡ Header (à¸•à¸²à¸¡à¸›à¸£à¸°à¹€à¸ à¸—à¸„à¸³à¸£à¹‰à¸­à¸‡) | [REQUESTS] |
| `getQueue()` | à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸„à¸´à¸§à¸£à¸­à¹€à¸‚à¹‰à¸²à¸žà¸±à¸ | Queue |
| `addToQueue(requestId, data)` | à¹€à¸žà¸´à¹ˆà¸¡à¹€à¸‚à¹‰à¸²à¸„à¸´à¸§ | Queue |
| `removeFromQueue(queueId)` | à¸¥à¸šà¸­à¸­à¸à¸ˆà¸²à¸à¸„à¸´à¸§ | Queue |
| `updateQueueOrder(orderedIds)` | à¹€à¸£à¸µà¸¢à¸‡à¸¥à¸³à¸”à¸±à¸šà¸„à¸´à¸§à¹ƒà¸«à¸¡à¹ˆ (Drag & Drop) | Queue |
| `approveFromQueue(queueId, houseId)` | à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸ˆà¸²à¸à¸„à¸´à¸§ â†’ à¸¢à¹‰à¸²à¸¢à¹€à¸‚à¹‰à¸²à¸šà¹‰à¸²à¸™ | Queue, Housing, Residents |
| `setQueueExpiryDate(queueId, date)` | à¸•à¸±à¹‰à¸‡à¸§à¸±à¸™à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸à¸„à¸´à¸§ | Queue |
| `checkAndExpireQueue()` | à¸•à¸£à¸§à¸ˆ+à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸à¸„à¸´à¸§à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ | Queue |
| `saveRequestAttachments(files, type, requestId)` | à¸šà¸±à¸™à¸—à¸¶à¸à¹„à¸Ÿà¸¥à¹Œà¹à¸™à¸šà¸¥à¸‡ Drive | Request folders |

**HTML à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:**
- `request-form.html` â†’ `handleSubmitRequest('residence', ...)` â€” âš ï¸ à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ printForm() à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- `transfer-form.html` â†’ `handleSubmitRequest('transfer', ...)` â€” âš ï¸ à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ printForm() à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- `return-form.html` â†’ `handleSubmitRequest('return', ...)` â€” âš ï¸ à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ printForm() à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- `repair-form.html` â†’ `handleSubmitRequest('repair', ...)` â€” âš ï¸ à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ printForm() à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™
- `check-request.html` â†’ `getRequests(type, year)`, `getRequestDetail`, `handleReviewRequest`, `getQueue`, `updateQueueOrder`, `addToQueue`, `removeFromQueue`, `approveFromQueue`

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸ HTML:**
> - `stay_type` à¹ƒà¸Šà¹‰ `alone`/`family` (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ `house`/`flat`)
> - `transfer_type` à¹ƒà¸Šà¹‰ `flat_to_house`/`house_to_flat`/`change_unit` (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ `swap`/`move`)
> - `urgency` à¹ƒà¸Šà¹‰ `normal`/`urgent`/`urgent_high` (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ `critical`)
> - `cost_responsibility` à¹ƒà¸Šà¹‰ `self`/`school` (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ `resident`)
> - check-request.html à¸¡à¸µà¸ªà¸–à¸²à¸™à¸°: `pending`, `reviewing`, `waiting`, `approved`, `rejected`, `completed`, `expired`
> - check-request.html à¹€à¸à¹‡à¸š queue à¹€à¸›à¹‡à¸™ property à¸à¸±à¸‡à¹ƒà¸™ request (queuePosition, expiryDate)
> - **à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ:** à¸„à¸³à¸£à¹‰à¸­à¸‡à¸—à¸±à¹‰à¸‡ 4 à¸›à¸£à¸°à¹€à¸ à¸—à¹ƒà¸Šà¹‰à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™ `{Type}_{year}` (à¹€à¸Šà¹ˆà¸™ `Residence_2569`) â€” à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¸žà¸š â€” à¸—à¸¸à¸à¹à¸–à¸§à¸¡à¸µ `submitted_at` (à¸§à¸±à¸™à¹€à¸”à¸·à¸­à¸™à¸›à¸µ) à¸à¸³à¸à¸±à¸šà¸—à¸µà¹ˆà¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œ B
> - **Queue à¹„à¸¡à¹ˆà¹à¸¢à¸à¸›à¸µ:** Queue à¹€à¸›à¹‡à¸™à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¢à¸•à¸±à¸§ â€” sync `queue_position` + `expiry_date` à¸à¸¥à¸±à¸šà¹„à¸›à¸—à¸µà¹ˆ `Residence_{year}` à¸”à¹‰à¸§à¸¢

---

### 9. `Finance.gs` â€” ðŸ“‘ à¸à¸²à¸£à¹€à¸‡à¸´à¸™à¹à¸¥à¸°à¸šà¸±à¸à¸Šà¸µ

**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¸ªà¸£à¸¸à¸›à¹€à¸šà¸´à¸-à¸ˆà¹ˆà¸²à¸¢à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™, à¸šà¸±à¸à¸Šà¸µà¸£à¸²à¸¢à¸£à¸±à¸š-à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢à¸à¸­à¸‡à¸—à¸¸à¸™ (à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¹à¸¢à¸à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨.)

**à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™:**
| à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ | Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ |
|----------|----------|------------|
| `getMonthlyWithdraw(period)` | à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸šà¸´à¸à¸ˆà¹ˆà¸²à¸¢à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™ | {year} ([WITHDRAW]) |
| `handleSaveWithdraw(period, data)` | à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸šà¸´à¸à¸ˆà¹ˆà¸²à¸¢ | {year} ([WITHDRAW]) |
| `createWithdrawYearSheet(year)` | à¸ªà¸£à¹‰à¸²à¸‡à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¹ƒà¸«à¸¡à¹ˆà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸žà¸£à¹‰à¸­à¸¡ Header | [WITHDRAW] |
| `getWaterBillTotal(period)` | à¸”à¸¶à¸‡à¸¢à¸­à¸”à¸£à¸§à¸¡à¸„à¹ˆà¸²à¸™à¹‰à¸³ | {year} ([WATER]) |
| `getElectricBillPEA(period)` | à¸”à¸¶à¸‡à¸¢à¸­à¸” à¸à¸Ÿà¸ . | {year} ([ELECTRIC]) |
| `loadAccountingData(period)` | à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸šà¸±à¸à¸Šà¸µà¸•à¸²à¸¡à¹€à¸”à¸·à¸­à¸™ (à¸à¸£à¸­à¸‡ type=income/expense) | {year} ([ACCOUNTING]) |
| `saveAccountingData(period, data)` | à¸šà¸±à¸™à¸—à¸¶à¸à¸šà¸±à¸à¸Šà¸µà¸—à¸±à¹‰à¸‡à¹€à¸”à¸·à¸­à¸™ (à¸—à¸±à¹‰à¸‡ auto + manual) | {year} ([ACCOUNTING]) |
| `calculateAutoEntries(period)` | à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸ˆà¸²à¸à¸«à¸™à¹‰à¸²à¸­à¸·à¹ˆà¸™ (à¸”à¸¹à¸•à¸²à¸£à¸²à¸‡à¸”à¹‰à¸²à¸™à¸¥à¹ˆà¸²à¸‡) | à¸«à¸¥à¸²à¸¢ sheet |
| `getCarryForward(period)` | à¸”à¸¶à¸‡à¸¢à¸­à¸”à¸¢à¸à¸¡à¸²à¸ˆà¸²à¸à¹€à¸”à¸·à¸­à¸™à¸à¹ˆà¸­à¸™ | {year} ([ACCOUNTING]) |
| `createYearSheet(year)` | à¸ªà¸£à¹‰à¸²à¸‡à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸›à¸µà¹ƒà¸«à¸¡à¹ˆà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸žà¸£à¹‰à¸­à¸¡ Header | [ACCOUNTING] |
| `uploadReceiptImage(base64, desc, date)` | à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¸£à¸¹à¸›à¸«à¸¥à¸±à¸à¸à¸²à¸™ à¸•à¸±à¹‰à¸‡à¸Šà¸·à¹ˆà¸­ `{à¸£à¸²à¸¢à¸à¸²à¸£}_{YYYY-MM-DD}` | AccountingReceipts folder |
| `deleteAccountingEntry(period, id)` | à¸¥à¸šà¸£à¸²à¸¢à¸à¸²à¸£à¸šà¸±à¸à¸Šà¸µ | {year} ([ACCOUNTING]) |

**à¸à¸²à¸£à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ (`calculateAutoEntries`):**
| à¸›à¸£à¸°à¹€à¸ à¸— | à¸£à¸²à¸¢à¸à¸²à¸£ | à¸”à¸¶à¸‡à¸ˆà¸²à¸ | à¸§à¸´à¸˜à¸µà¸”à¸¶à¸‡ |
|---------|---------|---------|--------|
| à¸£à¸²à¸¢à¸£à¸±à¸š | à¸„à¹ˆà¸²à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡ | à¸«à¸™à¹‰à¸²à¹à¸ˆà¹‰à¸‡à¸¢à¸­à¸”à¸Šà¸³à¸£à¸° (`payment-notification`) | à¸”à¸¶à¸‡à¸¢à¸­à¸”à¸£à¸§à¸¡à¸„à¹ˆà¸²à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡à¸—à¸µà¹ˆà¸šà¸±à¸™à¸—à¸¶à¸à¹„à¸§à¹‰à¹à¸¥à¹‰à¸§ |
| à¸£à¸²à¸¢à¸£à¸±à¸š | à¸„à¹ˆà¸²à¹„à¸Ÿà¸›à¸±à¸”à¹€à¸¨à¸© | à¸«à¸™à¹‰à¸²à¸šà¸±à¸™à¸—à¸¶à¸à¸„à¹ˆà¸²à¹„à¸Ÿ (`record-electric`) | à¸œà¸¥à¸£à¸§à¸¡(à¸›à¸±à¸”à¹€à¸¨à¸©à¸—à¸¸à¸à¸šà¹‰à¸²à¸™) - à¸œà¸¥à¸£à¸§à¸¡(à¸„à¹ˆà¸²à¹„à¸Ÿà¸ˆà¸£à¸´à¸‡à¸—à¸¸à¸à¸šà¹‰à¸²à¸™) |
| à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢ | à¸„à¹ˆà¸²à¸‚à¸¢à¸° | à¸«à¸™à¹‰à¸²à¸¢à¸­à¸”à¹€à¸šà¸´à¸à¸›à¸£à¸°à¸ˆà¸³à¹€à¸”à¸·à¸­à¸™ (`monthly-withdraw`) | à¸”à¸¶à¸‡ `garbageFee` |
| à¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢ | à¸„à¹ˆà¸²à¸­à¸·à¹ˆà¸™à¹† à¸ˆà¸²à¸à¸¢à¸­à¸”à¹€à¸šà¸´à¸ | à¸«à¸™à¹‰à¸²à¸¢à¸­à¸”à¹€à¸šà¸´à¸à¸›à¸£à¸°à¸ˆà¸³à¹€à¸”à¸·à¸­à¸™ (`monthly-withdraw`) | à¸”à¸¶à¸‡ `additionalItems[]` |

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸à¸ªà¸³à¸„à¸±à¸:**
> - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸¸à¸à¸£à¸²à¸¢à¸à¸²à¸£ (à¸—à¸±à¹‰à¸‡ auto + manual) à¸ˆà¸°à¸–à¸¹à¸ **à¸šà¸±à¸™à¸—à¸¶à¸à¸¥à¸‡à¹ƒà¸™à¸Šà¸µà¸— [ACCOUNTING] à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™** â€” à¹€à¸›à¹‡à¸™ snapshot à¸ªà¸¡à¸šà¸¹à¸£à¸“à¹Œà¸‚à¸­à¸‡à¹€à¸”à¸·à¸­à¸™à¸™à¸±à¹‰à¸™
> - MonthlyWithdraw à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ [WITHDRAW] à¹à¸¢à¸à¹„à¸Ÿà¸¥à¹Œà¸•à¹ˆà¸²à¸‡à¸«à¸²à¸ + à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¹à¸¢à¸à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. â€” Finance.gs à¸¢à¸±à¸‡à¸ˆà¸±à¸”à¸à¸²à¸£à¸­à¸¢à¸¹à¹ˆ
> - à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¹ƒà¸™ [ACCOUNTING] à¹à¸¢à¸à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. (à¹€à¸Šà¹ˆà¸™ `2569`) â€” à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹€à¸¡à¸·à¹ˆà¸­à¸‚à¸¶à¹‰à¸™à¸›à¸µà¹ƒà¸«à¸¡à¹ˆ
> - à¸£à¸¹à¸›à¸«à¸¥à¸±à¸à¸à¸²à¸™à¸šà¸±à¸™à¸—à¸¶à¸à¸¥à¸‡ `AccountingReceipts/` à¸•à¸±à¹‰à¸‡à¸Šà¸·à¹ˆà¸­ `{à¸£à¸²à¸¢à¸à¸²à¸£}_{YYYY-MM-DD}.jpg`

**HTML à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:**
- `monthly-withdraw.html` â†’ `getMonthlyWithdraw`, `handleSaveWithdraw`, `getWaterBillTotal`, `getElectricBillPEA`
- `accounting.html` â†’ `loadAccountingData`, `saveAccountingData`, `calculateAutoEntries`, `getCarryForward`, `uploadReceiptImage`, `deleteAccountingEntry`, `createYearSheet`

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸ HTML:**
> - `monthly-withdraw.html` à¸šà¸±à¸™à¸—à¸¶à¸ `{ month, year, garbageFee, additionalItems[], savedAt }` â€” à¸„à¹ˆà¸²à¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™ garbageFee = 310
> - `accounting.html` à¸šà¸±à¸™à¸—à¸¶à¸ `{ carryForward, incomeItems[], expenseItems[], savedAt }` â€” à¸£à¸²à¸¢à¸à¸²à¸£ auto = à¸”à¸¶à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸ˆà¸²à¸à¸«à¸™à¹‰à¸²à¸­à¸·à¹ˆà¸™
> - `accounting.html` à¸­à¹ˆà¸²à¸™ `commonFeeRate` (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ `commonFee`) â€” Backend à¸•à¹‰à¸­à¸‡ return à¸„à¹ˆà¸²à¸œà¹ˆà¸²à¸™ API

---

### 10. `Notification.gs` â€” ðŸ“§ à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸—à¸²à¸‡ Email

**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ:** à¸ªà¹ˆà¸‡ Email à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™, à¹ƒà¸šà¹€à¸ªà¸£à¹‡à¸ˆ, à¹€à¸•à¸·à¸­à¸™à¸Šà¸³à¸£à¸° à¸œà¹ˆà¸²à¸™ GmailApp

**à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™:**
| à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢ | Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰ |
|----------|----------|------------|
| `sendPaymentNotification(houseId, period)` | à¸ªà¹ˆà¸‡à¹à¸ˆà¹‰à¸‡à¸¢à¸­à¸”à¸Šà¸³à¸£à¸°à¸£à¸²à¸¢à¸šà¹‰à¸²à¸™ | Users, WaterBills, ElectricBills |
| `sendBulkNotifications(period)` | à¸ªà¹ˆà¸‡à¹à¸ˆà¹‰à¸‡à¸¢à¸­à¸”à¸—à¸¸à¸à¸šà¹‰à¸²à¸™ | Users, WaterBills, ElectricBills |
| `sendPaymentReminder(houseId, period)` | à¸ªà¹ˆà¸‡à¹€à¸•à¸·à¸­à¸™à¸„à¹‰à¸²à¸‡à¸Šà¸³à¸£à¸° | Users, Outstanding |
| `sendBulkReminders(period)` | à¸ªà¹ˆà¸‡à¹€à¸•à¸·à¸­à¸™à¸„à¹‰à¸²à¸‡à¸Šà¸³à¸£à¸°à¸—à¸¸à¸à¸šà¹‰à¸²à¸™ | Users, Outstanding |
| `sendReceipt(houseId, period, data)` | à¸ªà¹ˆà¸‡à¹ƒà¸šà¹€à¸ªà¸£à¹‡à¸ˆà¸«à¸¥à¸±à¸‡à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ | Users, PaymentHistory |
| `sendBulkReceipts(period)` | à¸ªà¹ˆà¸‡à¹ƒà¸šà¹€à¸ªà¸£à¹‡à¸ˆà¸«à¸¥à¸²à¸¢à¸šà¹‰à¸²à¸™ | Users, PaymentHistory |
| `sendPasswordResetEmail(email, resetLink)` | à¸ªà¹ˆà¸‡ email à¸£à¸µà¹€à¸‹à¹‡à¸•à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™ | - |
| `sendRequestStatusEmail(requestId, status)` | à¹à¸ˆà¹‰à¸‡à¸œà¸¥à¸„à¸³à¸£à¹‰à¸­à¸‡ | Users |
| `handleSendNotification(data)` | Router à¸ªà¸³à¸«à¸£à¸±à¸š notification types | - |
| `buildEmailTemplate(type, data)` | à¸ªà¸£à¹‰à¸²à¸‡ HTML template à¸ªà¸³à¸«à¸£à¸±à¸š Email | - |

**HTML à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:**
- `check-slip.html` â†’ `sendReceipt`, `sendBulkReceipts`, `sendPaymentReminder`, `sendBulkReminders`
- `payment-notification.html` â†’ `sendBulkNotifications`
- `forgot-password.html` â†’ `sendPasswordResetEmail`
- `check-request.html` â†’ `sendRequestStatusEmail`

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸ HTML:** `payment-notification.html` à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™à¹ƒà¸Šà¹‰ `getSampleData()` (à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ hardcoded 5 à¸šà¹‰à¸²à¸™ 8 à¹à¸Ÿà¸¥à¸•) â€” à¹„à¸¡à¹ˆà¸­à¹ˆà¸²à¸™ billing data à¸ˆà¸£à¸´à¸‡ â€” Backend à¸•à¹‰à¸­à¸‡à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¸ˆà¸²à¸ BillSummary

---

## ðŸ”— à¹à¸œà¸™à¸œà¸±à¸‡à¸„à¸§à¸²à¸¡à¸ªà¸±à¸¡à¸žà¸±à¸™à¸˜à¹Œà¹„à¸Ÿà¸¥à¹Œ .gs

```
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚   Main.gs    â”‚    â† à¸ˆà¸¸à¸”à¹€à¸‚à¹‰à¸² Web App (doGet/doPost)
                  â”‚   (Router)   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ route à¸•à¸²à¸¡ action
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚              â”‚              â”‚            â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚  Auth.gs  â”‚  â”‚Housing.gs â”‚  â”‚Billing. â”‚  â”‚Payment.â”‚
    â”‚  ðŸ”       â”‚  â”‚  ðŸ        â”‚  â”‚gs ðŸ’§âš¡  â”‚  â”‚gs ðŸ’³   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚              â”‚              â”‚            â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚Request.gs â”‚  â”‚Finance.gs â”‚  â”‚Notific. â”‚
    â”‚  ðŸ“‹       â”‚  â”‚  ðŸ“‘       â”‚  â”‚gs ðŸ“§    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚              â”‚              â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ à¸—à¸¸à¸à¹„à¸Ÿà¸¥à¹Œà¹€à¸£à¸µà¸¢à¸à¹ƒà¸Šà¹‰
                  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚ Database.gs  â”‚    â† CRUD à¸à¸¥à¸²à¸‡
                  â”‚  ðŸ—„ï¸          â”‚
                  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ à¸­à¹ˆà¸²à¸™à¸„à¹ˆà¸²à¸ˆà¸²à¸
                  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  Config.gs   â”‚    â† à¸„à¹ˆà¸²à¸„à¸‡à¸—à¸µà¹ˆ + IDs
                  â”‚  âš™ï¸          â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“Š à¸ªà¸£à¸¸à¸›à¸ˆà¸³à¸™à¸§à¸™à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¸•à¹ˆà¸­à¹„à¸Ÿà¸¥à¹Œ

| à¹„à¸Ÿà¸¥à¹Œ | à¸ˆà¸³à¸™à¸§à¸™à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ | à¸„à¸§à¸²à¸¡à¸‹à¸±à¸šà¸‹à¹‰à¸­à¸™ |
|------|--------------|------------|
| Config.gs | 0 (à¸„à¹ˆà¸²à¸„à¸‡à¸—à¸µà¹ˆ) | â­ à¸‡à¹ˆà¸²à¸¢ |
| Database.gs | 12 | â­â­ à¸›à¸²à¸™à¸à¸¥à¸²à¸‡ |
| Main.gs | 5 + routing (33 routes) | â­â­ à¸›à¸²à¸™à¸à¸¥à¸²à¸‡ |
| Auth.gs | 17 | â­â­â­ à¸‹à¸±à¸šà¸‹à¹‰à¸­à¸™ |
| Housing.gs | 25 | â­â­â­ à¸‹à¸±à¸šà¸‹à¹‰à¸­à¸™ |
| Billing.gs | 21 | â­â­â­ à¸‹à¸±à¸šà¸‹à¹‰à¸­à¸™ |
| Payment.gs | 10 | â­â­â­ à¸‹à¸±à¸šà¸‹à¹‰à¸­à¸™ |
| Request.gs | 16 | â­â­â­ à¸‹à¸±à¸šà¸‹à¹‰à¸­à¸™ |
| Finance.gs | 12 | â­â­â­ à¸‹à¸±à¸šà¸‹à¹‰à¸­à¸™ |
| Notification.gs | 10 | â­â­ à¸›à¸²à¸™à¸à¸¥à¸²à¸‡ |
| **à¸£à¸§à¸¡** | **~132 à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™** | |

---

## ðŸ“‹ à¹à¸œà¸™à¸œà¸±à¸‡ HTML â†’ à¹„à¸Ÿà¸¥à¹Œ .gs à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰

| HTML | Auth | Housing | Billing | Payment | Request | Finance | Notification |
|------|:----:|:-------:|:-------:|:-------:|:-------:|:-------:|:------------:|
| login.html | âœ… | | | | | | |
| register.html | âœ… | | | | | | |
| forgot-password.html | âœ… | | | | | | âœ… |
| forgot-email.html | âœ… | | | | | | |
| dashboard.html | âœ… | âœ… | âœ… | âœ… | | | |
| settings.html | âœ… | âœ… | | | | | |
| payment-history.html | âœ… | | | âœ… | | | |
| regulations.html | âœ… | âœ… | | | | | |
| form.html | | | | | | | |
| request-form.html | âœ… | âœ… | | | âœ… | | |
| transfer-form.html | âœ… | âœ… | | | âœ… | | |
| return-form.html | âœ… | âœ… | | | âœ… | | |
| repair-form.html | âœ… | âœ… | | | âœ… | | |
| upload-slip.html | âœ… | | âœ… | âœ… | | | |
| team-management.html | âœ… | âœ… | | | | | |
| record-water.html | âœ… | âœ… | âœ… | | | | |
| record-electric.html | âœ… | âœ… | âœ… | | | | |
| payment-notification.html | âœ… | âœ… | âœ… | | | | âœ… |
| check-slip.html | âœ… | âœ… | âœ… | âœ… | | | âœ… |
| check-request.html | âœ… | âœ… | | | âœ… | | âœ… |
| monthly-withdraw.html | âœ… | | âœ… | | | âœ… | |
| accounting.html | âœ… | âœ… | âœ… | | | âœ… | |
| admin-settings.html | âœ… | âœ… | âœ… | | | | |

> **à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸:** à¸—à¸¸à¸à¸«à¸™à¹‰à¸² (à¸¢à¸à¹€à¸§à¹‰à¸™ form.html) à¹ƒà¸Šà¹‰ `Auth.gs` à¹€à¸žà¸·à¹ˆà¸­à¸•à¸£à¸§à¸ˆ session  
> `Main.gs`, `Database.gs`, `Config.gs` à¹ƒà¸Šà¹‰à¹‚à¸”à¸¢à¸—à¸¸à¸ request à¹‚à¸”à¸¢à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´

---

## ðŸš€ à¸¥à¸³à¸”à¸±à¸šà¸à¸²à¸£à¸žà¸±à¸’à¸™à¸²à¸—à¸µà¹ˆà¹à¸™à¸°à¸™à¸³

| à¸¥à¸³à¸”à¸±à¸š | à¹„à¸Ÿà¸¥à¹Œ | à¹€à¸«à¸•à¸¸à¸œà¸¥ |
|-------|------|--------|
| 1 | `Config.gs` | âš™ï¸ à¸à¸²à¸™à¸‚à¸­à¸‡à¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡ â€” à¸•à¹‰à¸­à¸‡à¸¡à¸µ ID à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ/à¸Šà¸µà¸—à¸à¹ˆà¸­à¸™ |
| 2 | `Database.gs` | ðŸ—„ï¸ CRUD à¸à¸¥à¸²à¸‡ â€” à¹„à¸Ÿà¸¥à¹Œà¸­à¸·à¹ˆà¸™à¹€à¸£à¸µà¸¢à¸à¹ƒà¸Šà¹‰ |
| 3 | `Main.gs` | ðŸŒ Router â€” à¸ˆà¸¸à¸”à¹€à¸‚à¹‰à¸² Web App |
| 4 | `Auth.gs` | ðŸ” Login/Register â€” à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰à¸à¹ˆà¸­à¸™à¸—à¸¸à¸à¸«à¸™à¹‰à¸² |
| 5 | `Housing.gs` | ðŸ  à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸žà¸·à¹‰à¸™à¸à¸²à¸™ â€” à¸šà¹‰à¸²à¸™/à¸œà¸¹à¹‰à¸žà¸±à¸/à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² |
| 6 | `Billing.gs` | ðŸ’§âš¡ à¸šà¸±à¸™à¸—à¸¶à¸à¸„à¹ˆà¸²à¸™à¹‰à¸³/à¹„à¸Ÿ â€” à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸«à¸¥à¸±à¸à¸‚à¸­à¸‡à¸£à¸°à¸šà¸š |
| 7 | `Payment.gs` | ðŸ’³ à¸ªà¸¥à¸´à¸›/à¸Šà¸³à¸£à¸°à¹€à¸‡à¸´à¸™ â€” à¸•à¹ˆà¸­à¸¢à¸­à¸”à¸ˆà¸²à¸ Billing |
| 8 | `Request.gs` | ðŸ“‹ à¸„à¸³à¸£à¹‰à¸­à¸‡/à¸„à¸´à¸§ â€” à¸—à¸³à¸‡à¸²à¸™à¸­à¸´à¸ªà¸£à¸° |
| 9 | `Finance.gs` | ðŸ“‘ à¸šà¸±à¸à¸Šà¸µ â€” à¸•à¹‰à¸­à¸‡à¸¡à¸µ Billing à¸à¹ˆà¸­à¸™ |
| 10 | `Notification.gs` | ðŸ“§ à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™ â€” à¸—à¸³à¹€à¸›à¹‡à¸™à¸¥à¸³à¸”à¸±à¸šà¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢ |

---

## ðŸ§ª Test Checkpoints â€” à¸—à¸”à¸ªà¸­à¸šà¸«à¸¥à¸±à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹à¸•à¹ˆà¸¥à¸° .gs (S0-4)

> **ðŸš¨ à¸à¸Žà¹€à¸«à¸¥à¹‡à¸:** à¸«à¹‰à¸²à¸¡à¸ªà¸£à¹‰à¸²à¸‡ .gs à¸•à¸±à¸§à¸–à¸±à¸”à¹„à¸›à¸ˆà¸™à¸à¸§à¹ˆà¸²à¸•à¸±à¸§à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™à¸ˆà¸°à¸œà¹ˆà¸²à¸™ test à¸—à¸¸à¸à¸‚à¹‰à¸­  
> **à¸§à¸´à¸˜à¸µà¸—à¸³:** à¸«à¸¥à¸±à¸‡à¸ªà¸£à¹‰à¸²à¸‡ .gs à¹à¸•à¹ˆà¸¥à¸°à¸•à¸±à¸§ â†’ à¸£à¸±à¸™ test function à¹ƒà¸™ GAS Editor â†’ à¸”à¸¹ Execution Log â†’ à¸•à¹‰à¸­à¸‡à¹„à¸¡à¹ˆà¸¡à¸µ error  
> **à¹€à¸«à¸•à¸¸à¸œà¸¥:** Bug à¹ƒà¸™ Config/Database à¸ˆà¸° cascade à¹„à¸›à¸—à¸¸à¸à¹„à¸Ÿà¸¥à¹Œ â€” à¸ˆà¸±à¸š bug à¸•à¸±à¹‰à¸‡à¹à¸•à¹ˆà¸•à¹‰à¸™à¸›à¸£à¸°à¸«à¸¢à¸±à¸”à¹€à¸§à¸¥à¸² 10 à¹€à¸—à¹ˆà¸²

### Test Matrix â€” à¸ªà¸£à¸¸à¸›à¸£à¸§à¸¡

| # | .gs à¸—à¸µà¹ˆà¸ªà¸£à¹‰à¸²à¸‡ | Test à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸œà¹ˆà¸²à¸™ | à¸§à¸´à¸˜à¸µà¸—à¸”à¸ªà¸­à¸š |
|---|-------------|----------------|----------|
| 1 | Config.gs | IDs à¹„à¸¡à¹ˆà¹€à¸›à¹‡à¸™ null/à¸§à¹ˆà¸²à¸‡, DEFAULTS à¸„à¸£à¸šà¸—à¸¸à¸ key | `testConfig()` â€” à¸”à¸¹ Log |
| 2 | Database.gs | CRUD à¸—à¸³à¸‡à¸²à¸™à¸à¸±à¸š Settings sheet à¹„à¸”à¹‰ | `testDB()` â€” à¸”à¸¹ Log + à¸•à¸£à¸§à¸ˆ Sheet |
| 3 | Main.gs | GET/POST route à¹„à¸¡à¹ˆ return error | Deploy Web App â†’ `fetch(URL + '?action=getSettings')` à¸”à¸¹à¸§à¹ˆà¸² return JSON à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡ |
| 4 | Auth.gs | registerâ†’pending, loginâ†’token, validateâ†’user | `testAuth()` â€” à¸”à¸¹ Log + à¸•à¸£à¸§à¸ˆ PendingReg sheet |
| 5 | Housing.gs | CRUD à¸šà¹‰à¸²à¸™/à¸œà¸¹à¹‰à¸žà¸±à¸/settings à¹„à¸¡à¹ˆ error | `testHousing()` â€” à¸”à¸¹ Log + à¸•à¸£à¸§à¸ˆ Housing/Residents sheet |
| 6 | Billing.gs | à¸šà¸±à¸™à¸—à¸¶à¸/à¸”à¸¶à¸‡à¸„à¹ˆà¸²à¸™à¹‰à¸³-à¸„à¹ˆà¸²à¹„à¸Ÿ à¹„à¸¡à¹ˆ error | `testBilling()` â€” à¸”à¸¹ Log + à¸•à¸£à¸§à¸ˆ WATER/ELECTRIC sheet |
| 7 | Payment.gs | submit/review slip à¹„à¸¡à¹ˆ error | `testPayment()` â€” à¸”à¸¹ Log + à¸•à¸£à¸§à¸ˆ SlipSubmissions sheet |
| 8 | Request.gs | submit/review request à¹„à¸¡à¹ˆ error | `testRequest()` â€” à¸”à¸¹ Log + à¸•à¸£à¸§à¸ˆ Requests sheet |
| 9 | Finance.gs | save/load accounting à¹„à¸¡à¹ˆ error | `testFinance()` â€” à¸”à¸¹ Log + à¸•à¸£à¸§à¸ˆ WITHDRAW/ACCOUNTING sheet |
| 10 | Notification.gs | build email template à¹„à¸¡à¹ˆ error (à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸ªà¹ˆà¸‡à¸ˆà¸£à¸´à¸‡) | `testNotification()` â€” à¸”à¸¹ Log |

---

### Test 1: `testConfig()` â€” à¸—à¸”à¸ªà¸­à¸š Config.gs

```javascript
/**
 * à¸—à¸”à¸ªà¸­à¸š Config.gs â€” à¸£à¸±à¸™à¹ƒà¸™ GAS Editor
 * âœ… à¸œà¹ˆà¸²à¸™ = Log à¹à¸ªà¸”à¸‡à¸„à¹ˆà¸²à¸„à¸£à¸š à¹„à¸¡à¹ˆà¸¡à¸µ null/undefined
 * âŒ à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ = à¸¡à¸µ null/undefined â†’ à¸•à¸£à¸§à¸ˆ Config.gs + setup.gs
 */
function testConfig() {
    Logger.log('=== TEST CONFIG.gs ===');
    
    // Test 1: FOLDER_IDS à¸„à¸£à¸š
    Logger.log('\n--- FOLDER_IDS ---');
    const requiredFolders = ['ROOT', 'DATA', 'SLIPS', 'REQUEST_ATTACHMENTS', 
        'RESIDENCE_REQ', 'TRANSFER_REQ', 'RETURN_REQ', 'REPAIR_REQ',
        'ACCOUNTING_RECEIPTS', 'DOCUMENTS', 'BACKUPS'];
    requiredFolders.forEach(key => {
        const val = FOLDER_IDS[key];
        Logger.log(`  ${key}: ${val || 'âŒ MISSING'}`);
        if (!val) throw new Error(`FOLDER_IDS.${key} is missing!`);
    });
    
    // Test 2: SPREADSHEET_IDS à¸„à¸£à¸š
    Logger.log('\n--- SPREADSHEET_IDS ---');
    const requiredSheets = ['MAIN', 'WATER', 'ELECTRIC', 'PAYMENTS', 
        'REQUESTS', 'ACCOUNTING', 'WITHDRAW', 'NOTIFICATIONS'];
    requiredSheets.forEach(key => {
        const val = SPREADSHEET_IDS[key];
        Logger.log(`  ${key}: ${val || 'âŒ MISSING'}`);
        if (!val) throw new Error(`SPREADSHEET_IDS.${key} is missing!`);
    });
    
    // Test 3: DEFAULTS à¸„à¸£à¸š
    Logger.log('\n--- DEFAULTS ---');
    const requiredDefaults = ['water_rate', 'common_fee_house', 'common_fee_flat', 
        'due_date', 'reminder_days', 'house_prefix', 'flat_prefix', 'garbage_fee'];
    requiredDefaults.forEach(key => {
        const val = DEFAULTS[key];
        Logger.log(`  ${key}: ${val}`);
        if (val === undefined || val === null) throw new Error(`DEFAULTS.${key} is missing!`);
    });
    
    // Test 4: ID_PREFIXES à¸„à¸£à¸š
    Logger.log('\n--- ID_PREFIXES ---');
    Logger.log(`  à¸ˆà¸³à¸™à¸§à¸™ prefix: ${Object.keys(ID_PREFIXES).length}`);
    Logger.log(`  prefixes: ${Object.keys(ID_PREFIXES).join(', ')}`);
    
    Logger.log('\nâœ… CONFIG TEST PASSED');
}
```

---

### Test 2: `testDB()` â€” à¸—à¸”à¸ªà¸­à¸š Database.gs

```javascript
/**
 * à¸—à¸”à¸ªà¸­à¸š Database.gs â€” à¸£à¸±à¸™à¹ƒà¸™ GAS Editor
 * âœ… à¸œà¹ˆà¸²à¸™ = CRUD à¸—à¸³à¸‡à¸²à¸™à¸„à¸£à¸š à¹„à¸¡à¹ˆà¸¡à¸µ error
 * âŒ à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ = error â†’ à¸•à¸£à¸§à¸ˆ Database.gs + Config.gs
 * âš ï¸ à¹ƒà¸Šà¹‰ Settings sheet à¹ƒà¸™ [MAIN] à¹€à¸›à¹‡à¸™à¸•à¸±à¸§à¸—à¸”à¸ªà¸­à¸š
 */
function testDB() {
    Logger.log('=== TEST DATABASE.gs ===');
    
    // Test 1: readSheetData
    Logger.log('\n--- READ ---');
    const settings = readSheetData(SPREADSHEET_IDS.MAIN, 'Settings');
    Logger.log(`  Settings rows: ${settings.length}`);
    if (settings.length === 0) Logger.log('  âš ï¸ Settings à¸§à¹ˆà¸²à¸‡ â€” à¸­à¸²à¸ˆà¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸£à¸±à¸™ setupAll()');
    
    // Test 2: appendRowToSheet
    Logger.log('\n--- APPEND ---');
    const testId = getNextId('TST');
    const appendResult = appendRowToSheet(SPREADSHEET_IDS.MAIN, 'Logs', {
        id: testId,
        action: 'TEST',
        userId: 'TEST_USER',
        detail: 'à¸—à¸”à¸ªà¸­à¸š appendRowToSheet',
        timestamp: new Date().toISOString()
    });
    Logger.log(`  Append result: ${JSON.stringify(appendResult)}`);
    
    // Test 3: readSheetDataFiltered
    Logger.log('\n--- READ FILTERED ---');
    const filtered = readSheetDataFiltered(SPREADSHEET_IDS.MAIN, 'Logs', 'id', testId);
    Logger.log(`  Found rows: ${filtered.length}`);
    if (filtered.length !== 1) throw new Error('readSheetDataFiltered à¹„à¸¡à¹ˆà¸žà¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹€à¸žà¸´à¹ˆà¸‡à¹€à¸žà¸´à¹ˆà¸¡');
    
    // Test 4: updateRowInSheet
    Logger.log('\n--- UPDATE ---');
    const updateResult = updateRowInSheet(SPREADSHEET_IDS.MAIN, 'Logs', 'id', testId, {
        detail: 'à¸—à¸”à¸ªà¸­à¸š updateRowInSheet â€” à¸­à¸±à¸›à¹€à¸”à¸•à¹à¸¥à¹‰à¸§'
    });
    Logger.log(`  Update result: ${JSON.stringify(updateResult)}`);
    
    // Test 5: deleteRowFromSheet
    Logger.log('\n--- DELETE ---');
    const deleteResult = deleteRowFromSheet(SPREADSHEET_IDS.MAIN, 'Logs', 'id', testId);
    Logger.log(`  Delete result: ${JSON.stringify(deleteResult)}`);
    
    // Test 6: Verify deletion
    const verify = readSheetDataFiltered(SPREADSHEET_IDS.MAIN, 'Logs', 'id', testId);
    Logger.log(`  After delete, found rows: ${verify.length}`);
    if (verify.length !== 0) throw new Error('deleteRowFromSheet à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸¥à¸šà¸ˆà¸£à¸´à¸‡');
    
    // Test 7: getNextId format
    Logger.log('\n--- ID GENERATION ---');
    const id1 = getNextId('HOU');
    const id2 = getNextId('HOU');
    Logger.log(`  ID 1: ${id1}`);
    Logger.log(`  ID 2: ${id2}`);
    if (id1 === id2) throw new Error('getNextId à¸ªà¸£à¹‰à¸²à¸‡ ID à¸‹à¹‰à¸³!');
    
    // Test 8: LockService (withLock)
    Logger.log('\n--- LOCK SERVICE ---');
    const lockResult = withLock(() => {
        return { success: true, message: 'Lock à¸—à¸³à¸‡à¸²à¸™à¸›à¸à¸•à¸´' };
    });
    Logger.log(`  Lock result: ${JSON.stringify(lockResult)}`);
    
    Logger.log('\nâœ… DATABASE TEST PASSED');
}
```

---

### Test 3: `testMain()` â€” à¸—à¸”à¸ªà¸­à¸š Main.gs

```javascript
/**
 * à¸—à¸”à¸ªà¸­à¸š Main.gs â€” à¸£à¸±à¸™ 2 à¸§à¸´à¸˜à¸µ
 * 
 * à¸§à¸´à¸˜à¸µ 1: à¸£à¸±à¸™à¹ƒà¸™ GAS Editor (à¸—à¸”à¸ªà¸­à¸š routing logic)
 * à¸§à¸´à¸˜à¸µ 2: Deploy à¹€à¸›à¹‡à¸™ Web App â†’ à¹€à¸£à¸µà¸¢à¸à¸œà¹ˆà¸²à¸™ Browser/fetch
 * 
 * âœ… à¸œà¹ˆà¸²à¸™ = JSON response à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡ à¹„à¸¡à¹ˆà¸¡à¸µ error
 * âŒ à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ = error â†’ à¸•à¸£à¸§à¸ˆ Main.gs + route mappings
 */

// === à¸§à¸´à¸˜à¸µ 1: à¸—à¸”à¸ªà¸­à¸š routing logic ===
function testMain() {
    Logger.log('=== TEST MAIN.gs ===');
    
    // Test 1: doGet â€” GET action
    Logger.log('\n--- doGet ---');
    const getResult = doGet({ parameter: { action: 'getSettings' } });
    const getContent = getResult.getContent();
    const getJson = JSON.parse(getContent);
    Logger.log(`  getSettings response: ${getContent.substring(0, 200)}...`);
    if (getJson.error === 'INTERNAL_ERROR') throw new Error('doGet getSettings failed: ' + getJson.message);
    
    // Test 2: doPost â€” Public action (login â€” à¸ˆà¸° fail à¹€à¸žà¸£à¸²à¸°à¹„à¸¡à¹ˆà¸¡à¸µ user à¹à¸•à¹ˆà¸•à¹‰à¸­à¸‡à¹„à¸¡à¹ˆ crash)
    Logger.log('\n--- doPost (public action) ---');
    const postResult = doPost({
        postData: {
            contents: JSON.stringify({
                action: 'login',
                email: 'test@test.com',
                password: 'test123'
            })
        }
    });
    const postContent = postResult.getContent();
    Logger.log(`  login response: ${postContent.substring(0, 200)}`);
    // login should return {success:false} (à¹„à¸¡à¹ˆà¸¡à¸µ user) à¹à¸•à¹ˆà¸•à¹‰à¸­à¸‡à¹„à¸¡à¹ˆ crash
    
    // Test 3: doPost â€” Protected action without token (à¸•à¹‰à¸­à¸‡ return SESSION_EXPIRED)
    Logger.log('\n--- doPost (protected without token) ---');
    const protResult = doPost({
        postData: {
            contents: JSON.stringify({
                action: 'getHousing'
                // à¹„à¸¡à¹ˆà¸¡à¸µ token â†’ à¸•à¹‰à¸­à¸‡ reject
            })
        }
    });
    const protContent = protResult.getContent();
    const protJson = JSON.parse(protContent);
    Logger.log(`  Protected response: ${protContent}`);
    if (protJson.error !== 'SESSION_EXPIRED') {
        Logger.log('  âš ï¸ Warning: Protected route à¹„à¸¡à¹ˆà¹„à¸”à¹‰ return SESSION_EXPIRED');
    }
    
    Logger.log('\nâœ… MAIN TEST PASSED (routing logic)');
    Logger.log('\nðŸ“Œ à¸—à¸”à¸ªà¸­à¸š Web App:');
    Logger.log('  1. Deploy â†’ New deployment â†’ Web app â†’ Anyone');
    Logger.log('  2. à¹€à¸›à¸´à¸” URL à¹ƒà¸™ browser: URL?action=getSettings');
    Logger.log('  3. à¸•à¹‰à¸­à¸‡à¹€à¸«à¹‡à¸™ JSON response à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ error page');
}
```

---

### Test 4: `testAuth()` â€” à¸—à¸”à¸ªà¸­à¸š Auth.gs

```javascript
/**
 * à¸—à¸”à¸ªà¸­à¸š Auth.gs â€” à¸£à¸±à¸™à¹ƒà¸™ GAS Editor
 * âœ… à¸œà¹ˆà¸²à¸™ = registerâ†’pending, loginâ†’token, validateâ†’user
 * âŒ à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ = error â†’ à¸•à¸£à¸§à¸ˆ Auth.gs + Database.gs
 * 
 * âš ï¸ Test à¸™à¸µà¹‰à¸ˆà¸°à¸ªà¸£à¹‰à¸²à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¹ƒà¸™ PendingReg sheet â€” à¸¥à¸šà¸—à¸´à¹‰à¸‡à¸«à¸¥à¸±à¸‡à¸—à¸”à¸ªà¸­à¸š
 */
function testAuth() {
    Logger.log('=== TEST AUTH.gs ===');
    const testEmail = 'test_auth_' + Date.now() + '@test.com';
    
    // Test 1: Register â†’ à¸•à¹‰à¸­à¸‡à¹„à¸”à¹‰ pending
    Logger.log('\n--- REGISTER ---');
    const regResult = handleRegister({
        email: testEmail,
        phone: '0812345678',
        prefix: 'à¸™à¸²à¸¢',
        firstname: 'à¸—à¸”à¸ªà¸­à¸š',
        lastname: 'à¸£à¸°à¸šà¸š',
        position: 'à¸„à¸£à¸¹',
        address_no: '1',
        address_road: '-',
        address_village: '-',
        subdistrict: 'à¹ƒà¸™à¹€à¸¡à¸·à¸­à¸‡',
        district: 'à¹€à¸¡à¸·à¸­à¸‡',
        province: 'à¹€à¸žà¸Šà¸£à¸šà¸¹à¸£à¸“à¹Œ',
        zipcode: '67000',
        password: 'Test1234!',
        pdpaConsent: true
    });
    Logger.log(`  Register result: ${JSON.stringify(regResult)}`);
    if (!regResult.success) throw new Error('Register failed: ' + JSON.stringify(regResult));
    
    // Test 2: Login à¸”à¹‰à¸§à¸¢ pending account â†’ à¸•à¹‰à¸­à¸‡ fail (à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸­à¸™à¸¸à¸¡à¸±à¸•à¸´)
    Logger.log('\n--- LOGIN (pending) ---');
    const loginPending = handleLogin(testEmail, 'Test1234!');
    Logger.log(`  Login pending result: ${JSON.stringify(loginPending)}`);
    // account à¸¢à¸±à¸‡à¹€à¸›à¹‡à¸™ pending â†’ à¸•à¹‰à¸­à¸‡ return error à¸«à¸£à¸·à¸­ success=false
    
    // Test 3: getPendingRegistrations
    Logger.log('\n--- GET PENDING ---');
    const pending = getPendingRegistrations();
    Logger.log(`  Pending count: ${pending.length}`);
    const testPending = pending.find(p => p.email === testEmail);
    Logger.log(`  Found test registration: ${!!testPending}`);
    if (!testPending) throw new Error('à¹„à¸¡à¹ˆà¸žà¸š pending registration à¸—à¸µà¹ˆà¹€à¸žà¸´à¹ˆà¸‡à¸ªà¸£à¹‰à¸²à¸‡');
    
    // Test 4: Approve registration â†’ à¸¢à¹‰à¸²à¸¢à¹„à¸› Users + Residents
    Logger.log('\n--- APPROVE ---');
    const approveResult = approveRegistration(testPending.id, {
        house_number: 'à¸šà¹‰à¸²à¸™ 1',
        resident_type: 'staff'
    });
    Logger.log(`  Approve result: ${JSON.stringify(approveResult)}`);
    
    // Test 5: Login à¸”à¹‰à¸§à¸¢ approved account â†’ à¸•à¹‰à¸­à¸‡ success + token
    Logger.log('\n--- LOGIN (approved) ---');
    const loginResult = handleLogin(testEmail, 'Test1234!');
    Logger.log(`  Login result: ${JSON.stringify(loginResult)}`);
    if (!loginResult.success || !loginResult.token) {
        Logger.log('  âš ï¸ Login à¸­à¸²à¸ˆà¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸—à¸³à¸‡à¸²à¸™ â€” à¸•à¸£à¸§à¸ˆ handleLogin()');
    }
    
    // Test 6: Validate session
    if (loginResult.token) {
        Logger.log('\n--- VALIDATE SESSION ---');
        const session = validateSession(loginResult.token);
        Logger.log(`  Session: ${JSON.stringify(session)}`);
        if (!session) throw new Error('validateSession failed');
        
        // Test 7: getCurrentUser
        Logger.log('\n--- GET CURRENT USER ---');
        const user = getCurrentUser(loginResult.token);
        Logger.log(`  User: ${JSON.stringify(user)}`);
        
        // Test 8: destroySession (cleanup)
        Logger.log('\n--- DESTROY SESSION ---');
        destroySession(loginResult.token);
        const expiredSession = validateSession(loginResult.token);
        Logger.log(`  After destroy: ${expiredSession === null ? 'âœ… null' : 'âŒ still exists'}`);
    }
    
    // Test 9: Session cleanup function
    Logger.log('\n--- CLEANUP SESSIONS ---');
    const cleanupResult = cleanupExpiredSessions();
    Logger.log(`  Cleanup result: ${JSON.stringify(cleanupResult)}`);
    
    // Cleanup: à¸¥à¸š test data
    Logger.log('\n--- CLEANUP TEST DATA ---');
    // à¸¥à¸š test user à¸ˆà¸²à¸ Users/Residents (à¸–à¹‰à¸² approve à¸ªà¸³à¹€à¸£à¹‡à¸ˆ)
    Logger.log('  âš ï¸ à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ test user à¸”à¹‰à¸§à¸¢à¸•à¸™à¹€à¸­à¸‡à¸ˆà¸²à¸ Users + Residents sheet');
    
    Logger.log('\nâœ… AUTH TEST PASSED');
}
```

---

### Test 5: `testHousing()` â€” à¸—à¸”à¸ªà¸­à¸š Housing.gs

```javascript
/**
 * à¸—à¸”à¸ªà¸­à¸š Housing.gs â€” à¸£à¸±à¸™à¹ƒà¸™ GAS Editor
 * âœ… à¸œà¹ˆà¸²à¸™ = CRUD à¸šà¹‰à¸²à¸™/à¸œà¸¹à¹‰à¸žà¸±à¸/settings à¹„à¸¡à¹ˆ error
 * âŒ à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ = error â†’ à¸•à¸£à¸§à¸ˆ Housing.gs + Database.gs
 */
function testHousing() {
    Logger.log('=== TEST HOUSING.gs ===');
    
    // Test 1: getSettings
    Logger.log('\n--- GET SETTINGS ---');
    const settings = getSettings();
    Logger.log(`  Settings keys: ${Object.keys(settings).length}`);
    Logger.log(`  water_rate: ${settings.water_rate}`);
    Logger.log(`  house_prefix: ${settings.house_prefix}`);
    
    // Test 2: getHousingList
    Logger.log('\n--- GET HOUSING LIST ---');
    const houses = getHousingList();
    Logger.log(`  Housing count: ${houses.length}`);
    if (houses.length > 0) {
        Logger.log(`  First house: ${JSON.stringify(houses[0])}`);
    }
    
    // Test 3: getResidentsList
    Logger.log('\n--- GET RESIDENTS LIST ---');
    const residents = getResidentsList();
    Logger.log(`  Residents count: ${residents.length}`);
    
    // Test 4: getAnnouncements
    Logger.log('\n--- GET ANNOUNCEMENTS ---');
    const announcements = getAnnouncements();
    Logger.log(`  Announcements count: ${announcements.length}`);
    
    // Test 5: getPermissions
    Logger.log('\n--- GET PERMISSIONS ---');
    const permissions = getPermissions();
    Logger.log(`  Permissions: ${JSON.stringify(permissions).substring(0, 200)}`);
    
    // Test 6: getAvailableHousing
    Logger.log('\n--- GET AVAILABLE HOUSING ---');
    const available = getAvailableHousing();
    Logger.log(`  Available count: ${available.length}`);
    
    // Test 7: CRUD test (add â†’ update â†’ delete)
    Logger.log('\n--- CRUD HOUSING ---');
    const addResult = addHousing({
        name: 'TEST_HOUSE_' + Date.now(),
        type: 'house',
        status: 'available',
        capacity: 1
    });
    Logger.log(`  Add result: ${JSON.stringify(addResult)}`);
    
    if (addResult.success && addResult.id) {
        const updateResult = updateHousing(addResult.id, { status: 'maintenance' });
        Logger.log(`  Update result: ${JSON.stringify(updateResult)}`);
        
        const deleteResult = deleteHousing(addResult.id);
        Logger.log(`  Delete result: ${JSON.stringify(deleteResult)}`);
    }
    
    // Test 8: getRegulationsPdf
    Logger.log('\n--- GET REGULATIONS PDF ---');
    try {
        const pdfResult = getRegulationsPdf();
        Logger.log(`  PDF result: ${JSON.stringify(pdfResult).substring(0, 200)}`);
    } catch (e) {
        Logger.log(`  PDF: à¹„à¸¡à¹ˆà¸¡à¸µà¹„à¸Ÿà¸¥à¹Œ PDF à¹ƒà¸™à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ Documents (à¸›à¸à¸•à¸´à¸–à¹‰à¸²à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”)`);
    }
    
    Logger.log('\nâœ… HOUSING TEST PASSED');
}
```

---

### Test 6: `testBilling()` â€” à¸—à¸”à¸ªà¸­à¸š Billing.gs

```javascript
/**
 * à¸—à¸”à¸ªà¸­à¸š Billing.gs â€” à¸£à¸±à¸™à¹ƒà¸™ GAS Editor
 * âœ… à¸œà¹ˆà¸²à¸™ = à¸šà¸±à¸™à¸—à¸¶à¸/à¸”à¸¶à¸‡à¸„à¹ˆà¸²à¸™à¹‰à¸³-à¸„à¹ˆà¸²à¹„à¸Ÿ à¹„à¸¡à¹ˆ error
 * âŒ à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ = error â†’ à¸•à¸£à¸§à¸ˆ Billing.gs + Database.gs
 * 
 * âš ï¸ à¹ƒà¸Šà¹‰ period '2569-02' à¹€à¸›à¹‡à¸™à¸•à¸±à¸§à¸—à¸”à¸ªà¸­à¸š â€” à¸¥à¸šà¸—à¸´à¹‰à¸‡à¸«à¸¥à¸±à¸‡à¸—à¸”à¸ªà¸­à¸š
 */
function testBilling() {
    Logger.log('=== TEST BILLING.gs ===');
    const testPeriod = '2569-02';
    
    // Test 1: getWaterRate
    Logger.log('\n--- GET WATER RATE ---');
    const waterRate = getWaterRate();
    Logger.log(`  Water rate: ${JSON.stringify(waterRate)}`);
    
    // Test 2: getCommonFee
    Logger.log('\n--- GET COMMON FEE ---');
    const commonFee = getCommonFee();
    Logger.log(`  Common fee: ${JSON.stringify(commonFee)}`);
    
    // Test 3: getExemptions
    Logger.log('\n--- GET EXEMPTIONS ---');
    const exemptions = getExemptions();
    Logger.log(`  Exemptions: ${JSON.stringify(exemptions).substring(0, 200)}`);
    
    // Test 4: saveWaterBill
    Logger.log('\n--- SAVE WATER BILL ---');
    const saveWaterResult = saveWaterBill({
        period: testPeriod,
        records: [
            { houseId: 'TEST_H1', prevMeter: 100, currMeter: 120 },
            { houseId: 'TEST_H2', prevMeter: 200, currMeter: 235 }
        ]
    });
    Logger.log(`  Save water result: ${JSON.stringify(saveWaterResult)}`);
    
    // Test 5: getWaterBills
    Logger.log('\n--- GET WATER BILLS ---');
    const waterBills = getWaterBills(testPeriod);
    Logger.log(`  Water bills count: ${waterBills.length}`);
    if (waterBills.length > 0) {
        Logger.log(`  First bill: ${JSON.stringify(waterBills[0])}`);
    }
    
    // Test 6: saveElectricBill
    Logger.log('\n--- SAVE ELECTRIC BILL ---');
    const saveElecResult = saveElectricBill({
        period: testPeriod,
        peaTotal: 50000,
        lostHouse: 500,
        lostFlat: 300,
        records: [
            { houseId: 'TEST_H1', prevMeter: 1000, currMeter: 1200 },
            { houseId: 'TEST_H2', prevMeter: 2000, currMeter: 2350 }
        ]
    });
    Logger.log(`  Save electric result: ${JSON.stringify(saveElecResult)}`);
    
    // Test 7: getElectricBills
    Logger.log('\n--- GET ELECTRIC BILLS ---');
    const electricBills = getElectricBills(testPeriod);
    Logger.log(`  Electric bills count: ${electricBills.length}`);
    
    // Test 8: getBillSummary
    Logger.log('\n--- GET BILL SUMMARY ---');
    try {
        const summary = getBillSummary('TEST_H1', testPeriod);
        Logger.log(`  Summary: ${JSON.stringify(summary)}`);
    } catch (e) {
        Logger.log(`  Summary: ${e.message} (à¸›à¸à¸•à¸´à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡)`);
    }
    
    // Test 9: getBillSummaryAll
    Logger.log('\n--- GET BILL SUMMARY ALL ---');
    try {
        const summaryAll = getBillSummaryAll(testPeriod);
        Logger.log(`  Houses: ${summaryAll.houses ? summaryAll.houses.length : 0}`);
        Logger.log(`  Flats: ${summaryAll.flats ? summaryAll.flats.length : 0}`);
    } catch (e) {
        Logger.log(`  SummaryAll: ${e.message}`);
    }
    
    // Test 10: calculateWaterAmount
    Logger.log('\n--- CALCULATE WATER ---');
    const waterAmount = calculateWaterAmount(100, 120, 18);
    Logger.log(`  Water 100â†’120 @18 = ${waterAmount} (à¸•à¹‰à¸­à¸‡à¹„à¸”à¹‰ 360)`);
    if (waterAmount !== 360) Logger.log('  âš ï¸ à¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“à¸„à¹ˆà¸²à¸™à¹‰à¸³à¸œà¸´à¸”à¸žà¸¥à¸²à¸”');
    
    Logger.log('\nâœ… BILLING TEST PASSED');
    Logger.log('  âš ï¸ à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ test à¸ˆà¸²à¸ [WATER] + [ELECTRIC] sheet à¸”à¹‰à¸§à¸¢à¸•à¸™à¹€à¸­à¸‡');
}
```

---

### Test 7: `testPayment()` â€” à¸—à¸”à¸ªà¸­à¸š Payment.gs

```javascript
/**
 * à¸—à¸”à¸ªà¸­à¸š Payment.gs â€” à¸£à¸±à¸™à¹ƒà¸™ GAS Editor
 * âœ… à¸œà¹ˆà¸²à¸™ = submit/review slip à¹„à¸¡à¹ˆ error
 * âŒ à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ = error â†’ à¸•à¸£à¸§à¸ˆ Payment.gs + Database.gs
 */
function testPayment() {
    Logger.log('=== TEST PAYMENT.gs ===');
    const testPeriod = '2569-02';
    
    // Test 1: handleSubmitSlip
    Logger.log('\n--- SUBMIT SLIP ---');
    const submitResult = handleSubmitSlip({
        houseId: 'TEST_H1',
        period: testPeriod,
        amount: 1500,
        paymentMethod: 'transfer',
        note: 'à¸—à¸”à¸ªà¸­à¸šà¸£à¸°à¸šà¸š',
        // image: à¹„à¸¡à¹ˆà¸ªà¹ˆà¸‡à¸£à¸¹à¸›à¹ƒà¸™à¸à¸²à¸£ test (à¹ƒà¸Šà¹‰à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹à¸—à¸™)
    });
    Logger.log(`  Submit result: ${JSON.stringify(submitResult)}`);
    
    // Test 2: getSlipSubmissions
    Logger.log('\n--- GET SLIP SUBMISSIONS ---');
    const slips = getSlipSubmissions(testPeriod);
    Logger.log(`  Slips count: ${slips.length}`);
    if (slips.length > 0) {
        Logger.log(`  Last slip: ${JSON.stringify(slips[slips.length - 1])}`);
    }
    
    // Test 3: getSlipDetail
    if (submitResult.success && submitResult.slipId) {
        Logger.log('\n--- GET SLIP DETAIL ---');
        const detail = getSlipDetail(submitResult.slipId);
        Logger.log(`  Detail: ${JSON.stringify(detail).substring(0, 200)}`);
        
        // Test 4: handleReviewSlip â†’ approve
        Logger.log('\n--- REVIEW SLIP ---');
        const reviewResult = handleReviewSlip(submitResult.slipId, 'approved', 'à¸—à¸”à¸ªà¸­à¸šà¸­à¸™à¸¸à¸¡à¸±à¸•à¸´');
        Logger.log(`  Review result: ${JSON.stringify(reviewResult)}`);
    }
    
    // Test 5: getPaymentHistory
    Logger.log('\n--- GET PAYMENT HISTORY ---');
    const history = getPaymentHistory('TEST_USER', '02', '2569');
    Logger.log(`  History count: ${history.length}`);
    
    // Test 6: getOutstanding
    Logger.log('\n--- GET OUTSTANDING ---');
    const outstanding = getOutstanding(testPeriod);
    Logger.log(`  Outstanding count: ${outstanding.length}`);
    
    Logger.log('\nâœ… PAYMENT TEST PASSED');
    Logger.log('  âš ï¸ à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ test à¸ˆà¸²à¸ SlipSubmissions + PaymentHistory sheet à¸”à¹‰à¸§à¸¢à¸•à¸™à¹€à¸­à¸‡');
}
```

---

### Test 8: `testRequest()` â€” à¸—à¸”à¸ªà¸­à¸š Request.gs

```javascript
/**
 * à¸—à¸”à¸ªà¸­à¸š Request.gs â€” à¸£à¸±à¸™à¹ƒà¸™ GAS Editor
 * âœ… à¸œà¹ˆà¸²à¸™ = submit/review request à¹„à¸¡à¹ˆ error
 * âŒ à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ = error â†’ à¸•à¸£à¸§à¸ˆ Request.gs + Database.gs
 */
function testRequest() {
    Logger.log('=== TEST REQUEST.gs ===');
    const testYear = '2569';
    
    // Test 1: handleSubmitRequest (residence)
    Logger.log('\n--- SUBMIT REQUEST (residence) ---');
    const submitResult = handleSubmitRequest('residence', {
        userId: 'TEST_USER',
        prefix: 'à¸™à¸²à¸¢',
        firstname: 'à¸—à¸”à¸ªà¸­à¸š',
        lastname: 'à¸„à¸³à¸£à¹‰à¸­à¸‡',
        phone: '0812345678',
        position: 'à¸„à¸£à¸¹',
        subject_group: 'à¸„à¸“à¸´à¸•à¸¨à¸²à¸ªà¸•à¸£à¹Œ',
        stay_type: 'alone',
        submitted_at: '2569-02-17'
    });
    Logger.log(`  Submit result: ${JSON.stringify(submitResult)}`);
    
    // Test 2: getRequests
    Logger.log('\n--- GET REQUESTS ---');
    const requests = getRequests('residence', testYear);
    Logger.log(`  Requests count: ${requests.length}`);
    if (requests.length > 0) {
        Logger.log(`  Last request: ${JSON.stringify(requests[requests.length - 1]).substring(0, 200)}`);
    }
    
    // Test 3: handleReviewRequest â†’ approve
    if (submitResult.success && submitResult.requestId) {
        Logger.log('\n--- REVIEW REQUEST ---');
        const reviewResult = handleReviewRequest('residence', testYear, submitResult.requestId, 'approved', 'à¸—à¸”à¸ªà¸­à¸šà¸­à¸™à¸¸à¸¡à¸±à¸•à¸´');
        Logger.log(`  Review result: ${JSON.stringify(reviewResult)}`);
    }
    
    // Test 4: getQueue
    Logger.log('\n--- GET QUEUE ---');
    const queue = getQueue();
    Logger.log(`  Queue count: ${queue.length}`);
    
    // Test 5: Submit other request types
    Logger.log('\n--- SUBMIT OTHER TYPES ---');
    const types = ['transfer', 'return', 'repair'];
    for (const type of types) {
        try {
            const result = handleSubmitRequest(type, {
                userId: 'TEST_USER',
                prefix: 'à¸™à¸²à¸¢',
                firstname: 'à¸—à¸”à¸ªà¸­à¸š',
                lastname: type,
                submitted_at: '2569-02-17'
            });
            Logger.log(`  ${type}: ${result.success ? 'âœ…' : 'âŒ'} ${JSON.stringify(result).substring(0, 100)}`);
        } catch (e) {
            Logger.log(`  ${type}: âŒ ${e.message}`);
        }
    }
    
    Logger.log('\nâœ… REQUEST TEST PASSED');
    Logger.log('  âš ï¸ à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ test à¸ˆà¸²à¸ Requests sheet + Queue à¸”à¹‰à¸§à¸¢à¸•à¸™à¹€à¸­à¸‡');
}
```

---

### Test 9: `testFinance()` â€” à¸—à¸”à¸ªà¸­à¸š Finance.gs

```javascript
/**
 * à¸—à¸”à¸ªà¸­à¸š Finance.gs â€” à¸£à¸±à¸™à¹ƒà¸™ GAS Editor
 * âœ… à¸œà¹ˆà¸²à¸™ = save/load accounting à¹„à¸¡à¹ˆ error
 * âŒ à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ = error â†’ à¸•à¸£à¸§à¸ˆ Finance.gs + Database.gs
 */
function testFinance() {
    Logger.log('=== TEST FINANCE.gs ===');
    const testPeriod = '2569-02';
    
    // Test 1: handleSaveWithdraw
    Logger.log('\n--- SAVE WITHDRAW ---');
    const saveResult = handleSaveWithdraw({
        period: testPeriod,
        garbageFee: 310,
        additionalItems: [
            { name: 'à¸„à¹ˆà¸²à¸‹à¹ˆà¸­à¸¡à¹à¸‹à¸¡', amount: 500 },
            { name: 'à¸„à¹ˆà¸²à¸§à¸±à¸ªà¸”à¸¸', amount: 200 }
        ],
        savedAt: new Date().toISOString()
    });
    Logger.log(`  Save withdraw result: ${JSON.stringify(saveResult)}`);
    
    // Test 2: getMonthlyWithdraw
    Logger.log('\n--- GET MONTHLY WITHDRAW ---');
    const withdraw = getMonthlyWithdraw(testPeriod);
    Logger.log(`  Withdraw: ${JSON.stringify(withdraw).substring(0, 200)}`);
    
    // Test 3: getWaterBillTotal
    Logger.log('\n--- GET WATER BILL TOTAL ---');
    try {
        const waterTotal = getWaterBillTotal(testPeriod);
        Logger.log(`  Water total: ${waterTotal}`);
    } catch (e) {
        Logger.log(`  Water total: ${e.message} (à¸›à¸à¸•à¸´à¸–à¹‰à¸²à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥)`);
    }
    
    // Test 4: getElectricBillPEA
    Logger.log('\n--- GET ELECTRIC BILL PEA ---');
    try {
        const peaTotal = getElectricBillPEA(testPeriod);
        Logger.log(`  PEA total: ${peaTotal}`);
    } catch (e) {
        Logger.log(`  PEA total: ${e.message} (à¸›à¸à¸•à¸´à¸–à¹‰à¸²à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µà¸‚à¹‰à¸­à¸¡à¸¹à¸¥)`);
    }
    
    // Test 5: calculateAutoEntries
    Logger.log('\n--- CALCULATE AUTO ENTRIES ---');
    try {
        const autoEntries = calculateAutoEntries(testPeriod);
        Logger.log(`  Auto entries: ${JSON.stringify(autoEntries).substring(0, 300)}`);
    } catch (e) {
        Logger.log(`  Auto entries: ${e.message}`);
    }
    
    // Test 6: saveAccountingData
    Logger.log('\n--- SAVE ACCOUNTING ---');
    const accResult = handleSaveAccounting({
        period: testPeriod,
        carryForward: 10000,
        incomeItems: [
            { id: 'INC_TEST_1', name: 'à¸„à¹ˆà¸²à¸ªà¹ˆà¸§à¸™à¸à¸¥à¸²à¸‡', amount: 5000, type: 'auto' }
        ],
        expenseItems: [
            { id: 'EXP_TEST_1', name: 'à¸„à¹ˆà¸²à¸‚à¸¢à¸°', amount: 310, type: 'auto' }
        ],
        savedAt: new Date().toISOString()
    });
    Logger.log(`  Save accounting result: ${JSON.stringify(accResult)}`);
    
    // Test 7: loadAccountingData
    Logger.log('\n--- LOAD ACCOUNTING ---');
    const accData = loadAccountingData(testPeriod);
    Logger.log(`  Accounting data: ${JSON.stringify(accData).substring(0, 300)}`);
    
    // Test 8: getCarryForward
    Logger.log('\n--- GET CARRY FORWARD ---');
    const carry = getCarryForward(testPeriod);
    Logger.log(`  Carry forward: ${carry}`);
    
    Logger.log('\nâœ… FINANCE TEST PASSED');
    Logger.log('  âš ï¸ à¸¥à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ test à¸ˆà¸²à¸ [WITHDRAW] + [ACCOUNTING] sheet à¸”à¹‰à¸§à¸¢à¸•à¸™à¹€à¸­à¸‡');
}
```

---

### Test 10: `testNotification()` â€” à¸—à¸”à¸ªà¸­à¸š Notification.gs

```javascript
/**
 * à¸—à¸”à¸ªà¸­à¸š Notification.gs â€” à¸£à¸±à¸™à¹ƒà¸™ GAS Editor
 * âœ… à¸œà¹ˆà¸²à¸™ = build email template à¹„à¸¡à¹ˆ error (à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸ªà¹ˆà¸‡à¸ˆà¸£à¸´à¸‡)
 * âŒ à¹„à¸¡à¹ˆà¸œà¹ˆà¸²à¸™ = error â†’ à¸•à¸£à¸§à¸ˆ Notification.gs
 * 
 * âš ï¸ à¸—à¸”à¸ªà¸­à¸šà¹à¸„à¹ˆà¸à¸²à¸£à¸ªà¸£à¹‰à¸²à¸‡ template â€” à¹„à¸¡à¹ˆà¸ªà¹ˆà¸‡ email à¸ˆà¸£à¸´à¸‡
 */
function testNotification() {
    Logger.log('=== TEST NOTIFICATION.gs ===');
    
    // Test 1: buildEmailTemplate â€” reminder
    Logger.log('\n--- BUILD TEMPLATE: reminder ---');
    const reminderHtml = buildEmailTemplate('reminder', {
        recipientName: 'à¸—à¸”à¸ªà¸­à¸š à¸£à¸°à¸šà¸š',
        houseNumber: 'à¸šà¹‰à¸²à¸™ 1',
        period: '2569-02',
        waterBill: 360,
        electricBill: 1200,
        commonFee: 110,
        totalAmount: 1670,
        dueDate: '15 à¸à¸¸à¸¡à¸ à¸²à¸žà¸±à¸™à¸˜à¹Œ 2569'
    });
    Logger.log(`  Reminder template length: ${reminderHtml.length}`);
    Logger.log(`  Preview: ${reminderHtml.substring(0, 200)}...`);
    if (!reminderHtml || reminderHtml.length < 50) throw new Error('Reminder template à¸§à¹ˆà¸²à¸‡à¸«à¸£à¸·à¸­à¸ªà¸±à¹‰à¸™à¹€à¸à¸´à¸™à¹„à¸›');
    
    // Test 2: buildEmailTemplate â€” receipt
    Logger.log('\n--- BUILD TEMPLATE: receipt ---');
    const receiptHtml = buildEmailTemplate('receipt', {
        recipientName: 'à¸—à¸”à¸ªà¸­à¸š à¸£à¸°à¸šà¸š',
        houseNumber: 'à¸šà¹‰à¸²à¸™ 1',
        period: '2569-02',
        amount: 1670,
        paymentDate: '2569-02-10',
        paymentMethod: 'transfer',
        approvedBy: 'à¹à¸­à¸”à¸¡à¸´à¸™'
    });
    Logger.log(`  Receipt template length: ${receiptHtml.length}`);
    Logger.log(`  Preview: ${receiptHtml.substring(0, 200)}...`);
    
    // Test 3: buildEmailTemplate â€” password_reset
    Logger.log('\n--- BUILD TEMPLATE: password_reset ---');
    const resetHtml = buildEmailTemplate('password_reset', {
        recipientName: 'à¸—à¸”à¸ªà¸­à¸š à¸£à¸°à¸šà¸š',
        resetLink: 'https://example.com/reset?token=abc123'
    });
    Logger.log(`  Reset template length: ${resetHtml.length}`);
    
    // Test 4: buildEmailTemplate â€” request_status
    Logger.log('\n--- BUILD TEMPLATE: request_status ---');
    const statusHtml = buildEmailTemplate('request_status', {
        recipientName: 'à¸—à¸”à¸ªà¸­à¸š à¸£à¸°à¸šà¸š',
        requestType: 'residence',
        requestId: 'REQ_TEST_001',
        status: 'approved',
        note: 'à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¹ƒà¸«à¹‰à¹€à¸‚à¹‰à¸²à¸žà¸±à¸à¸šà¹‰à¸²à¸™ 1'
    });
    Logger.log(`  Status template length: ${statusHtml.length}`);
    
    // Test 5: sendPaymentNotification (dry run â€” à¹„à¸¡à¹ˆà¸ªà¹ˆà¸‡à¸ˆà¸£à¸´à¸‡)
    Logger.log('\n--- SEND NOTIFICATION (dry run) ---');
    Logger.log('  âš ï¸ à¸‚à¹‰à¸²à¸¡à¸à¸²à¸£à¸ªà¹ˆà¸‡ email à¸ˆà¸£à¸´à¸‡ â€” à¸—à¸”à¸ªà¸­à¸šà¹à¸„à¹ˆ template');
    Logger.log('  â†’ à¸–à¹‰à¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¸ªà¹ˆà¸‡à¸ˆà¸£à¸´à¸‡: sendPaymentNotification(houseId, period)');
    Logger.log('  â†’ à¹ƒà¸Šà¹‰ MailApp.getRemainingDailyQuota() à¸•à¸£à¸§à¸ˆ quota à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡');
    
    // Test 6: MailApp quota
    Logger.log('\n--- MAIL QUOTA ---');
    const remaining = MailApp.getRemainingDailyQuota();
    Logger.log(`  Remaining daily quota: ${remaining}`);
    
    Logger.log('\nâœ… NOTIFICATION TEST PASSED');
}
```

---

## ðŸ“ GAS Limits Safeguards â€” à¸‚à¹‰à¸­à¸ˆà¸³à¸à¸±à¸”à¹à¸¥à¸°à¸§à¸´à¸˜à¸µà¸›à¹‰à¸­à¸‡à¸à¸±à¸™ (S0-6)

> **GAS à¸¡à¸µà¸‚à¹‰à¸­à¸ˆà¸³à¸à¸±à¸”à¸«à¸¥à¸²à¸¢à¸­à¸¢à¹ˆà¸²à¸‡** à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸£à¸°à¸§à¸±à¸‡à¸•à¸±à¹‰à¸‡à¹à¸•à¹ˆà¸­à¸­à¸à¹à¸šà¸š â€” à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¸›à¹‰à¸­à¸‡à¸à¸±à¸™ à¸£à¸°à¸šà¸šà¸ˆà¸°à¸žà¸±à¸‡à¸•à¸­à¸™ production

### 6.1 à¸ªà¸¥à¸´à¸› base64 â€” resize à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡

> **à¸›à¸±à¸à¸«à¸²:** `fetch()` payload à¸‚à¸™à¸²à¸”à¹ƒà¸«à¸à¹ˆ â†’ timeout / GAS execution time à¹€à¸à¸´à¸™ 6 à¸™à¸²à¸—à¸µ  
> **à¸§à¸´à¸˜à¸µà¹à¸à¹‰:** HTML resize à¸£à¸¹à¸› â‰¤ 800px + compress quality 0.7 à¸à¹ˆà¸­à¸™à¹à¸›à¸¥à¸‡ base64 â†’ à¸ªà¹ˆà¸‡à¸—à¸µà¸¥à¸°à¸£à¸¹à¸›

**Pattern à¸ªà¸³à¸«à¸£à¸±à¸š Frontend (upload-slip.html):**

```javascript
// ============ Image Resize à¸à¹ˆà¸­à¸™à¸ªà¹ˆà¸‡ ============
function resizeImage(file, maxWidth = 800, quality = 0.7) {
    return new Promise((resolve) => {
        const canvas = document.createElement('canvas');
        const img = new Image();
        img.onload = () => {
            const ratio = Math.min(maxWidth / img.width, 1);
            canvas.width = img.width * ratio;
            canvas.height = img.height * ratio;
            canvas.getContext('2d').drawImage(img, 0, 0, canvas.width, canvas.height);
            resolve(canvas.toDataURL('image/jpeg', quality)); // â‰¤ 100KB per image
        };
        img.src = URL.createObjectURL(file);
    });
}

// à¸ªà¹ˆà¸‡à¸—à¸µà¸¥à¸°à¸£à¸¹à¸› (à¹„à¸¡à¹ˆà¸£à¸§à¸¡ 3 à¸£à¸¹à¸›à¹ƒà¸™ payload à¹€à¸”à¸µà¸¢à¸§):
async function uploadSlipImages(images, houseId, period) {
    const fileIds = [];
    for (const img of images) {
        const resized = await resizeImage(img);
        const result = await callBackend('uploadSlipImage', { 
            image: resized, houseId, period, index: fileIds.length 
        });
        fileIds.push(result.fileId);
    }
    return fileIds;
}
```

**Backend Pattern (Payment.gs):**

```javascript
// ============ à¸£à¸±à¸š base64 â†’ à¸šà¸±à¸™à¸—à¸¶à¸à¹€à¸›à¹‡à¸™à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸™ Drive ============
function saveSlipImage(base64Data, houseId, period, index) {
    const folder = DriveApp.getFolderById(FOLDER_IDS.SLIPS);
    const fileName = `${houseId}_${period}_${index}.jpg`;
    
    // à¹à¸›à¸¥à¸‡ base64 â†’ Blob
    const base64Content = base64Data.replace(/^data:image\/\w+;base64,/, '');
    const blob = Utilities.newBlob(
        Utilities.base64Decode(base64Content), 
        'image/jpeg', 
        fileName
    );
    
    const file = folder.createFile(blob);
    file.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);
    return { fileId: file.getId(), url: file.getUrl() };
}
```

### 6.2 Email batch â€” à¹„à¸¡à¹ˆà¹€à¸à¸´à¸™ 50/execution

> **à¸›à¸±à¸à¸«à¸²:** GAS free tier = 100 email/à¸§à¸±à¸™, execution timeout = 6 à¸™à¸²à¸—à¸µ  
> **à¸§à¸´à¸˜à¸µà¹à¸à¹‰:** à¹ƒà¸Šà¹‰ `MailApp` (à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ GmailApp) + à¹à¸šà¹ˆà¸‡ batch â‰¤ 50 à¸„à¸™/execution + à¸•à¸±à¹‰à¸‡ Trigger à¸ªà¹ˆà¸‡à¸•à¹ˆà¸­

**Pattern à¸ªà¸³à¸«à¸£à¸±à¸š Notification.gs:**

```javascript
// ============ Batch Email ============
function sendBulkNotifications(period) {
    const recipients = getAllRecipients(period);
    const BATCH_SIZE = 50; // GAS free limit = 100/day
    const batches = [];
    
    for (let i = 0; i < recipients.length; i += BATCH_SIZE) {
        batches.push(recipients.slice(i, i + BATCH_SIZE));
    }
    
    // à¸ªà¹ˆà¸‡ batch à¹à¸£à¸à¸—à¸±à¸™à¸—à¸µ
    sendEmailBatch(batches[0], period);
    
    // à¸–à¹‰à¸²à¸¡à¸µ batch à¸–à¸±à¸”à¹„à¸› â†’ à¸•à¸±à¹‰à¸‡ Trigger à¸ªà¹ˆà¸‡à¸—à¸¸à¸ 5 à¸™à¸²à¸—à¸µ
    if (batches.length > 1) {
        // à¹€à¸à¹‡à¸š remaining batches à¹ƒà¸™ PropertiesService
        PropertiesService.getScriptProperties().setProperty(
            'pendingEmails', JSON.stringify({ batches: batches.slice(1), period })
        );
        ScriptApp.newTrigger('processPendingEmails')
            .timeBased()
            .after(5 * 60 * 1000)
            .create();
    }
}

function processPendingEmails() {
    const props = PropertiesService.getScriptProperties();
    const raw = props.getProperty('pendingEmails');
    if (!raw) return;
    
    const { batches, period } = JSON.parse(raw);
    if (!batches || batches.length === 0) {
        props.deleteProperty('pendingEmails');
        return;
    }
    
    // à¸ªà¹ˆà¸‡ batch à¸–à¸±à¸”à¹„à¸›
    sendEmailBatch(batches[0], period);
    
    // à¸­à¸±à¸›à¹€à¸”à¸• remaining
    if (batches.length > 1) {
        props.setProperty('pendingEmails', JSON.stringify({
            batches: batches.slice(1), period
        }));
        ScriptApp.newTrigger('processPendingEmails')
            .timeBased()
            .after(5 * 60 * 1000)
            .create();
    } else {
        props.deleteProperty('pendingEmails');
    }
    
    // à¸¥à¸š Trigger à¸•à¸±à¸§à¹€à¸­à¸‡
    const triggers = ScriptApp.getProjectTriggers();
    triggers.forEach(t => {
        if (t.getHandlerFunction() === 'processPendingEmails') {
            ScriptApp.deleteTrigger(t);
        }
    });
}

function sendEmailBatch(recipients, period) {
    recipients.forEach(r => {
        try {
            const html = buildEmailTemplate('reminder', r.data);
            MailApp.sendEmail({
                to: r.email,
                subject: `à¹à¸ˆà¹‰à¸‡à¸¢à¸­à¸”à¸Šà¸³à¸£à¸°à¸„à¹ˆà¸²à¸šà¹‰à¸²à¸™à¸žà¸±à¸ ${period}`,
                htmlBody: html
            });
        } catch (e) {
            writeLog('EMAIL_ERROR', 'SYSTEM', `à¸ªà¹ˆà¸‡ email à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆ: ${r.email} â€” ${e.message}`);
        }
    });
}
```

### 6.3 Bulk operations â€” à¹à¸šà¹ˆà¸‡ batch 50 à¹à¸–à¸§/execution

> **à¸›à¸±à¸à¸«à¸²:** GAS execution timeout = 6 à¸™à¸²à¸—à¸µ â†’ bulk operations à¸—à¸µà¹ˆà¸—à¸³à¸—à¸µà¸¥à¸°à¹à¸–à¸§à¸ˆà¸° timeout  
> **à¸§à¸´à¸˜à¸µà¹à¸à¹‰:** à¹ƒà¸Šà¹‰ `setValues()` à¹à¸—à¸™ `appendRow()` loop + à¹à¸šà¹ˆà¸‡ batch 50 à¹à¸–à¸§

**Pattern à¸ªà¸³à¸«à¸£à¸±à¸š Database.gs:**

```javascript
// ============ Batch Operations ============
const BATCH_SIZE = 50; // à¹à¸–à¸§/execution

// à¹ƒà¸Šà¹‰ setValues() à¹à¸—à¸™ appendRow() loop â†’ à¹€à¸£à¹‡à¸§à¸à¸§à¹ˆà¸² 10-50 à¹€à¸—à¹ˆà¸²
function batchAppendRows(spreadsheetId, sheetName, dataArray) {
    return withLock(() => {
        const sheet = getSheetByName(spreadsheetId, sheetName);
        const headers = sheet.getRange(1, 1, 1, sheet.getLastColumn()).getValues()[0];
        
        // à¹à¸šà¹ˆà¸‡ batch
        for (let i = 0; i < dataArray.length; i += BATCH_SIZE) {
            const batch = dataArray.slice(i, i + BATCH_SIZE);
            const rows = batch.map(data => headers.map(h => data[h] || ''));
            const startRow = sheet.getLastRow() + 1;
            sheet.getRange(startRow, 1, rows.length, headers.length).setValues(rows);
            SpreadsheetApp.flush(); // à¸šà¸±à¸‡à¸„à¸±à¸š write à¸—à¸±à¸™à¸—à¸µ
        }
        
        return { success: true, message: `à¹€à¸žà¸´à¹ˆà¸¡ ${dataArray.length} à¹à¸–à¸§à¸ªà¸³à¹€à¸£à¹‡à¸ˆ` };
    });
}
```

### 6.4 à¸ªà¸£à¸¸à¸›à¸‚à¹‰à¸­à¸ˆà¸³à¸à¸±à¸” GAS à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸£à¸°à¸§à¸±à¸‡

| à¸‚à¹‰à¸­à¸ˆà¸³à¸à¸±à¸” | Free tier | à¸§à¸´à¸˜à¸µà¸›à¹‰à¸­à¸‡à¸à¸±à¸™ |
|----------|-----------|------------|
| Execution time | 6 à¸™à¸²à¸—à¸µ/execution | à¹à¸šà¹ˆà¸‡ batch + à¹ƒà¸Šà¹‰ Trigger à¸•à¹ˆà¸­ |
| Email/à¸§à¸±à¸™ | 100 à¸‰à¸šà¸±à¸š | `MailApp` + batch â‰¤ 50 + Trigger 5 à¸™à¸²à¸—à¸µ |
| Properties storage | 500KB total | Session cleanup à¸—à¸¸à¸ 24 à¸Šà¸¡. (S0-7) |
| `fetch()` payload | ~50MB | resize à¸£à¸¹à¸› â‰¤ 800px + à¸ªà¹ˆà¸‡à¸—à¸µà¸¥à¸°à¸£à¸¹à¸› |
| Concurrent execution | 30 instances | `LockService` à¸›à¹‰à¸­à¸‡à¸à¸±à¸™ write conflict (S0-5) |
| Triggers | 20 à¸•à¹ˆà¸­ user | à¸¥à¸š Trigger à¹€à¸à¹ˆà¸²à¸à¹ˆà¸­à¸™à¸ªà¸£à¹‰à¸²à¸‡à¹ƒà¸«à¸¡à¹ˆ |
| URL Fetch calls | 20,000/à¸§à¸±à¸™ | à¹„à¸¡à¹ˆà¸™à¹ˆà¸²à¹€à¸à¸´à¸™ (à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸™à¹‰à¸­à¸¢) |
| Sheet cells | 10,000,000 à¸•à¹ˆà¸­ spreadsheet | à¹à¸¢à¸à¹„à¸Ÿà¸¥à¹Œà¸•à¸²à¸¡à¸«à¸¡à¸§à¸” + à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ |

---

## âš ï¸ à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸à¸ªà¸³à¸„à¸±à¸

1. **setup.gs à¸—à¸µà¹ˆà¸¡à¸µà¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§** â€” à¹ƒà¸Šà¹‰à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ/à¸Šà¸µà¸— à¸„à¸£à¸±à¹‰à¸‡à¹à¸£à¸à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™ à¹„à¸¡à¹ˆà¸™à¸±à¸šà¹€à¸›à¹‡à¸™à¹„à¸Ÿà¸¥à¹Œ Backend à¸«à¸¥à¸±à¸
2. **à¸—à¸¸à¸à¹„à¸Ÿà¸¥à¹Œà¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ GAS Project à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™** â€” à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹à¸¢à¸ project à¹€à¸žà¸£à¸²à¸° GAS à¸£à¸§à¸¡à¸—à¸¸à¸ .gs à¹€à¸›à¹‡à¸™ scope à¹€à¸”à¸µà¸¢à¸§
3. **Config.gs à¸•à¹‰à¸­à¸‡à¸—à¸³à¸à¹ˆà¸­à¸™à¸ªà¸¸à¸”** â€” à¹€à¸žà¸£à¸²à¸°à¸—à¸¸à¸à¹„à¸Ÿà¸¥à¹Œà¸­à¹‰à¸²à¸‡à¸­à¸´à¸‡ ID à¸ˆà¸²à¸à¸—à¸µà¹ˆà¸™à¸µà¹ˆ
4. **Database.gs à¹€à¸›à¹‡à¸™à¸Šà¸±à¹‰à¸™à¸à¸¥à¸²à¸‡** â€” à¸—à¸¸à¸à¹„à¸Ÿà¸¥à¹Œà¹€à¸£à¸µà¸¢à¸ CRUD à¸œà¹ˆà¸²à¸™ Database.gs à¹„à¸¡à¹ˆà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡ Sheet à¹‚à¸”à¸¢à¸•à¸£à¸‡ (à¸¢à¸à¹€à¸§à¹‰à¸™à¸à¸£à¸“à¸µà¸žà¸´à¹€à¸¨à¸©)
5. **HTML à¸•à¹‰à¸­à¸‡à¹à¸à¹‰à¹„à¸‚à¸šà¸²à¸‡à¸«à¸™à¹‰à¸²** â€” `register.html` à¸•à¹‰à¸­à¸‡à¹€à¸žà¸´à¹ˆà¸¡à¸à¸²à¸£à¹€à¸£à¸µà¸¢à¸ Backend + à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸£à¸­à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´, `admin-settings.html` à¸•à¹‰à¸­à¸‡à¹€à¸žà¸´à¹ˆà¸¡à¹à¸—à¹‡à¸šà¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸à¸²à¸£à¸ªà¸¡à¸±à¸„à¸£, `payment-notification.html` à¸•à¹‰à¸­à¸‡à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ˆà¸²à¸ hardcoded à¹€à¸›à¹‡à¸™à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡ + à¹€à¸žà¸´à¹ˆà¸¡à¸à¸²à¸£à¸šà¸±à¸™à¸—à¸¶à¸ snapshot, `regulations.html` à¸•à¹‰à¸­à¸‡à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ˆà¸²à¸ localStorage à¹€à¸›à¹‡à¸™à¸”à¸¶à¸‡à¸ˆà¸²à¸ Drive

### âš ï¸ à¸‚à¹‰à¸­à¸šà¸à¸žà¸£à¹ˆà¸­à¸‡/à¸‚à¹‰à¸­à¹à¸•à¸à¸•à¹ˆà¸²à¸‡à¹ƒà¸™ HTML à¸—à¸µà¹ˆ Backend à¸•à¹‰à¸­à¸‡à¸£à¸­à¸‡à¸£à¸±à¸š

| # | à¸›à¸±à¸à¸«à¸² | à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸” |
|---|-------|-----------|
| 1 | **commonFee vs commonFeeRate** | admin-settings à¹€à¸‚à¸µà¸¢à¸™ `commonFee`, upload-slip/accounting à¸­à¹ˆà¸²à¸™ `commonFeeRate` â€” Backend à¸•à¹‰à¸­à¸‡ return à¸„à¹ˆà¸²à¸œà¹ˆà¸²à¸™ API |
| 2 | **currentUser vs currentUserUnit** | dashboard/check-slip à¸­à¹ˆà¸²à¸™ `currentUser` (JSON object), upload-slip à¸­à¹ˆà¸²à¸™ `currentUserUnit` (String) â€” Backend à¸•à¹‰à¸­à¸‡ return à¸—à¸±à¹‰à¸‡ object + unit |
| 3 | **Password à¹€à¸à¹‡à¸šà¹ƒà¸™ residents** | admin-settings à¹€à¸à¹‡à¸š password (btoa) à¹ƒà¸™ residentsData â€” Backend normalize à¹„à¸› Users sheet à¹€à¸›à¹‡à¸™ SHA-256 |
| 4 | **Forms à¹„à¸¡à¹ˆà¸¡à¸µ submit** | login/register/forgot/request/transfer/return/repair à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¹€à¸£à¸µà¸¢à¸ Backend â€” à¸•à¹‰à¸­à¸‡à¹€à¸žà¸´à¹ˆà¸¡ `callBackend()` à¸œà¹ˆà¸²à¸™ `fetch()` |
| 5 | **Hardcoded sample data** | payment-history (HTML table), payment-notification (getSampleData), check-request (initSampleData) â€” Backend à¸•à¹‰à¸­à¸‡ replace à¸”à¹‰à¸§à¸¢à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡ |
| 6 | **à¸ªà¸¥à¸´à¸›à¹€à¸à¹‡à¸š base64** | upload-slip à¹€à¸à¹‡à¸šà¸£à¸¹à¸›à¸ªà¸¥à¸´à¸›à¹€à¸›à¹‡à¸™ base64 à¹ƒà¸™ localStorage â€” Backend à¸•à¹‰à¸­à¸‡à¹à¸›à¸¥à¸‡à¹€à¸›à¹‡à¸™à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸™ Drive |
| 7 | **Queue à¸à¸±à¸‡à¹ƒà¸™ request** | check-request à¹€à¸à¹‡à¸š queuePosition/expiryDate à¹€à¸›à¹‡à¸™ property à¸‚à¸­à¸‡ request â€” Backend à¹ƒà¸Šà¹‰ Queue sheet à¹à¸¢à¸ + sync à¸à¸¥à¸±à¸š `Residence_{year}` |
| 8 | **à¸£à¸¹à¸›à¸«à¸¥à¸±à¸à¸à¸²à¸™à¸šà¸±à¸à¸Šà¸µà¹€à¸à¹‡à¸š base64** | accounting.html à¹€à¸à¹‡à¸šà¸£à¸¹à¸›à¹ƒà¸šà¹€à¸ªà¸£à¹‡à¸ˆà¹€à¸›à¹‡à¸™ base64 â€” Backend à¸•à¹‰à¸­à¸‡à¹à¸›à¸¥à¸‡à¹€à¸›à¹‡à¸™à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸™ `AccountingReceipts/` à¸•à¸±à¹‰à¸‡à¸Šà¸·à¹ˆà¸­ `{à¸£à¸²à¸¢à¸à¸²à¸£}_{YYYY-MM-DD}.jpg` |
| 9 | **à¸šà¸±à¸à¸Šà¸µà¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ** | [ACCOUNTING] à¹ƒà¸Šà¹‰à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ (à¹€à¸Šà¹ˆà¸™ `2569`) à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆà¸Šà¸·à¹ˆà¸­à¸•à¸²à¸¢à¸•à¸±à¸§ â€” Finance.gs à¸•à¹‰à¸­à¸‡ `createYearSheet()` à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¸žà¸šà¹à¸œà¹ˆà¸™à¸‡à¸²à¸™ |
| 10 | **WaterRates/CommonFee/Exemptions à¸¢à¹‰à¸²à¸¢à¹„à¸› MAIN** | WaterRates, CommonFee, Exemptions à¸¢à¹‰à¸²à¸¢à¸ˆà¸²à¸ [BILLS] à¹„à¸› [MAIN] à¹à¸¥à¹‰à¸§ â€” Billing.gs à¸­à¹ˆà¸²à¸™à¸ˆà¸²à¸ [MAIN] à¹à¸—à¸™ (Housing/Residents à¸­à¸¢à¸¹à¹ˆà¹ƒà¸™ [MAIN] à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§ à¹„à¸¡à¹ˆà¹€à¸žà¸´à¹ˆà¸¡ file open) |
| 11 | **MonthlyWithdraw à¹à¸¢à¸à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸«à¸¡à¹ˆ [WITHDRAW]** | MonthlyWithdraw à¸¢à¹‰à¸²à¸¢à¸ˆà¸²à¸ [BILLS] à¹„à¸›à¹€à¸›à¹‡à¸™à¹„à¸Ÿà¸¥à¹Œ Google Sheets à¹à¸¢à¸à¸•à¹ˆà¸²à¸‡à¸«à¸²à¸ `[WITHDRAW] à¸ªà¸£à¸¸à¸›à¹€à¸šà¸´à¸à¸ˆà¹ˆà¸²à¸¢` â€” à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¹à¸¢à¸à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. + à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹€à¸¡à¸·à¹ˆà¸­à¸‚à¸¶à¹‰à¸™à¸›à¸µà¹ƒà¸«à¸¡à¹ˆ |
| 12 | **[BILLS] à¸–à¸¹à¸à¹à¸—à¸™à¸—à¸µà¹ˆà¸”à¹‰à¸§à¸¢ [WATER] + [ELECTRIC]** | à¹„à¸Ÿà¸¥à¹Œ `[BILLS] à¸„à¹ˆà¸²à¸™à¹‰à¸³à¸„à¹ˆà¸²à¹„à¸Ÿ` à¸–à¸¹à¸à¸¢à¸¸à¸š â†’ à¹à¸¢à¸à¹€à¸›à¹‡à¸™ `[WATER] à¸„à¹ˆà¸²à¸™à¹‰à¸³` + `[ELECTRIC] à¸„à¹ˆà¸²à¹„à¸Ÿ` à¹à¸•à¹ˆà¸¥à¸°à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸Šà¹‰à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. â€” Billing.gs à¸•à¹‰à¸­à¸‡à¹€à¸›à¸´à¸” 2 à¹„à¸Ÿà¸¥à¹Œà¹à¸—à¸™ 1 à¹„à¸Ÿà¸¥à¹Œ |
| 13 | **à¹€à¸žà¸´à¹ˆà¸¡ [NOTIFICATIONS] à¹à¸ˆà¹‰à¸‡à¸¢à¸­à¸”à¸Šà¸³à¸£à¸°** | à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸«à¸¡à¹ˆà¹€à¸à¹‡à¸š snapshot à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸ˆà¹‰à¸‡à¸¢à¸­à¸”à¸Šà¸³à¸£à¸° â€” à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ à¸ž.à¸¨. â€” à¸šà¸±à¸™à¸—à¸¶à¸à¸—à¸¸à¸à¸„à¸£à¸±à¹‰à¸‡à¸—à¸µà¹ˆà¸à¸”à¸šà¸±à¸™à¸—à¸¶à¸à¸£à¸¹à¸›à¹ƒà¸™ payment-notification.html à¹€à¸žà¸·à¹ˆà¸­à¹€à¸£à¸µà¸¢à¸à¸”à¸¹à¸¢à¹‰à¸­à¸™à¸«à¸¥à¸±à¸‡ |
| 14 | **à¹€à¸žà¸´à¹ˆà¸¡à¸£à¸°à¸šà¸šà¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸à¸²à¸£à¸ªà¸¡à¸±à¸„à¸£** | register.html à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸¥à¸‡ PendingReg_{à¸›à¸µ} à¹ƒà¸™ [MAIN] (à¸ªà¸–à¸²à¸™à¸° pending) â†’ admin-settings.html à¹à¸—à¹‡à¸šà¹ƒà¸«à¸¡à¹ˆ "à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸à¸²à¸£à¸ªà¸¡à¸±à¸„à¸£" â†’ à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´/à¸›à¸à¸´à¹€à¸ªà¸˜ â†’ à¸¢à¹‰à¸²à¸¢à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸› Users + Residents à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ |
| 15 | **regulations.html à¸”à¸¶à¸‡à¹„à¸Ÿà¸¥à¹Œà¸¥à¹ˆà¸²à¸ªà¸¸à¸”** | regulations.html à¸”à¸¶à¸‡ PDF à¸ˆà¸²à¸à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ Documents/ à¸šà¸™ Drive à¹à¸—à¸™ localStorage â€” Housing.gs `getRegulationsPdf()` à¸”à¸¶à¸‡à¹„à¸Ÿà¸¥à¹Œà¸¥à¹ˆà¸²à¸ªà¸¸à¸”à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™ (sort by date) à¹€à¸¡à¸·à¹ˆà¸­à¸­à¸±à¸›à¹‚à¸«à¸¥à¸”à¹ƒà¸«à¸¡à¹ˆà¹ƒà¸Šà¹‰à¹„à¸Ÿà¸¥à¹Œà¹ƒà¸«à¸¡à¹ˆà¸—à¸±à¸™à¸—à¸µ |
| 16 | **à¸„à¸³à¸£à¹‰à¸­à¸‡ 4 à¸›à¸£à¸°à¹€à¸ à¸— â†’ à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ** | [REQUESTS] à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸ˆà¸²à¸à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¢à¸•à¸±à¸§ (ResidenceRequests, TransferRequests, ReturnRequests, RepairRequests) â†’ à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¡à¸›à¸µ (`Residence_{year}`, `Transfer_{year}`, `Return_{year}`, `Repair_{year}`) â€” à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¸žà¸š â€” à¸—à¸¸à¸à¹à¸–à¸§à¸¡à¸µ `submitted_at` (à¸§à¸±à¸™à¹€à¸”à¸·à¸­à¸™à¸›à¸µ) à¸—à¸µà¹ˆà¸„à¸­à¸¥à¸±à¸¡à¸™à¹Œ B à¸à¸³à¸à¸±à¸š â€” Queue à¸¢à¸±à¸‡à¸„à¸‡à¹€à¸›à¹‡à¸™à¹à¸œà¹ˆà¸™à¸‡à¸²à¸™à¸•à¸²à¸¢à¸•à¸±à¸§ |

---

## ðŸ”§ 7. HTML à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¹à¸à¹‰à¹„à¸‚ â€” Checklist (14 à¸ˆà¸¸à¸” à¹ƒà¸™ 7 à¹„à¸Ÿà¸¥à¹Œ)

> **âš ï¸ à¸ªà¸³à¸„à¸±à¸:** à¹à¸à¹‰ HTML à¹„à¸”à¹‰à¹€à¸¡à¸·à¹ˆà¸­ Backend (.gs) à¸žà¸£à¹‰à¸­à¸¡à¹à¸¥à¹‰à¸§à¹€à¸—à¹ˆà¸²à¸™à¸±à¹‰à¸™ â€” à¸—à¸³à¸•à¸²à¸¡à¸¥à¸³à¸”à¸±à¸š .gs à¸à¹ˆà¸­à¸™ â†’ HTML à¸—à¸µà¸«à¸¥à¸±à¸‡  
> **à¸«à¸¥à¸±à¸à¸à¸²à¸£:** à¹à¸à¹‰à¹€à¸‰à¸žà¸²à¸°à¸ˆà¸¸à¸”à¸—à¸µà¹ˆà¸£à¸°à¸šà¸¸à¹„à¸§à¹‰ à¸«à¹‰à¸²à¸¡à¹à¸à¹‰à¸ªà¹ˆà¸§à¸™à¸­à¸·à¹ˆà¸™  
> **Checklist:** à¹ƒà¸Šà¹‰ `[ ]` à¸ªà¸³à¸«à¸£à¸±à¸šà¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸—à¸³, `[x]` à¸ªà¸³à¸«à¸£à¸±à¸šà¸—à¸³à¹à¸¥à¹‰à¸§

---

### 7.1 `payment-notification.html` â€” 3 à¸ˆà¸¸à¸” (à¸•à¹‰à¸­à¸‡à¸¡à¸µ Billing.gs à¸žà¸£à¹‰à¸­à¸¡à¸à¹ˆà¸­à¸™)

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 1: à¸¥à¸š `getSampleData()` â†’ à¹€à¸£à¸µà¸¢à¸ Backend à¹à¸—à¸™

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `getSampleData()` (à¸›à¸£à¸°à¸¡à¸²à¸“ L226â€“L247)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** Return hardcoded object `{ houses: [...5 à¸£à¸²à¸¢à¸à¸²à¸£...], flats: [...8 à¸£à¸²à¸¢à¸à¸²à¸£...] }` à¹à¸•à¹ˆà¸¥à¸°à¸£à¸²à¸¢à¸à¸²à¸£à¸¡à¸µ `number, residents, prevMeter, currMeter, water, electric, common`  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:** à¸¥à¸šà¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `getSampleData()` à¸­à¸­à¸ â†’ à¸ªà¸£à¹‰à¸²à¸‡à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹ƒà¸«à¸¡à¹ˆà¹€à¸£à¸µà¸¢à¸ Backend:
```javascript
async function getBillData(month, year) {
    // à¹€à¸£à¸µà¸¢à¸ Billing.gs â†’ getBillSummaryAll(period)
    // return { houses: [...], flats: [...] } à¸ˆà¸²à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡à¹ƒà¸™ [WATER] + [ELECTRIC] + CommonFee
}
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Billing.gs` â†’ `getBillSummaryAll(period)`  
**Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** `{year}` à¹ƒà¸™ [WATER], `{year}` à¹ƒà¸™ [ELECTRIC], `CommonFee` à¹ƒà¸™ [MAIN]

---

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 2: `loadBillData()` â†’ async

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `loadBillData()` (à¸›à¸£à¸°à¸¡à¸²à¸“ L248â€“L254)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¹€à¸£à¸µà¸¢à¸ `getSampleData()` synchronous â†’ à¸ªà¹ˆà¸‡à¹ƒà¸«à¹‰ `renderTable()` 2 à¸„à¸£à¸±à¹‰à¸‡ (houses + flats)  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:**
```javascript
async function loadBillData() {
    updateTableTitles();
    updateFooterNotes();
    const month = /* selected month */;
    const year = /* selected year */;
    const data = await getBillData(month, year);  // async call
    renderTable('houseTable', data.houses, 'house');
    renderTable('flatTable', data.flats, 'flat');
}
```
**à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸:** `window.onload` (L346) à¸•à¹‰à¸­à¸‡à¸£à¸­à¸‡à¸£à¸±à¸š async à¸”à¹‰à¸§à¸¢

---

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 3: `saveAsImage()` â†’ à¹€à¸žà¸´à¹ˆà¸¡à¸šà¸±à¸™à¸—à¸¶à¸ snapshot

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `saveAsImage(captureId, type)` (à¸›à¸£à¸°à¸¡à¸²à¸“ L321â€“L344)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¹ƒà¸Šà¹‰ `html2canvas` à¸ªà¸£à¹‰à¸²à¸‡ PNG â†’ trigger download â†’ à¹à¸ªà¸”à¸‡ toast "à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸³à¹€à¸£à¹‡à¸ˆ"  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:** à¸«à¸¥à¸±à¸‡à¸”à¸²à¸§à¸™à¹Œà¹‚à¸«à¸¥à¸” PNG à¹€à¸žà¸´à¹ˆà¸¡:
```javascript
// à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸¸à¸à¹à¸–à¸§à¹ƒà¸™à¸•à¸²à¸£à¸²à¸‡ â†’ à¸ªà¹ˆà¸‡ Backend
const snapshotData = collectTableData(captureId); // à¸£à¸§à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸¸à¸à¸šà¹‰à¸²à¸™
await saveNotificationSnapshot(month, year, snapshotData);
// Backend: Billing.gs â†’ saveNotificationSnapshot(period, data)
// Sheet: {year} à¹ƒà¸™ [NOTIFICATIONS]
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Billing.gs` â†’ `saveNotificationSnapshot(period, data)`, `createNotificationYearSheet(year)`  
**Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** `{year}` à¹ƒà¸™ [NOTIFICATIONS] (à¸ªà¸£à¹‰à¸²à¸‡à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¸–à¹‰à¸²à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸¡à¸µ)

---

### 7.2 `register.html` â€” 1 à¸ˆà¸¸à¸” (à¸•à¹‰à¸­à¸‡à¸¡à¸µ Auth.gs à¸žà¸£à¹‰à¸­à¸¡à¸à¹ˆà¸­à¸™)

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 4: `validateRegister()` â†’ à¹€à¸žà¸´à¹ˆà¸¡ Backend call + UI feedback

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `validateRegister()` (à¸›à¸£à¸°à¸¡à¸²à¸“ L209â€“L262)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¸•à¸£à¸§à¸ˆ email, phone, password, confirmPassword, pdpaConsent â†’ **à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸œà¹ˆà¸²à¸™** â†’ à¸ˆà¸šà¸”à¹‰à¸§à¸¢ `return false` (L261) à¹„à¸¡à¹ˆà¸šà¸±à¸™à¸—à¸¶à¸à¸­à¸°à¹„à¸£  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:** à¸à¹ˆà¸­à¸™ `return false` à¹€à¸žà¸´à¹ˆà¸¡:
```javascript
// 1. à¸£à¸§à¸šà¸£à¸§à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸¸à¸à¸Ÿà¸´à¸¥à¸”à¹Œ
const formData = {
    email: document.getElementById('email').value,
    phone: document.getElementById('phone').value,
    prefix: document.getElementById('prefix').value,
    firstname: document.getElementById('firstname').value,
    lastname: document.getElementById('lastname').value,
    position: document.getElementById('position').value,
    address_no: document.getElementById('address_no').value,
    address_road: document.getElementById('address_road').value,
    address_village: document.getElementById('address_village').value,
    subdistrict: document.getElementById('subdistrict').value,
    district: document.getElementById('district').value,
    province: document.getElementById('province').value,
    zipcode: document.getElementById('zipcode').value,
    password: document.getElementById('password').value,
    pdpaConsent: document.getElementById('pdpaConsent').checked
};

// 2. à¹€à¸£à¸µà¸¢à¸ Backend
// Auth.gs â†’ handleRegister(formData) â†’ à¸šà¸±à¸™à¸—à¸¶à¸à¸¥à¸‡ PendingReg_{à¸›à¸µ} à¹ƒà¸™ [MAIN]

// 3. à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸ªà¸³à¹€à¸£à¹‡à¸ˆ
// à¸‹à¹ˆà¸­à¸™à¸Ÿà¸­à¸£à¹Œà¸¡ â†’ à¹à¸ªà¸”à¸‡ "à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸ªà¸³à¹€à¸£à¹‡à¸ˆ â€” à¸£à¸­à¹à¸­à¸”à¸¡à¸´à¸™à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´"
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Auth.gs` â†’ `handleRegister()`, `createPendingRegYearSheet()`  
**Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** `PendingReg_{à¸›à¸µ}` à¹ƒà¸™ [MAIN]

---

### 7.3 `admin-settings.html` â€” 2 à¸ˆà¸¸à¸” (à¸•à¹‰à¸­à¸‡à¸¡à¸µ Auth.gs à¸žà¸£à¹‰à¸­à¸¡à¸à¹ˆà¸­à¸™)

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 5: à¹€à¸žà¸´à¹ˆà¸¡à¸›à¸¸à¹ˆà¸¡à¹à¸—à¹‡à¸š "à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸à¸²à¸£à¸ªà¸¡à¸±à¸„à¸£"

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** `<div class="tabs">` (à¸›à¸£à¸°à¸¡à¸²à¸“ L531â€“L559) â€” à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™ 8 à¹à¸—à¹‡à¸š  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¸›à¸¸à¹ˆà¸¡: housing, residents, water, electric, common, permissions, announcements, system  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:** à¹€à¸žà¸´à¹ˆà¸¡à¸›à¸¸à¹ˆà¸¡à¸—à¸µà¹ˆ 9 (à¹à¸™à¸°à¸™à¸³à¸«à¸¥à¸±à¸‡ permissions):
```html
<button class="tab-btn" onclick="showTab('approvals')">
    <span class="tab-btn-icon">âœ…</span> à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸à¸²à¸£à¸ªà¸¡à¸±à¸„à¸£
</button>
```
**à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `showTab()` (L1599â€“L1612) à¸—à¸³à¸‡à¸²à¸™ dynamic à¸­à¸¢à¸¹à¹ˆà¹à¸¥à¹‰à¸§ â€” **à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹à¸à¹‰ showTab**

---

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 6: à¹€à¸žà¸´à¹ˆà¸¡ tab content à¸ªà¸³à¸«à¸£à¸±à¸š "à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´à¸à¸²à¸£à¸ªà¸¡à¸±à¸„à¸£"

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸«à¸¥à¸±à¸‡ tab-content à¸­à¸±à¸™à¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢ (à¸à¹ˆà¸­à¸™ `</div>` à¸›à¸´à¸” container)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¹„à¸¡à¹ˆà¸¡à¸µ  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:** à¹€à¸žà¸´à¹ˆà¸¡ div à¹ƒà¸«à¸¡à¹ˆ:
```html
<div class="tab-content" id="tab-approvals">
    <h3>ðŸ“‹ à¸£à¸²à¸¢à¸à¸²à¸£à¸ªà¸¡à¸±à¸„à¸£à¸£à¸­à¸à¸²à¸£à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´</h3>
    <div id="approvals-list">
        <!-- à¸•à¸²à¸£à¸²à¸‡à¹à¸ªà¸”à¸‡à¸£à¸²à¸¢à¸à¸²à¸£ pending à¸ˆà¸²à¸ PendingReg_{à¸›à¸µ} -->
        <!-- à¹à¸•à¹ˆà¸¥à¸°à¹à¸–à¸§: à¸Šà¸·à¹ˆà¸­, email, phone, à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡, à¸§à¸±à¸™à¸—à¸µà¹ˆà¸ªà¸¡à¸±à¸„à¸£ -->
        <!-- à¸›à¸¸à¹ˆà¸¡: âœ… à¸­à¸™à¸¸à¸¡à¸±à¸•à¸´ / âŒ à¸›à¸à¸´à¹€à¸ªà¸˜ + à¸Šà¹ˆà¸­à¸‡à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸  -->
    </div>
</div>
```
**JS à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¹€à¸žà¸´à¹ˆà¸¡:**
```javascript
function loadPendingRegistrations() {
    // à¹€à¸£à¸µà¸¢à¸ Auth.gs â†’ getPendingRegistrations()
    // render à¸•à¸²à¸£à¸²à¸‡à¹ƒà¸™ #approvals-list
}
function approveRegistration(regId) {
    // à¹€à¸£à¸µà¸¢à¸ Auth.gs â†’ approveRegistration(regId, data)
    // refresh à¸•à¸²à¸£à¸²à¸‡
}
function rejectRegistration(regId) {
    // prompt à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸ â†’ à¹€à¸£à¸µà¸¢à¸ Auth.gs â†’ rejectRegistration(regId, note)
    // refresh à¸•à¸²à¸£à¸²à¸‡
}
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Auth.gs` â†’ `getPendingRegistrations()`, `approveRegistration()`, `rejectRegistration()`  
**Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** `PendingReg_{à¸›à¸µ}`, `Users`, `Residents` à¹ƒà¸™ [MAIN]

---

### 7.4 `regulations.html` â€” 2 à¸ˆà¸¸à¸” (à¸•à¹‰à¸­à¸‡à¸¡à¸µ Housing.gs à¸žà¸£à¹‰à¸­à¸¡à¸à¹ˆà¸­à¸™)

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 7: `checkSavedPdf()` â†’ à¹€à¸£à¸µà¸¢à¸ Backend à¹à¸—à¸™ localStorage

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `checkSavedPdf()` (à¸›à¸£à¸°à¸¡à¸²à¸“ L483â€“L488)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** `localStorage.getItem('regulations_pdf')` â†’ à¸–à¹‰à¸²à¸¡à¸µ (base64 string) â†’ à¹€à¸£à¸µà¸¢à¸ `loadPdfFromBase64(savedPdf)`  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:**
```javascript
async function checkSavedPdf() {
    // à¹€à¸£à¸µà¸¢à¸ Housing.gs â†’ getRegulationsPdf()
    // return URL à¸«à¸£à¸·à¸­ base64 à¸‚à¸­à¸‡ PDF à¸¥à¹ˆà¸²à¸ªà¸¸à¸”à¸ˆà¸²à¸à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œ Documents/ à¸šà¸™ Drive
    const pdfUrl = await getRegulationsPdfFromBackend();
    if (pdfUrl) {
        loadPdfFromUrl(pdfUrl);
    }
}
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Housing.gs` â†’ `getRegulationsPdf()` (à¸”à¸¶à¸‡à¹„à¸Ÿà¸¥à¹Œà¸¥à¹ˆà¸²à¸ªà¸¸à¸”à¸ˆà¸²à¸ Documents/ sort by date)

---

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 8: `loadPdfFromBase64()` â†’ `loadPdfFromUrl()`

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `loadPdfFromBase64(base64Data)` (à¸›à¸£à¸°à¸¡à¸²à¸“ L491â€“L519)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¸£à¸±à¸š base64 string â†’ `atob()` â†’ `Uint8Array` â†’ `pdfjsLib.getDocument({ data: pdfArray })`  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:** à¹€à¸žà¸´à¹ˆà¸¡à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹ƒà¸«à¸¡à¹ˆ (à¸«à¸£à¸·à¸­à¹à¸à¹‰à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹€à¸”à¸´à¸¡):
```javascript
async function loadPdfFromUrl(url) {
    // à¹ƒà¸Šà¹‰ pdfjsLib.getDocument({ url: url }) à¹‚à¸”à¸¢à¸•à¸£à¸‡
    // à¸«à¸£à¸·à¸­à¸–à¹‰à¸² Backend return binary/base64 â†’ à¹ƒà¸Šà¹‰ { data: ... } à¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸”à¸´à¸¡
    pdfDoc = await pdfjsLib.getDocument({ url: url }).promise;
    renderAllPages(); // à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™à¹€à¸”à¸´à¸¡ à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹à¸à¹‰
}
```
**à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸:** `renderAllPages()` (L521â€“L553) à¹à¸¥à¸° `updatePageButtons()` (L557â€“L561) **à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹à¸à¹‰à¹„à¸‚**

---

### 7.5 à¸¥à¸³à¸”à¸±à¸šà¸à¸²à¸£à¹à¸à¹‰ HTML (à¸—à¸³à¸•à¸²à¸¡ .gs à¸—à¸µà¹ˆà¸žà¸£à¹‰à¸­à¸¡)

| à¸¥à¸³à¸”à¸±à¸š | à¹€à¸¡à¸·à¹ˆà¸­ .gs à¸žà¸£à¹‰à¸­à¸¡ | à¹à¸à¹‰ HTML | à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ |
|-------|----------------|---------|-------|
| 1 | Auth.gs à¸žà¸£à¹‰à¸­à¸¡ âœ… | `register.html` | à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 4 |
| 2 | Auth.gs à¸žà¸£à¹‰à¸­à¸¡ âœ… | `admin-settings.html` | à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 5, 6 |
| 3 | Housing.gs à¸žà¸£à¹‰à¸­à¸¡ âœ… | `regulations.html` | à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 7, 8 |
| 4 | Housing.gs à¸žà¸£à¹‰à¸­à¸¡ âœ… | `settings.html` | à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 9, 10, 11 |
| 5 | Housing.gs à¸žà¸£à¹‰à¸­à¸¡ âœ… | `team-management.html` | à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 12 |
| 6 | Billing.gs à¸žà¸£à¹‰à¸­à¸¡ âœ… | `payment-notification.html` | à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 1, 2, 3 |
| 7 | Request.gs à¸žà¸£à¹‰à¸­à¸¡ âœ… | à¸„à¸³à¸£à¹‰à¸­à¸‡ 4 à¸Ÿà¸­à¸£à¹Œà¸¡ | à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 13, 14 |

> **à¸«à¸¥à¸±à¸à¸à¸²à¸£:** à¸ªà¸£à¹‰à¸²à¸‡ .gs à¸•à¸²à¸¡à¸¥à¸³à¸”à¸±à¸šà¹ƒà¸™ section "ðŸš€ à¸¥à¸³à¸”à¸±à¸šà¸à¸²à¸£à¸žà¸±à¸’à¸™à¸²à¸—à¸µà¹ˆà¹à¸™à¸°à¸™à¸³" â†’ à¹€à¸¡à¸·à¹ˆà¸­ .gs à¸•à¸±à¸§à¹„à¸«à¸™à¹€à¸ªà¸£à¹‡à¸ˆ â†’ à¹à¸à¹‰ HTML à¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡à¸•à¸²à¸¡

---

### 7.6 `settings.html` â€” 3 à¸ˆà¸¸à¸” (à¸•à¹‰à¸­à¸‡à¸¡à¸µ Housing.gs + Auth.gs à¸žà¸£à¹‰à¸­à¸¡à¸à¹ˆà¸­à¸™)

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 9: `loadUserData()` â†’ à¹€à¸£à¸µà¸¢à¸ Backend à¹à¸—à¸™ localStorage

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `loadUserData()` (à¸›à¸£à¸°à¸¡à¸²à¸“ L926â€“L957)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** `JSON.parse(localStorage.getItem('userData') || '{}')` â†’ à¸”à¸¶à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ localStorage à¹à¸¥à¹‰à¸§ set à¸„à¹ˆà¸²à¸¥à¸‡à¹ƒà¸™ form  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:**
```javascript
async function loadUserData() {
    // à¹€à¸£à¸µà¸¢à¸ Housing.gs â†’ getUserProfile(userId)
    // return { prefix, firstname, lastname, email, phone, position, subject_group,
    //          address_no, address_village, address_road, subdistrict, district, province, zipcode,
    //          house_number, move_in_date, profilePhoto }
    const userData = await getUserProfileFromBackend();
    // set à¸„à¹ˆà¸²à¸¥à¸‡à¹ƒà¸™ form à¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸”à¸´à¸¡
}
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Housing.gs` â†’ `getUserProfile(userId)`  
**Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** `Users`, `Residents` à¹ƒà¸™ [MAIN]

---

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 10: `saveSettings()` â†’ à¹€à¸£à¸µà¸¢à¸ Backend à¹à¸—à¸™ localStorage

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `saveSettings()` (à¸›à¸£à¸°à¸¡à¸²à¸“ L940â€“L1010)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¸£à¸§à¸šà¸£à¸§à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ â†’ `localStorage.setItem('userData', JSON.stringify(userData))` + `saveStaffToAdminList()`  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:**
```javascript
async function saveSettings() {
    // à¸•à¸£à¸§à¸ˆ password + à¸£à¸§à¸šà¸£à¸§à¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸”à¸´à¸¡
    const userData = { ... };
    // 1. à¹€à¸£à¸µà¸¢à¸ Housing.gs â†’ handleUpdateProfile(userData)
    //    à¸­à¸±à¸›à¹€à¸”à¸•à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸™ Residents sheet (à¹à¸à¹‰à¹„à¸‚à¹à¸–à¸§à¹€à¸”à¸´à¸¡ à¹„à¸¡à¹ˆà¸ªà¸£à¹‰à¸²à¸‡à¹à¸–à¸§à¹ƒà¸«à¸¡à¹ˆ)
    // 2. à¸–à¹‰à¸²à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™ à¹€à¸£à¸µà¸¢à¸ Auth.gs â†’ handleChangePassword()
    // 3. à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸ªà¸³à¹€à¸£à¹‡à¸ˆ
}
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Housing.gs` â†’ `handleUpdateProfile()`, `Auth.gs` â†’ `handleChangePassword()`  
**Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** `Residents`, `Users` à¹ƒà¸™ [MAIN]

---

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 11: Coresident CRUD â†’ à¹€à¸£à¸µà¸¢à¸ Backend à¹à¸—à¸™ localStorage

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `loadCoresidents()`, `addCoresident()`, `removeCoresident()`, `updateCoresident()` (à¸›à¸£à¸°à¸¡à¸²à¸“ L1144â€“L1340)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¸­à¹ˆà¸²à¸™/à¹€à¸‚à¸µà¸¢à¸™à¸ˆà¸²à¸ localStorage (`userData.coresidents`) + `syncCoresidentsFromSystem()` à¸”à¸¶à¸‡à¸ˆà¸²à¸ `allUsers`  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:**
```javascript
async function loadCoresidents() {
    // à¹€à¸£à¸µà¸¢à¸ Housing.gs â†’ getCoresidents(residentId)
    coresidents = await getCoresidentsFromBackend(currentResidentId);
    renderCoresidents();
}
async function addCoresidentToBackend(data) {
    // à¹€à¸£à¸µà¸¢à¸ Housing.gs â†’ addCoresident(data)
}
async function removeCoresidentFromBackend(id) {
    // à¹€à¸£à¸µà¸¢à¸ Housing.gs â†’ removeCoresident(id)
}
async function updateCoresidentFromBackend(id, field, value) {
    // à¹€à¸£à¸µà¸¢à¸ Housing.gs â†’ updateCoresident(id, {field: value})
}
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Housing.gs` â†’ `getCoresidents()`, `addCoresident()`, `updateCoresident()`, `removeCoresident()`  
**Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** `Residents` à¹ƒà¸™ [MAIN] (à¸œà¸¹à¹‰à¸£à¹ˆà¸§à¸¡à¸žà¸±à¸à¹€à¸à¹‡à¸šà¹€à¸›à¹‡à¸™à¹à¸–à¸§à¹ƒà¸™à¸Šà¸µà¸—à¹€à¸”à¸µà¸¢à¸§à¸à¸±à¸™ resident_type = 'cohabitant')

---

### 7.7 `team-management.html` â€” 1 à¸ˆà¸¸à¸” (à¸•à¹‰à¸­à¸‡à¸¡à¸µ Housing.gs + Auth.gs à¸žà¸£à¹‰à¸­à¸¡à¸à¹ˆà¸­à¸™)

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 12: `checkPermission()` â†’ à¹€à¸£à¸µà¸¢à¸ Backend + à¸‹à¹ˆà¸­à¸™à¸›à¸¸à¹ˆà¸¡à¸•à¸²à¸¡à¸ªà¸´à¸—à¸˜à¸´à¹Œ

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸Ÿà¸±à¸‡à¸à¹Œà¸Šà¸±à¸™ `checkPermission()` (à¸›à¸£à¸°à¸¡à¸²à¸“ L350â€“L355)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¸•à¸£à¸§à¸ˆ `localStorage.getItem('noTeamAccess')` â€” à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸•à¸£à¸§à¸ˆà¸ªà¸´à¸—à¸˜à¸´à¹Œà¸ˆà¸£à¸´à¸‡ + à¹„à¸¡à¹ˆà¸‹à¹ˆà¸­à¸™à¸›à¸¸à¹ˆà¸¡à¸•à¸²à¸¡à¸ªà¸´à¸—à¸˜à¸´à¹Œ  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:**
```javascript
async function checkPermission() {
    // 1. à¹€à¸£à¸µà¸¢à¸ Auth.gs â†’ checkPermission(userId, 'team')
    //    à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¸¡à¸µà¸ªà¸´à¸—à¸˜à¸´à¹Œ â†’ à¸£à¸µà¹„à¸”à¹€à¸£à¸à¸—à¹Œà¸à¸¥à¸±à¸šà¹„à¸› dashboard.html
    // 2. à¸”à¸¶à¸‡ permissions à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸ˆà¸²à¸ Permissions sheet
    //    à¸‹à¹ˆà¸­à¸™/à¹à¸ªà¸”à¸‡à¸›à¸¸à¹ˆà¸¡à¸•à¸²à¸¡à¸ªà¸´à¸—à¸˜à¸´à¹Œ:
    //    water=TRUE â†’ à¹à¸ªà¸”à¸‡à¸›à¸¸à¹ˆà¸¡ "à¸šà¸±à¸™à¸—à¸¶à¸à¸„à¹ˆà¸²à¸™à¹‰à¸³"
    //    electric=TRUE â†’ à¹à¸ªà¸”à¸‡à¸›à¸¸à¹ˆà¸¡ "à¸šà¸±à¸™à¸—à¸¶à¸à¸„à¹ˆà¸²à¹„à¸Ÿ"
    //    notify=TRUE â†’ à¹à¸ªà¸”à¸‡à¸›à¸¸à¹ˆà¸¡ "à¹à¸ˆà¹‰à¸‡à¸¢à¸­à¸”à¸Šà¸³à¸£à¸°"
    //    slip=TRUE â†’ à¹à¸ªà¸”à¸‡à¸›à¸¸à¹ˆà¸¡ "à¸•à¸£à¸§à¸ˆà¸ªà¸¥à¸´à¸›"
    //    withdraw=TRUE â†’ à¹à¸ªà¸”à¸‡à¸›à¸¸à¹ˆà¸¡ "à¸¢à¸­à¸”à¹€à¸šà¸´à¸à¸›à¸£à¸°à¸ˆà¸³à¹€à¸”à¸·à¸­à¸™"
    //    accounting=TRUE â†’ à¹à¸ªà¸”à¸‡à¸›à¸¸à¹ˆà¸¡ "à¸šà¸±à¸à¸Šà¸µà¸£à¸²à¸¢à¸£à¸±à¸šà¸£à¸²à¸¢à¸ˆà¹ˆà¸²à¸¢"
    //    request=TRUE â†’ à¹à¸ªà¸”à¸‡à¸›à¸¸à¹ˆà¸¡ "à¸•à¸£à¸§à¸ˆà¸„à¸³à¸£à¹‰à¸­à¸‡"
    //    admin=TRUE â†’ à¹à¸ªà¸”à¸‡à¸›à¸¸à¹ˆà¸¡ "à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¹à¸­à¸”à¸¡à¸´à¸™"
}
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Auth.gs` â†’ `checkPermission()`, `Housing.gs` â†’ `getPermissions()`  
**Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** `Permissions` à¹ƒà¸™ [MAIN]

---

### 7.8 à¸„à¸³à¸£à¹‰à¸­à¸‡ 4 à¸Ÿà¸­à¸£à¹Œà¸¡ â€” 2 à¸ˆà¸¸à¸” (à¸•à¹‰à¸­à¸‡à¸¡à¸µ Request.gs + Housing.gs à¸žà¸£à¹‰à¸­à¸¡à¸à¹ˆà¸­à¸™)

> **à¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¹€à¸à¸µà¹ˆà¸¢à¸§à¸‚à¹‰à¸­à¸‡:** `request-form.html`, `transfer-form.html`, `return-form.html`, `repair-form.html`

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 13: à¹€à¸žà¸´à¹ˆà¸¡ submit handler à¹€à¸£à¸µà¸¢à¸ Backend

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸›à¸¸à¹ˆà¸¡ "à¸ªà¹ˆà¸‡à¸„à¸³à¸£à¹‰à¸­à¸‡" (à¸—à¸±à¹‰à¸‡ 4 à¸Ÿà¸­à¸£à¹Œà¸¡)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¹ƒà¸Šà¹‰ `type="submit"` à¹à¸•à¹ˆà¹„à¸¡à¹ˆà¸¡à¸µ event handler à¸«à¸£à¸·à¸­ form action à¹€à¸›à¹‡à¸™ `#` â€” à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸£à¸´à¸‡  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:** à¹€à¸žà¸´à¹ˆà¸¡ `addEventListener('submit', ...)` à¹ƒà¸™à¹à¸•à¹ˆà¸¥à¸°à¸Ÿà¸­à¸£à¹Œà¸¡:
```javascript
// request-form.html
form.addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = collectFormData();
    // à¹€à¸£à¸µà¸¢à¸ Request.gs â†’ handleSubmitRequest('residence', formData)
    // à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸ªà¸³à¹€à¸£à¹‡à¸ˆ + à¸£à¸­à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š
});
// transfer-form.html â†’ handleSubmitRequest('transfer', formData)
// return-form.html â†’ handleSubmitRequest('return', formData)
// repair-form.html â†’ handleSubmitRequest('repair', formData)
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Request.gs` â†’ `handleSubmitRequest(type, data)`  
**Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** `{Type}_{year}` à¹ƒà¸™ [REQUESTS], Request folders

---

#### - [ ] à¸ˆà¸¸à¸”à¸—à¸µà¹ˆ 14: Auto-fill à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸ˆà¸²à¸ Backend

**à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡:** à¸ªà¹ˆà¸§à¸™à¸—à¸µà¹ˆ 1: à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§ (à¸—à¸±à¹‰à¸‡ 4 à¸Ÿà¸­à¸£à¹Œà¸¡)  
**à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™:** à¹à¸ªà¸”à¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡ "à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸™à¸µà¹‰à¸ˆà¸°à¸”à¸¶à¸‡à¸ˆà¸²à¸à¸£à¸°à¸šà¸šà¹‚à¸”à¸¢à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´" à¹à¸•à¹ˆ form à¸¢à¸±à¸‡à¸§à¹ˆà¸²à¸‡à¸­à¸¢à¸¹à¹ˆ  
**à¹à¸à¹‰à¹€à¸›à¹‡à¸™:**
```javascript
async function autoFillUserInfo() {
    // à¹€à¸£à¸µà¸¢à¸ Housing.gs â†’ getUserProfile(userId)
    const profile = await getUserProfileFromBackend();
    document.getElementById('prefix').value = profile.prefix;
    document.getElementById('fullname').value = profile.firstname + ' ' + profile.lastname;
    document.getElementById('phone').value = profile.phone;
    document.getElementById('subject_group').value = profile.subject_group;
    // transfer-form: current_house = profile.house_number
    // return-form: current_house + move_in_date
    // repair-form: house_number
}
window.onload = autoFillUserInfo;
```
**Backend à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸žà¸£à¹‰à¸­à¸¡:** `Housing.gs` â†’ `getUserProfile(userId)`  
**Sheet à¸—à¸µà¹ˆà¹ƒà¸Šà¹‰:** `Users`, `Residents` à¹ƒà¸™ [MAIN]

---

### 7.9 à¸¥à¸³à¸”à¸±à¸šà¸à¸²à¸£à¹à¸à¹‰ HTML (à¸ªà¸£à¸¸à¸›à¸£à¸§à¸¡)

---

> **à¹€à¸­à¸à¸ªà¸²à¸£à¸™à¸µà¹‰à¹ƒà¸Šà¹‰à¸›à¸£à¸°à¸à¸­à¸šà¸à¸±à¸š:** `à¹€à¸—à¸¡à¹€à¸žà¸¥à¸•à¹‚à¸Ÿà¸¥à¹€à¸”à¸­à¸£à¹Œà¹à¸¥à¸°à¸Šà¸µà¸—.md` à¹€à¸žà¸·à¹ˆà¸­à¸”à¸¹à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹à¸•à¹ˆà¸¥à¸°à¹„à¸Ÿà¸¥à¹Œ .gs à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰
